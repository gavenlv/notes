# ç¬¬8ç« ï¼šæ–‡ä»¶ç³»ç»Ÿæ“ä½œ

> **å­¦ä¹ æ—¶é•¿**: 5-6å°æ—¶  
> **éš¾åº¦**: â­â­â­  
> **å‰ç½®çŸ¥è¯†**: ç¬¬1-7ç« 

## æœ¬ç« ç›®æ ‡

å­¦å®Œæœ¬ç« å,ä½ å°†èƒ½å¤Ÿ:

- âœ… æµè§ˆå’Œå¯¼èˆªæ–‡ä»¶ç³»ç»Ÿ
- âœ… åˆ›å»ºã€å¤åˆ¶ã€ç§»åŠ¨ã€åˆ é™¤æ–‡ä»¶å’Œæ–‡ä»¶å¤¹
- âœ… è¯»å†™æ–‡ä»¶å†…å®¹
- âœ… æœç´¢å’Œè¿‡æ»¤æ–‡ä»¶
- âœ… ç®¡ç†æ–‡ä»¶æƒé™
- âœ… å¤„ç†è·¯å¾„å’Œæ–‡ä»¶å

---

## 8.1 æ–‡ä»¶ç³»ç»Ÿå¯¼èˆª

### 8.1.1 åŸºæœ¬å¯¼èˆª

```powershell
# æŸ¥çœ‹å½“å‰ä½ç½®
Get-Location   # æˆ– pwd

# åˆ‡æ¢ç›®å½•
Set-Location C:\Windows     # æˆ– cd
Set-Location -Path "C:\Program Files"

# è¿”å›ä¸Šçº§ç›®å½•
Set-Location ..
cd ..

# è¿”å›ä¸Šä¸¤çº§
cd ..\..

# åˆ‡æ¢åˆ°ç”¨æˆ·ä¸»ç›®å½•
cd ~
cd $env:USERPROFILE

# åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªç›®å½•
cd -

# æŸ¥çœ‹ç›®å½•æ ˆ
Push-Location C:\Windows
Push-Location C:\Temp
Get-Location -Stack

# è¿”å›ä¸Šä¸€ä¸ªä½ç½®
Pop-Location
```

### 8.1.2 åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•

```powershell
# åˆ—å‡ºå½“å‰ç›®å½•
Get-ChildItem   # æˆ– ls, dir, gci

# åˆ—å‡ºæŒ‡å®šç›®å½•
Get-ChildItem C:\Windows

# ä»…åˆ—å‡ºæ–‡ä»¶
Get-ChildItem -File

# ä»…åˆ—å‡ºç›®å½•
Get-ChildItem -Directory

# é€’å½’åˆ—å‡º
Get-ChildItem -Recurse

# åŒ…å«éšè—æ–‡ä»¶
Get-ChildItem -Force

# æŒ‰æ‰©å±•åè¿‡æ»¤
Get-ChildItem *.txt
Get-ChildItem -Filter "*.log"

# å¤šä¸ªæ¨¡å¼
Get-ChildItem -Include *.txt, *.log -Recurse

# æ’é™¤æ¨¡å¼
Get-ChildItem -Exclude *.tmp, *.bak
```

---

## 8.2 æ–‡ä»¶å’Œç›®å½•æ“ä½œ

### 8.2.1 åˆ›å»º

```powershell
# åˆ›å»ºç›®å½•
New-Item -Path "C:\Test" -ItemType Directory
New-Item -ItemType Directory -Path "C:\Test\SubDir1", "C:\Test\SubDir2"

# åˆ›å»ºæ–‡ä»¶
New-Item -Path "C:\Test\file.txt" -ItemType File

# åˆ›å»ºå¹¶å†™å…¥å†…å®¹
New-Item -Path "C:\Test\data.txt" -ItemType File -Value "Hello World"

# åˆ›å»ºå¤šçº§ç›®å½•
New-Item -ItemType Directory -Path "C:\Test\Level1\Level2\Level3" -Force

# åˆ›å»ºä¸´æ—¶æ–‡ä»¶
$tempFile = New-TemporaryFile
$tempFile.FullName
```

### 8.2.2 å¤åˆ¶

```powershell
# å¤åˆ¶æ–‡ä»¶
Copy-Item -Path "C:\Test\file.txt" -Destination "C:\Backup\file.txt"

# å¤åˆ¶å¹¶é‡å‘½å
Copy-Item "source.txt" -Destination "destination.txt"

# å¤åˆ¶ç›®å½•(é€’å½’)
Copy-Item -Path "C:\Source" -Destination "C:\Backup\Source" -Recurse

# å¼ºåˆ¶è¦†ç›–
Copy-Item "file.txt" "backup.txt" -Force

# å¤åˆ¶å¤šä¸ªæ–‡ä»¶
Copy-Item -Path "C:\Source\*.txt" -Destination "C:\Backup\"

# ä¿ç•™æ–‡ä»¶å±æ€§
Copy-Item "file.txt" "copy.txt" -PassThru | 
    Set-ItemProperty -Name IsReadOnly -Value $true
```

### 8.2.3 ç§»åŠ¨

```powershell
# ç§»åŠ¨æ–‡ä»¶
Move-Item -Path "C:\Source\file.txt" -Destination "C:\Dest\"

# ç§»åŠ¨å¹¶é‡å‘½å
Move-Item "old.txt" -Destination "new.txt"

# ç§»åŠ¨ç›®å½•
Move-Item -Path "C:\OldFolder" -Destination "C:\NewFolder"

# å¼ºåˆ¶ç§»åŠ¨
Move-Item "file.txt" "C:\Dest\file.txt" -Force

# ç§»åŠ¨å¤šä¸ªæ–‡ä»¶
Move-Item -Path "C:\Source\*.log" -Destination "C:\Logs\"
```

### 8.2.4 åˆ é™¤

```powershell
# åˆ é™¤æ–‡ä»¶
Remove-Item -Path "C:\Temp\file.txt"

# åˆ é™¤ç›®å½•(é€’å½’)
Remove-Item -Path "C:\Temp\OldFolder" -Recurse

# å¼ºåˆ¶åˆ é™¤
Remove-Item "file.txt" -Force

# åˆ é™¤åªè¯»æ–‡ä»¶
Remove-Item "readonly.txt" -Force

# ç¡®è®¤åˆ é™¤
Remove-Item "important.txt" -Confirm

# æ¨¡æ‹Ÿåˆ é™¤(ä¸å®é™…åˆ é™¤)
Remove-Item "*.tmp" -WhatIf

# åˆ é™¤å¤šä¸ªæ–‡ä»¶
Remove-Item -Path "C:\Temp\*.tmp", "C:\Temp\*.bak"

# å®‰å…¨åˆ é™¤(ç§»åˆ°å›æ”¶ç«™)
# éœ€è¦ Windows 10+
Add-Type -AssemblyName Microsoft.VisualBasic
[Microsoft.VisualBasic.FileIO.FileSystem]::DeleteFile(
    "C:\file.txt",
    'OnlyErrorDialogs',
    'SendToRecycleBin'
)
```

### 8.2.5 é‡å‘½å

```powershell
# é‡å‘½åæ–‡ä»¶
Rename-Item -Path "old.txt" -NewName "new.txt"

# é‡å‘½åç›®å½•
Rename-Item -Path "OldFolder" -NewName "NewFolder"

# æ‰¹é‡é‡å‘½å
Get-ChildItem *.txt | ForEach-Object {
    Rename-Item $_.FullName -NewName ($_.Name -replace ".txt", ".log")
}

# æ·»åŠ å‰ç¼€
Get-ChildItem *.jpg | Rename-Item -NewName {"prefix_$($_.Name)"}

# æ·»åŠ åç¼€
Get-ChildItem *.txt | Rename-Item -NewName {
    $_.BaseName + "_backup" + $_.Extension
}

# æ›¿æ¢ç©ºæ ¼
Get-ChildItem | Where-Object {$_.Name -match " "} | 
    Rename-Item -NewName {$_.Name -replace " ", "_"}
```

---

## 8.3 æ–‡ä»¶å†…å®¹æ“ä½œ

### 8.3.1 è¯»å–å†…å®¹

```powershell
# è¯»å–å…¨éƒ¨å†…å®¹
Get-Content -Path "file.txt"

# è¯»å–å‰Nè¡Œ
Get-Content "file.txt" -TotalCount 10

# è¯»å–åNè¡Œ
Get-Content "file.txt" -Tail 10

# æŒ‰è¡Œè¯»å–(æ•°ç»„)
$lines = Get-Content "file.txt"
$lines[0]  # ç¬¬ä¸€è¡Œ
$lines[-1] # æœ€åä¸€è¡Œ

# å®æ—¶ç›‘æ§æ–‡ä»¶(ç±»ä¼¼tail -f)
Get-Content "log.txt" -Wait

# è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶
Get-Content "file.exe" -Encoding Byte

# è¯»å–CSV
Import-Csv "data.csv"

# è¯»å–JSON
Get-Content "data.json" | ConvertFrom-Json

# è¯»å–XML
[xml]$xml = Get-Content "data.xml"
```

### 8.3.2 å†™å…¥å†…å®¹

```powershell
# å†™å…¥æ–‡ä»¶(è¦†ç›–)
"Hello World" | Set-Content -Path "file.txt"

# å†™å…¥å¤šè¡Œ
$lines = @(
    "Line 1"
    "Line 2"
    "Line 3"
)
$lines | Set-Content "file.txt"

# è¿½åŠ å†…å®¹
"New line" | Add-Content -Path "file.txt"

# å†™å…¥å¯¹è±¡
Get-Process | Out-File "processes.txt"

# å†™å…¥CSV
Get-Process | Export-Csv "processes.csv" -NoTypeInformation

# å†™å…¥JSON
Get-Process | Select-Object Name, Id, CPU | ConvertTo-Json | Set-Content "processes.json"

# å†™å…¥XML
Get-Process | Export-Clixml "processes.xml"

# æŒ‡å®šç¼–ç 
"ä¸­æ–‡å†…å®¹" | Set-Content "file.txt" -Encoding UTF8
```

### 8.3.3 æ–‡æœ¬å¤„ç†

```powershell
# æŸ¥æ‰¾åŒ…å«ç‰¹å®šæ–‡æœ¬çš„è¡Œ
Get-Content "log.txt" | Where-Object {$_ -match "ERROR"}

# æ›¿æ¢æ–‡æœ¬
(Get-Content "file.txt") -replace "old", "new" | Set-Content "file.txt"

# åˆ é™¤ç©ºè¡Œ
Get-Content "file.txt" | Where-Object {$_.Trim() -ne ""} | Set-Content "cleaned.txt"

# ç»Ÿè®¡è¡Œæ•°
(Get-Content "file.txt").Count

# ç»Ÿè®¡å­—æ•°
(Get-Content "file.txt" | Measure-Object -Word).Words

# åˆå¹¶æ–‡ä»¶
Get-Content file1.txt, file2.txt, file3.txt | Set-Content merged.txt

# åˆ†å‰²æ–‡ä»¶
$content = Get-Content "large.txt"
$chunkSize = 1000
for ($i = 0; $i -lt $content.Count; $i += $chunkSize) {
    $content[$i..($i+$chunkSize-1)] | Set-Content "chunk_$($i/$chunkSize).txt"
}
```

---

## 8.4 æ–‡ä»¶å±æ€§å’Œä¿¡æ¯

### 8.4.1 è·å–æ–‡ä»¶ä¿¡æ¯

```powershell
# è·å–æ–‡ä»¶å¯¹è±¡
$file = Get-Item "C:\Windows\notepad.exe"

# åŸºæœ¬å±æ€§
$file.Name          # æ–‡ä»¶å
$file.FullName      # å®Œæ•´è·¯å¾„
$file.Extension     # æ‰©å±•å
$file.BaseName      # æ— æ‰©å±•åçš„æ–‡ä»¶å
$file.DirectoryName # ç›®å½•è·¯å¾„
$file.Directory     # ç›®å½•å¯¹è±¡

# å¤§å°å’Œæ—¥æœŸ
$file.Length        # å­—èŠ‚
$file.CreationTime
$file.LastWriteTime
$file.LastAccessTime

# å±æ€§æ ‡å¿—
$file.IsReadOnly
$file.Attributes    # Hidden, ReadOnly, Systemç­‰

# ç‰ˆæœ¬ä¿¡æ¯
$file.VersionInfo.FileVersion
$file.VersionInfo.CompanyName
$file.VersionInfo.ProductName
```

### 8.4.2 è®¾ç½®æ–‡ä»¶å±æ€§

```powershell
# è®¾ç½®åªè¯»
Set-ItemProperty -Path "file.txt" -Name IsReadOnly -Value $true

# ç§»é™¤åªè¯»
Set-ItemProperty -Path "file.txt" -Name IsReadOnly -Value $false

# è®¾ç½®éšè—
Set-ItemProperty -Path "file.txt" -Name Attributes -Value "Hidden"

# è®¾ç½®å¤šä¸ªå±æ€§
$file = Get-Item "file.txt"
$file.Attributes = "Hidden, ReadOnly"

# ä¿®æ”¹æ—¶é—´æˆ³
$file = Get-Item "file.txt"
$file.CreationTime = Get-Date "2024-01-01"
$file.LastWriteTime = Get-Date
$file.LastAccessTime = Get-Date

# æ‰¹é‡ä¿®æ”¹
Get-ChildItem *.txt | ForEach-Object {
    $_.IsReadOnly = $false
    $_.LastWriteTime = Get-Date
}
```

---

## 8.5 è·¯å¾„æ“ä½œ

### 8.5.1 è·¯å¾„å¤„ç†

```powershell
# åˆå¹¶è·¯å¾„
Join-Path "C:\Users" "Admin\Documents"
Join-Path -Path "C:\Test" -ChildPath "file.txt"

# åˆ†å‰²è·¯å¾„
Split-Path "C:\Users\Admin\file.txt"  # C:\Users\Admin
Split-Path "C:\Users\Admin\file.txt" -Leaf  # file.txt
Split-Path "C:\Users\Admin\file.txt" -Parent  # C:\Users\Admin

# è·å–æ–‡ä»¶å
Split-Path "C:\Path\file.txt" -Leaf  # file.txt

# è·å–æ‰©å±•å
[System.IO.Path]::GetExtension("file.txt")  # .txt

# è·å–æ— æ‰©å±•åæ–‡ä»¶å
[System.IO.Path]::GetFileNameWithoutExtension("file.txt")  # file

# è·å–ç›®å½•å
[System.IO.Path]::GetDirectoryName("C:\Path\file.txt")  # C:\Path

# è½¬æ¢ä¸ºç»å¯¹è·¯å¾„
Resolve-Path ".\file.txt"
(Get-Item ".\file.txt").FullName

# è½¬æ¢ä¸ºç›¸å¯¹è·¯å¾„
Resolve-Path "C:\Windows\System32\notepad.exe" -Relative

# æµ‹è¯•è·¯å¾„
Test-Path "C:\Windows"  # True
Test-Path "C:\NonExistent"  # False

# æµ‹è¯•è·¯å¾„ç±»å‹
Test-Path "C:\Windows" -PathType Container  # æ˜¯ç›®å½•
Test-Path "C:\Windows\notepad.exe" -PathType Leaf  # æ˜¯æ–‡ä»¶
```

### 8.5.2 ç‰¹æ®Šè·¯å¾„

```powershell
# ç”¨æˆ·ä¸»ç›®å½•
$env:USERPROFILE  # C:\Users\Username
$HOME

# ä¸´æ—¶ç›®å½•
$env:TEMP
$env:TMP
[System.IO.Path]::GetTempPath()

# æ¡Œé¢
[Environment]::GetFolderPath("Desktop")

# æˆ‘çš„æ–‡æ¡£
[Environment]::GetFolderPath("MyDocuments")

# å…¶ä»–ç‰¹æ®Šæ–‡ä»¶å¤¹
[Environment]::GetFolderPath("ProgramFiles")
[Environment]::GetFolderPath("System")
[Environment]::GetFolderPath("Windows")
[Environment]::GetFolderPath("ApplicationData")
[Environment]::GetFolderPath("LocalApplicationData")

# å½“å‰è„šæœ¬ç›®å½•
$PSScriptRoot

# PowerShellå®‰è£…ç›®å½•
$PSHOME
```

---

## 8.6 æ–‡ä»¶æœç´¢

### 8.6.1 åŸºæœ¬æœç´¢

```powershell
# æŒ‰åç§°æœç´¢
Get-ChildItem -Path C:\ -Filter "*.txt" -Recurse

# æŒ‰æ‰©å±•åæœç´¢
Get-ChildItem -Path C:\Windows -Include *.exe, *.dll -Recurse

# æ’é™¤æŸäº›æ–‡ä»¶
Get-ChildItem -Exclude *.tmp, *.bak

# æœç´¢éšè—æ–‡ä»¶
Get-ChildItem -Force | Where-Object {$_.Attributes -match "Hidden"}

# æœç´¢åªè¯»æ–‡ä»¶
Get-ChildItem -Recurse | Where-Object {$_.IsReadOnly}
```

### 8.6.2 é«˜çº§æœç´¢

```powershell
# æŒ‰å¤§å°æœç´¢
Get-ChildItem -Recurse | Where-Object {$_.Length -gt 100MB}

# æŒ‰æ—¥æœŸæœç´¢
$cutoffDate = (Get-Date).AddDays(-7)
Get-ChildItem -Recurse | Where-Object {$_.LastWriteTime -gt $cutoffDate}

# æŸ¥æ‰¾ç©ºæ–‡ä»¶
Get-ChildItem -File -Recurse | Where-Object {$_.Length -eq 0}

# æŸ¥æ‰¾ç©ºæ–‡ä»¶å¤¹
Get-ChildItem -Directory -Recurse | 
    Where-Object {(Get-ChildItem $_.FullName).Count -eq 0}

# æŸ¥æ‰¾é‡å¤æ–‡ä»¶(æŒ‰å¤§å°å’Œåç§°)
Get-ChildItem -Recurse -File | 
    Group-Object Length, Name | 
    Where-Object {$_.Count -gt 1} |
    Select-Object -ExpandProperty Group

# æŒ‰å†…å®¹æœç´¢
Get-ChildItem -Filter *.txt -Recurse | 
    Where-Object {(Get-Content $_.FullName) -match "error"}
```

### 8.6.3 æ–‡ä»¶å“ˆå¸Œ

```powershell
# è®¡ç®—æ–‡ä»¶å“ˆå¸Œ(MD5, SHA256ç­‰)
Get-FileHash "file.txt"
Get-FileHash "file.txt" -Algorithm SHA256
Get-FileHash "file.txt" -Algorithm MD5

# æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶
$hash1 = Get-FileHash "file1.txt"
$hash2 = Get-FileHash "file2.txt"
$hash1.Hash -eq $hash2.Hash  # ç›¸åŒè¿”å›True

# æ‰¹é‡è®¡ç®—å“ˆå¸Œ
Get-ChildItem *.exe | ForEach-Object {
    [PSCustomObject]@{
        File = $_.Name
        Hash = (Get-FileHash $_.FullName).Hash
    }
} | Export-Csv "hashes.csv" -NoTypeInformation
```

---

## 8.7 å®éªŒ:æ–‡ä»¶ç³»ç»Ÿå·¥å…·

### å®éªŒ1: æ–‡ä»¶æ•´ç†å·¥å…·

```powershell
<#
.SYNOPSIS
    æ–‡ä»¶æ•´ç†å·¥å…·
.DESCRIPTION
    æŒ‰æ‰©å±•åã€æ—¥æœŸæˆ–å¤§å°æ•´ç†æ–‡ä»¶
#>

function Organize-Files {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string]$SourcePath,
        
        [Parameter(Mandatory=$true)]
        [string]$DestinationPath,
        
        [ValidateSet("Extension", "Date", "Size")]
        [string]$OrganizeBy = "Extension"
    )
    
    # ç¡®ä¿ç›®æ ‡ç›®å½•å­˜åœ¨
    if (-not (Test-Path $DestinationPath)) {
        New-Item -ItemType Directory -Path $DestinationPath | Out-Null
    }
    
    $files = Get-ChildItem -Path $SourcePath -File
    
    foreach ($file in $files) {
        $targetFolder = switch ($OrganizeBy) {
            "Extension" {
                $ext = if ($file.Extension) {
                    $file.Extension.TrimStart('.')
                } else {
                    "NoExtension"
                }
                Join-Path $DestinationPath $ext
            }
            "Date" {
                $year = $file.LastWriteTime.Year
                $month = $file.LastWriteTime.ToString("MM-MMMM")
                Join-Path $DestinationPath "$year\$month"
            }
            "Size" {
                $sizeCategory = if ($file.Length -gt 100MB) {"Large"}
                               elseif ($file.Length -gt 10MB) {"Medium"}
                               elseif ($file.Length -gt 1MB) {"Small"}
                               else {"Tiny"}
                Join-Path $DestinationPath $sizeCategory
            }
        }
        
        # åˆ›å»ºç›®æ ‡æ–‡ä»¶å¤¹
        if (-not (Test-Path $targetFolder)) {
            New-Item -ItemType Directory -Path $targetFolder | Out-Null
            Write-Host "Created folder: $targetFolder" -ForegroundColor Green
        }
        
        # ç§»åŠ¨æ–‡ä»¶
        $targetPath = Join-Path $targetFolder $file.Name
        Move-Item -Path $file.FullName -Destination $targetPath
        Write-Host "Moved: $($file.Name) -> $targetFolder" -ForegroundColor Cyan
    }
    
    Write-Host "`nâœ“ Organization complete!" -ForegroundColor Green
}

# ä½¿ç”¨ç¤ºä¾‹
# Organize-Files -SourcePath "C:\Downloads" -DestinationPath "C:\Organized" -OrganizeBy Extension
```

### å®éªŒ2: æ–‡ä»¶å¤‡ä»½å·¥å…·

```powershell
<#
.SYNOPSIS
    å¢é‡å¤‡ä»½å·¥å…·
.DESCRIPTION
    åªå¤‡ä»½æ–°æ–‡ä»¶æˆ–ä¿®æ”¹çš„æ–‡ä»¶
#>

function Backup-Files {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string]$SourcePath,
        
        [Parameter(Mandatory=$true)]
        [string]$BackupPath,
        
        [switch]$Mirror
    )
    
    Write-Host "=== File Backup ===" -ForegroundColor Cyan
    Write-Host "Source: $SourcePath"
    Write-Host "Backup: $BackupPath`n"
    
    # åˆ›å»ºå¤‡ä»½ç›®å½•
    if (-not (Test-Path $BackupPath)) {
        New-Item -ItemType Directory -Path $BackupPath | Out-Null
    }
    
    # è·å–æºæ–‡ä»¶
    $sourceFiles = Get-ChildItem -Path $SourcePath -Recurse -File
    
    $copied = 0
    $skipped = 0
    
    foreach ($sourceFile in $sourceFiles) {
        # è®¡ç®—ç›¸å¯¹è·¯å¾„
        $relativePath = $sourceFile.FullName.Substring($SourcePath.Length)
        $backupFile = Join-Path $BackupPath $relativePath
        
        $shouldCopy = $false
        
        if (Test-Path $backupFile) {
            # æ–‡ä»¶å­˜åœ¨,æ¯”è¾ƒä¿®æ”¹æ—¶é—´å’Œå¤§å°
            $backupItem = Get-Item $backupFile
            if (($sourceFile.LastWriteTime -gt $backupItem.LastWriteTime) -or
                ($sourceFile.Length -ne $backupItem.Length)) {
                $shouldCopy = $true
                Write-Host "Updated: $relativePath" -ForegroundColor Yellow
            } else {
                $skipped++
            }
        } else {
            $shouldCopy = $true
            Write-Host "New: $relativePath" -ForegroundColor Green
        }
        
        if ($shouldCopy) {
            # åˆ›å»ºç›®æ ‡ç›®å½•
            $backupDir = Split-Path $backupFile -Parent
            if (-not (Test-Path $backupDir)) {
                New-Item -ItemType Directory -Path $backupDir -Force | Out-Null
            }
            
            # å¤åˆ¶æ–‡ä»¶
            Copy-Item -Path $sourceFile.FullName -Destination $backupFile -Force
            $copied++
        }
    }
    
    Write-Host "`n=== Backup Summary ===" -ForegroundColor Cyan
    Write-Host "Files copied: $copied" -ForegroundColor Green
    Write-Host "Files skipped: $skipped" -ForegroundColor Yellow
    Write-Host "Total files: $($sourceFiles.Count)"
}

# ä½¿ç”¨ç¤ºä¾‹
# Backup-Files -SourcePath "C:\Documents" -BackupPath "D:\Backup\Documents"
```

### å®éªŒ3: ç£ç›˜ç©ºé—´åˆ†æ

```powershell
<#
.SYNOPSIS
    ç£ç›˜ç©ºé—´åˆ†æå·¥å…·
.DESCRIPTION
    åˆ†æç›®å½•å ç”¨ç©ºé—´å¹¶ç”ŸæˆæŠ¥å‘Š
#>

function Get-DiskSpaceReport {
    [CmdletBinding()]
    param(
        [Parameter(Mandatory=$true)]
        [string]$Path,
        
        [int]$Depth = 2,
        [int]$TopCount = 10
    )
    
    Write-Host "`n=== Disk Space Analysis: $Path ===" -ForegroundColor Cyan
    
    function Get-FolderSize {
        param([string]$FolderPath)
        
        $size = 0
        $files = Get-ChildItem -Path $FolderPath -Recurse -File -ErrorAction SilentlyContinue
        foreach ($file in $files) {
            $size += $file.Length
        }
        return $size
    }
    
    # è·å–æ‰€æœ‰å­æ–‡ä»¶å¤¹
    $folders = Get-ChildItem -Path $Path -Directory -ErrorAction SilentlyContinue
    
    $folderSizes = foreach ($folder in $folders) {
        Write-Progress -Activity "Analyzing..." -Status $folder.Name
        
        $size = Get-FolderSize -FolderPath $folder.FullName
        
        [PSCustomObject]@{
            Folder = $folder.Name
            FullPath = $folder.FullName
            SizeBytes = $size
            SizeMB = [Math]::Round($size / 1MB, 2)
            SizeGB = [Math]::Round($size / 1GB, 2)
            FileCount = (Get-ChildItem -Path $folder.FullName -Recurse -File -ErrorAction SilentlyContinue).Count
        }
    }
    
    Write-Progress -Activity "Analyzing..." -Completed
    
    # æ€»è®¡
    $totalSize = ($folderSizes | Measure-Object -Property SizeBytes -Sum).Sum
    $totalSizeGB = [Math]::Round($totalSize / 1GB, 2)
    
    Write-Host "`nTotal Size: $totalSizeGB GB" -ForegroundColor Yellow
    Write-Host "`nTop $TopCount Largest Folders:" -ForegroundColor Yellow
    
    $folderSizes | 
        Sort-Object SizeBytes -Descending | 
        Select-Object -First $TopCount Folder, SizeGB, FileCount |
        Format-Table -AutoSize
}

# ä½¿ç”¨ç¤ºä¾‹
# Get-DiskSpaceReport -Path "C:\Users" -TopCount 20
```

---

## 8.8 è¯¾åç»ƒä¹ 

### ç»ƒä¹ 1: åŸºç¡€æ“ä½œ

å®Œæˆä»¥ä¸‹ä»»åŠ¡:
1. åˆ›å»ºç›®å½•ç»“æ„: Project\{src,tests,docs}
2. æ‰¹é‡åˆ›å»º10ä¸ªæµ‹è¯•æ–‡ä»¶
3. å°†æ‰€æœ‰.txtæ–‡ä»¶ç§»åŠ¨åˆ°docsç›®å½•

### ç»ƒä¹ 2: æ–‡ä»¶å¤„ç†

å¼€å‘å·¥å…·:
1. æ—¥å¿—æ–‡ä»¶åˆå¹¶å™¨
2. é‡å¤æ–‡ä»¶æŸ¥æ‰¾å™¨
3. æ–‡ä»¶æ‰¹é‡é‡å‘½åå·¥å…·

### ç»ƒä¹ 3: é«˜çº§åº”ç”¨

åˆ›å»º:
1. è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶è„šæœ¬
2. æ–‡ä»¶åŒæ­¥å·¥å…·
3. ç›®å½•é•œåƒå¤‡ä»½ç³»ç»Ÿ

---

## 8.9 æœ¬ç« å°ç»“

### æ ¸å¿ƒå‘½ä»¤

âœ… **å¯¼èˆª**: Get-Location, Set-Location

âœ… **åˆ—è¡¨**: Get-ChildItem

âœ… **æ“ä½œ**: New-Item, Copy-Item, Move-Item, Remove-Item, Rename-Item

âœ… **å†…å®¹**: Get-Content, Set-Content, Add-Content

âœ… **è·¯å¾„**: Join-Path, Split-Path, Test-Path, Resolve-Path

### å¸¸ç”¨æ¨¡å¼

```powershell
# é€’å½’æœç´¢
Get-ChildItem -Recurse -Filter "*.txt"

# æ‰¹é‡æ“ä½œ
Get-ChildItem *.txt | ForEach-Object {
    # æ“ä½œ
}

# å®‰å…¨åˆ é™¤
Remove-Item -WhatIf
Remove-Item -Confirm

# é”™è¯¯å¤„ç†
Get-ChildItem -ErrorAction SilentlyContinue
```

### ä¸‹ä¸€ç« é¢„å‘Š

**ç¬¬9ç«  - é”™è¯¯å¤„ç†ä¸è°ƒè¯•**,å°†å­¦ä¹ :
- âš ï¸ é”™è¯¯ç±»å‹å’Œå¤„ç†
- ğŸ› è°ƒè¯•æŠ€å·§
- ğŸ“ æ—¥å¿—è®°å½•
- ğŸ” æ•…éšœæ’æŸ¥

---

[â† ä¸Šä¸€ç« ](./7-å¯¹è±¡ä¸ç®¡é“.md) | [è¿”å›ç›®å½•](./README.md) | [ä¸‹ä¸€ç« : é”™è¯¯å¤„ç†ä¸è°ƒè¯• â†’](./9-é”™è¯¯å¤„ç†ä¸è°ƒè¯•.md)
