# ç¬¬3ç« ï¼šå˜é‡ä¸æ•°æ®ç±»å‹

> **å­¦ä¹ æ—¶é•¿**: 5-6å°æ—¶  
> **éš¾åº¦**: â­â­â­  
> **å‰ç½®çŸ¥è¯†**: ç¬¬1-2ç« 

## æœ¬ç« ç›®æ ‡

å­¦å®Œæœ¬ç« å,ä½ å°†èƒ½å¤Ÿ:

- âœ… åˆ›å»ºå’Œä½¿ç”¨å˜é‡
- âœ… ç†è§£PowerShellçš„æ•°æ®ç±»å‹ç³»ç»Ÿ
- âœ… ä½¿ç”¨æ•°ç»„å’Œå“ˆå¸Œè¡¨
- âœ… è¿›è¡Œç±»å‹è½¬æ¢
- âœ… ç†è§£å˜é‡ä½œç”¨åŸŸ
- âœ… ä½¿ç”¨ç‰¹æ®Šå˜é‡å’Œç¯å¢ƒå˜é‡

---

## 3.1 å˜é‡åŸºç¡€

### 3.1.1 ä»€ä¹ˆæ˜¯å˜é‡?

**å˜é‡**æ˜¯å­˜å‚¨æ•°æ®çš„å®¹å™¨,åœ¨PowerShellä¸­ç”¨`$`ç¬¦å·å¼€å¤´ã€‚

```powershell
# åˆ›å»ºå˜é‡
$name = "PowerShell"
$version = 7.4
$isActive = $true

# ä½¿ç”¨å˜é‡
Write-Host "Hello, $name!"
Write-Host "Version: $version"
```

**å˜é‡å‘½åè§„åˆ™**:

- âœ… å¿…é¡»ä»¥å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿å¼€å¤´
- âœ… å¯ä»¥åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿
- âœ… åŒºåˆ†å¤§å°å†™(ä½†é€šå¸¸ä¸åŒºåˆ†)
- âœ… å¯ä»¥ä½¿ç”¨`${}`åŒ…è£¹ç‰¹æ®Šåç§°

```powershell
# åˆæ³•çš„å˜é‡å
$userName = "Alice"
$user_age = 25
$User1 = "Bob"
$_temp = 100

# ç‰¹æ®Šå˜é‡å(ä½¿ç”¨å¤§æ‹¬å·)
${my-variable} = "value"
${file name} = "test.txt"
${user@domain} = "admin@example.com"

# ä¸åŒºåˆ†å¤§å°å†™
$name = "Test"
$Name = "Test2"  # è¦†ç›–äº†$name
```

### 3.1.2 åˆ›å»ºå˜é‡

**ç›´æ¥èµ‹å€¼**:

```powershell
# å­—ç¬¦ä¸²
$greeting = "Hello, World!"

# æ•°å­—
$count = 42
$price = 19.99

# å¸ƒå°”å€¼
$isEnabled = $true
$isDisabled = $false

# æ•°ç»„
$colors = "Red", "Green", "Blue"
$numbers = 1, 2, 3, 4, 5

# å“ˆå¸Œè¡¨
$person = @{
    Name = "Alice"
    Age = 30
    City = "Beijing"
}

# ç©ºå€¼
$empty = $null
```

**ä½¿ç”¨New-Variable**:

```powershell
# åˆ›å»ºå˜é‡
New-Variable -Name "greeting" -Value "Hello"

# åˆ›å»ºåªè¯»å˜é‡
New-Variable -Name "pi" -Value 3.14159 -Option ReadOnly

# åˆ›å»ºå¸¸é‡
New-Variable -Name "MAX_SIZE" -Value 100 -Option Constant

# å°è¯•ä¿®æ”¹åªè¯»å˜é‡(ä¼šå¤±è´¥)
$pi = 3.14  # é”™è¯¯

# å°è¯•ä¿®æ”¹å¸¸é‡(ä¼šå¤±è´¥)
$MAX_SIZE = 200  # é”™è¯¯

# åˆ é™¤åªè¯»å˜é‡
Remove-Variable pi -Force
```

### 3.1.3 æŸ¥çœ‹å’Œåˆ é™¤å˜é‡

```powershell
# æŸ¥çœ‹æ‰€æœ‰å˜é‡
Get-Variable

# æŸ¥çœ‹ç‰¹å®šå˜é‡
Get-Variable name
Get-Variable count

# æŸ¥çœ‹å˜é‡è¯¦ç»†ä¿¡æ¯
Get-Variable name | Format-List *

# æµ‹è¯•å˜é‡æ˜¯å¦å­˜åœ¨
Test-Path Variable:\name

# åˆ é™¤å˜é‡
Remove-Variable name

# æ¸…ç©ºå˜é‡(è®¾ä¸º$null)
Clear-Variable count
```

---

## 3.2 æ•°æ®ç±»å‹

### 3.2.1 PowerShellç±»å‹ç³»ç»Ÿ

PowerShellä½¿ç”¨.NETç±»å‹ç³»ç»Ÿ:

```powershell
# æŸ¥çœ‹å˜é‡ç±»å‹
$name = "PowerShell"
$name.GetType()

# è¾“å‡º
IsPublic IsSerial Name     BaseType
-------- -------- ----    --------
True     True     String  System.Object

# æŸ¥çœ‹ç±»å‹åç§°
$name.GetType().Name        # String
$name.GetType().FullName    # System.String
```

**ä¸»è¦æ•°æ®ç±»å‹**:

| ç±»å‹ | .NETç±»å‹ | ç¤ºä¾‹ |
|------|----------|------|
| å­—ç¬¦ä¸² | `[string]` | `"Hello"` |
| æ•´æ•° | `[int]`, `[long]` | `42`, `1000L` |
| æµ®ç‚¹æ•° | `[double]`, `[decimal]` | `3.14`, `19.99D` |
| å¸ƒå°” | `[bool]` | `$true`, `$false` |
| æ•°ç»„ | `[array]` | `@(1,2,3)` |
| å“ˆå¸Œè¡¨ | `[hashtable]` | `@{key="value"}` |
| æ—¥æœŸæ—¶é—´ | `[datetime]` | `Get-Date` |
| ç©ºå€¼ | `$null` | `$null` |

### 3.2.2 å­—ç¬¦ä¸²

**åˆ›å»ºå­—ç¬¦ä¸²**:

```powershell
# å•å¼•å·å­—ç¬¦ä¸²(å­—é¢é‡)
$literal = 'Hello, $name'
Write-Host $literal  # è¾“å‡º: Hello, $name

# åŒå¼•å·å­—ç¬¦ä¸²(å¯å±•å¼€)
$name = "PowerShell"
$message = "Hello, $name"
Write-Host $message  # è¾“å‡º: Hello, PowerShell

# å¤šè¡Œå­—ç¬¦ä¸²(Here-String)
$text = @"
This is a
multi-line
string
"@

# å­—é¢é‡å¤šè¡Œå­—ç¬¦ä¸²
$literal = @'
$variable won't be expanded
Multi-line literal
'@
```

**å­—ç¬¦ä¸²æ“ä½œ**:

```powershell
$text = "PowerShell"

# é•¿åº¦
$text.Length  # 10

# å¤§å°å†™
$text.ToUpper()       # POWERSHELL
$text.ToLower()       # powershell

# æ›¿æ¢
$text.Replace("Shell", "Core")  # PowerCore

# åˆ†å‰²
$text.Split("e")      # Pow rSh ll

# æˆªå–
$text.Substring(0, 5) # Power

# åˆ¤æ–­
$text.Contains("Shell")    # True
$text.StartsWith("Power")  # True
$text.EndsWith("Shell")    # True

# å»é™¤ç©ºç™½
$text = "  spaces  "
$text.Trim()    # "spaces"
$text.TrimStart()  # "spaces  "
$text.TrimEnd()    # "  spaces"

# æ ¼å¼åŒ–
$name = "Alice"
$age = 25
"Name: {0}, Age: {1}" -f $name, $age
"Name: $name, Age: $age"
```

**å­—ç¬¦ä¸²æ¯”è¾ƒ**:

```powershell
# åŒºåˆ†å¤§å°å†™
"Hello" -ceq "hello"  # False

# ä¸åŒºåˆ†å¤§å°å†™(é»˜è®¤)
"Hello" -eq "hello"   # True
"Hello" -ieq "hello"  # True

# æ¨¡å¼åŒ¹é…
"PowerShell" -like "*Shell"     # True
"PowerShell" -match "^Power"    # True

# åŒ…å«
"Hello World" -contains "World" # False (é’ˆå¯¹é›†åˆ)
"Hello World" -match "World"    # True
```

### 3.2.3 æ•°å­—ç±»å‹

**æ•´æ•°**:

```powershell
# æ•´æ•°ç±»å‹
[int]$small = 100
[long]$large = 1000000000L

# è¿›åˆ¶
$binary = 0b1010      # äºŒè¿›åˆ¶: 10
$octal = 0o12         # å…«è¿›åˆ¶: 10
$hex = 0xA            # åå…­è¿›åˆ¶: 10

# ç§‘å­¦è®¡æ•°æ³•
$scientific = 1.5e6   # 1500000

# èŒƒå›´
$range = 1..10        # 1,2,3,4,5,6,7,8,9,10
$reverse = 10..1      # 10,9,8,7,6,5,4,3,2,1
```

**æµ®ç‚¹æ•°**:

```powershell
# Double(é»˜è®¤)
$pi = 3.14159

# Decimal(é«˜ç²¾åº¦)
[decimal]$price = 19.99

# æ•°å­¦è¿ç®—
[Math]::PI            # 3.14159265358979
[Math]::E             # 2.71828182845905
[Math]::Sqrt(16)      # 4
[Math]::Pow(2, 3)     # 8
[Math]::Round(3.14159, 2)  # 3.14
[Math]::Floor(3.9)    # 3
[Math]::Ceiling(3.1)  # 4
[Math]::Abs(-10)      # 10
[Math]::Max(5, 10)    # 10
[Math]::Min(5, 10)    # 5
```

### 3.2.4 å¸ƒå°”å€¼

```powershell
# å¸ƒå°”å­—é¢é‡
$true
$false

# å¸ƒå°”è¿ç®—
$a = $true
$b = $false

$a -and $b   # False
$a -or $b    # True
-not $a      # False
!$a          # False

# çœŸå€¼è½¬æ¢
# ä»¥ä¸‹å€¼ä¸ºFalse:
$null
$false
0
""
@()          # ç©ºæ•°ç»„

# å…¶ä»–éƒ½æ˜¯True
if (1) { "True" }
if ("text") { "True" }
if (@(1,2,3)) { "True" }
```

---

## 3.3 æ•°ç»„

### 3.3.1 åˆ›å»ºæ•°ç»„

```powershell
# æ–¹å¼1: é€—å·åˆ†éš”
$colors = "Red", "Green", "Blue"

# æ–¹å¼2: æ•°ç»„æ“ä½œç¬¦
$numbers = @(1, 2, 3, 4, 5)

# æ–¹å¼3: èŒƒå›´æ“ä½œç¬¦
$range = 1..10

# ç©ºæ•°ç»„
$empty = @()

# å•å…ƒç´ æ•°ç»„
$single = @(1)
$single = ,1  # å¦ä¸€ç§å†™æ³•

# æ··åˆç±»å‹
$mixed = 1, "two", 3.0, $true

# å¤šç»´æ•°ç»„
$matrix = @(
    @(1, 2, 3),
    @(4, 5, 6),
    @(7, 8, 9)
)
```

### 3.3.2 è®¿é—®æ•°ç»„

```powershell
$colors = "Red", "Green", "Blue", "Yellow"

# ç´¢å¼•(ä»0å¼€å§‹)
$colors[0]    # Red
$colors[1]    # Green
$colors[-1]   # Yellow (æœ€åä¸€ä¸ª)
$colors[-2]   # Blue (å€’æ•°ç¬¬äºŒä¸ª)

# åˆ‡ç‰‡
$colors[0..2]   # Red, Green, Blue
$colors[1,3]    # Green, Yellow

# é•¿åº¦
$colors.Count   # 4
$colors.Length  # 4

# éå†
foreach ($color in $colors) {
    Write-Host $color
}

# ä½¿ç”¨ç´¢å¼•éå†
for ($i = 0; $i -lt $colors.Count; $i++) {
    Write-Host "$i : $($colors[$i])"
}
```

### 3.3.3 æ•°ç»„æ“ä½œ

```powershell
$numbers = 1, 2, 3

# æ·»åŠ å…ƒç´ 
$numbers += 4
$numbers += 5, 6, 7

# åˆå¹¶æ•°ç»„
$arr1 = 1, 2, 3
$arr2 = 4, 5, 6
$combined = $arr1 + $arr2

# æŸ¥æ‰¾
$colors = "Red", "Green", "Blue"
$colors -contains "Green"    # True
$colors.Contains("Yellow")   # False
$colors.IndexOf("Blue")      # 2

# æ’åº
$numbers = 5, 2, 8, 1, 9
$sorted = $numbers | Sort-Object
$reversed = $numbers | Sort-Object -Descending

# å»é‡
$duplicates = 1, 2, 2, 3, 3, 3
$unique = $duplicates | Select-Object -Unique

# è¿‡æ»¤
$numbers = 1..10
$evens = $numbers | Where-Object { $_ % 2 -eq 0 }

# æ˜ å°„
$numbers = 1..5
$squares = $numbers | ForEach-Object { $_ * $_ }

# æ•°ç»„è½¬å­—ç¬¦ä¸²
$colors = "Red", "Green", "Blue"
$colors -join ", "      # "Red, Green, Blue"
$colors -join " | "     # "Red | Green | Blue"
```

### 3.3.4 å¼ºç±»å‹æ•°ç»„

```powershell
# æŒ‡å®šç±»å‹
[int[]]$integers = 1, 2, 3
[string[]]$strings = "a", "b", "c"

# ç±»å‹æ£€æŸ¥
$integers += "text"  # é”™è¯¯!ç±»å‹ä¸åŒ¹é…

# ArrayList(å¯å˜å¤§å°)
$list = [System.Collections.ArrayList]@()
$list.Add("Item1")
$list.Add("Item2")
$list.Remove("Item1")
```

---

## 3.4 å“ˆå¸Œè¡¨

### 3.4.1 åˆ›å»ºå“ˆå¸Œè¡¨

```powershell
# åŸºæœ¬è¯­æ³•
$person = @{
    Name = "Alice"
    Age = 30
    City = "Beijing"
}

# ç©ºå“ˆå¸Œè¡¨
$empty = @{}

# æœ‰åºå“ˆå¸Œè¡¨
$ordered = [ordered]@{
    First = 1
    Second = 2
    Third = 3
}

# åµŒå¥—å“ˆå¸Œè¡¨
$user = @{
    Name = "Bob"
    Contact = @{
        Email = "bob@example.com"
        Phone = "123-456-7890"
    }
    Tags = @("admin", "developer")
}
```

### 3.4.2 è®¿é—®å’Œä¿®æ”¹

```powershell
$person = @{
    Name = "Alice"
    Age = 30
    City = "Beijing"
}

# è®¿é—®å€¼
$person["Name"]     # Alice
$person.Name        # Alice
$person.Age         # 30

# ä¿®æ”¹å€¼
$person["Age"] = 31
$person.City = "Shanghai"

# æ·»åŠ é”®å€¼å¯¹
$person["Email"] = "alice@example.com"
$person.Phone = "123-456-7890"

# åˆ é™¤é”®
$person.Remove("Phone")

# æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨
$person.ContainsKey("Name")    # True
$person.ContainsKey("Gender")  # False

# è·å–æ‰€æœ‰é”®
$person.Keys

# è·å–æ‰€æœ‰å€¼
$person.Values

# é”®å€¼å¯¹æ•°é‡
$person.Count
```

### 3.4.3 éå†å“ˆå¸Œè¡¨

```powershell
$person = @{
    Name = "Alice"
    Age = 30
    City = "Beijing"
}

# æ–¹å¼1: éå†é”®
foreach ($key in $person.Keys) {
    Write-Host "$key : $($person[$key])"
}

# æ–¹å¼2: ä½¿ç”¨GetEnumerator
$person.GetEnumerator() | ForEach-Object {
    Write-Host "$($_.Key) = $($_.Value)"
}

# æ–¹å¼3: ç®¡é“
$person.GetEnumerator() | ForEach-Object {
    [PSCustomObject]@{
        Property = $_.Key
        Value = $_.Value
    }
}
```

---

## 3.5 ç±»å‹è½¬æ¢

### 3.5.1 éšå¼è½¬æ¢

```powershell
# è‡ªåŠ¨ç±»å‹è½¬æ¢
$number = "123"
$result = $number + 1  # "1231" (å­—ç¬¦ä¸²æ‹¼æ¥)

$number = 123
$result = $number + "1"  # 124 (æ•°å­—åŠ æ³•)
```

### 3.5.2 æ˜¾å¼è½¬æ¢

```powershell
# è½¬æ¢ä¸ºå­—ç¬¦ä¸²
[string]123         # "123"
[string]$true       # "True"

# è½¬æ¢ä¸ºæ•´æ•°
[int]"123"          # 123
[int]"3.14"         # 3
[int]$true          # 1
[int]$false         # 0

# è½¬æ¢ä¸ºæµ®ç‚¹æ•°
[double]"3.14"      # 3.14
[decimal]"19.99"    # 19.99

# è½¬æ¢ä¸ºå¸ƒå°”å€¼
[bool]1             # True
[bool]0             # False
[bool]"text"        # True
[bool]""            # False

# è½¬æ¢ä¸ºæ•°ç»„
[array]"single"     # @("single")

# è½¬æ¢ä¸ºæ—¥æœŸ
[datetime]"2024-01-15"
[datetime]"2024-01-15 10:30:00"
```

### 3.5.3 ç±»å‹éªŒè¯

```powershell
# æ£€æŸ¥ç±»å‹
$value = 123
$value -is [int]        # True
$value -is [string]     # False

# ç±»å‹ä¸æ˜¯
$value -isnot [string]  # True

# å¤šç§ç±»å‹æ£€æŸ¥
if ($value -is [int] -or $value -is [long]) {
    "It's a number"
}
```

---

## 3.6 ç‰¹æ®Šå˜é‡

### 3.6.1 è‡ªåŠ¨å˜é‡

PowerShellå†…ç½®çš„è‡ªåŠ¨å˜é‡:

```powershell
# å½“å‰ç®¡é“å¯¹è±¡
$_           # æˆ– $PSItem

# ä¸Šä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºä»£ç 
$LASTEXITCODE

# ä¸Šä¸€æ¡å‘½ä»¤æ˜¯å¦æˆåŠŸ
$?

# é”™è¯¯ä¿¡æ¯
$Error       # é”™è¯¯æ•°ç»„
$Error[0]    # æœ€æ–°é”™è¯¯

# ä¸»ç›®å½•
$HOME        # ç”¨æˆ·ä¸»ç›®å½•
$PSHOME      # PowerShellå®‰è£…ç›®å½•

# è¿›ç¨‹ID
$PID

# PowerShellç‰ˆæœ¬
$PSVersionTable

# å½“å‰æ–‡åŒ–
$PSCulture

# çœŸ/å‡
$true
$false

# ç©ºå€¼
$null

# å‚æ•°
$Args        # å‡½æ•°å‚æ•°æ•°ç»„
$MyInvocation  # è°ƒç”¨ä¿¡æ¯
```

**ä½¿ç”¨ç¤ºä¾‹**:

```powershell
# $_ åœ¨ç®¡é“ä¸­ä½¿ç”¨
1..5 | ForEach-Object { $_ * 2 }

# $Error é”™è¯¯å¤„ç†
try {
    Get-Item "C:\NonExistent"
} catch {
    Write-Host "Error: $($Error[0].Exception.Message)"
}

# $? æ£€æŸ¥å‘½ä»¤æ˜¯å¦æˆåŠŸ
Get-Process notepad
if ($?) {
    Write-Host "Command succeeded"
} else {
    Write-Host "Command failed"
}
```

### 3.6.2 ç¯å¢ƒå˜é‡

```powershell
# è®¿é—®ç¯å¢ƒå˜é‡
$env:USERNAME
$env:COMPUTERNAME
$env:PATH
$env:USERPROFILE
$env:TEMP

# è®¾ç½®ç¯å¢ƒå˜é‡(å½“å‰ä¼šè¯)
$env:MY_VAR = "Hello"

# æ°¸ä¹…è®¾ç½®(ç”¨æˆ·çº§åˆ«)
[Environment]::SetEnvironmentVariable("MY_VAR", "Hello", "User")

# æ°¸ä¹…è®¾ç½®(ç³»ç»Ÿçº§åˆ«,éœ€è¦ç®¡ç†å‘˜)
[Environment]::SetEnvironmentVariable("MY_VAR", "Hello", "Machine")

# æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡
Get-ChildItem Env:

# åˆ é™¤ç¯å¢ƒå˜é‡
Remove-Item Env:\MY_VAR
```

---

## 3.7 å˜é‡ä½œç”¨åŸŸ

### 3.7.1 ä½œç”¨åŸŸç±»å‹

```powershell
# Global - å…¨å±€ä½œç”¨åŸŸ
$global:var = "Global"

# Script - è„šæœ¬ä½œç”¨åŸŸ
$script:var = "Script"

# Local - æœ¬åœ°ä½œç”¨åŸŸ(é»˜è®¤)
$local:var = "Local"
$var = "Local"  # ç­‰åŒ

# Private - ç§æœ‰ä½œç”¨åŸŸ
$private:var = "Private"
```

### 3.7.2 ä½œç”¨åŸŸè§„åˆ™

```powershell
# å…¨å±€å˜é‡
$global:AppName = "MyApp"

function Test-Scope {
    # å±€éƒ¨å˜é‡
    $localVar = "Local"
    
    # è®¿é—®å…¨å±€å˜é‡
    Write-Host $global:AppName
    
    # ä¿®æ”¹å…¨å±€å˜é‡
    $global:AppName = "ModifiedApp"
}

Test-Scope
Write-Host $global:AppName  # ModifiedApp
Write-Host $localVar        # æ— è¾“å‡º(ä¸å­˜åœ¨)
```

---

## 3.8 å®éªŒ:æ•°æ®ç®¡ç†

### å®éªŒ1: å­¦ç”Ÿæˆç»©ç®¡ç†

```powershell
<#
.SYNOPSIS
    å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ
.DESCRIPTION
    ä½¿ç”¨å“ˆå¸Œè¡¨å’Œæ•°ç»„ç®¡ç†å­¦ç”Ÿä¿¡æ¯å’Œæˆç»©
#>

# åˆ›å»ºå­¦ç”Ÿæ•°æ®
$students = @(
    @{
        Name = "Alice"
        ID = "S001"
        Scores = @{
            Math = 95
            English = 88
            Science = 92
        }
    },
    @{
        Name = "Bob"
        ID = "S002"
        Scores = @{
            Math = 78
            English = 85
            Science = 90
        }
    },
    @{
        Name = "Charlie"
        ID = "S003"
        Scores = @{
            Math = 92
            English = 94
            Science = 89
        }
    }
)

# è®¡ç®—å¹³å‡åˆ†
function Get-AverageScore {
    param($Student)
    
    $total = 0
    $count = 0
    
    foreach ($score in $Student.Scores.Values) {
        $total += $score
        $count++
    }
    
    return [Math]::Round($total / $count, 2)
}

# æ˜¾ç¤ºæˆç»©æŠ¥å‘Š
Write-Host "`n=== Student Grade Report ===" -ForegroundColor Cyan
Write-Host ("=" * 70)

foreach ($student in $students) {
    $avg = Get-AverageScore -Student $student
    
    Write-Host "`nStudent: $($student.Name) (ID: $($student.ID))"
    Write-Host "  Math:    $($student.Scores.Math)"
    Write-Host "  English: $($student.Scores.English)"
    Write-Host "  Science: $($student.Scores.Science)"
    Write-Host "  Average: $avg" -ForegroundColor Green
}

Write-Host "`n" + ("=" * 70)

# æ‰¾å‡ºæœ€é«˜å¹³å‡åˆ†
$topStudent = $students | ForEach-Object {
    [PSCustomObject]@{
        Name = $_.Name
        Average = Get-AverageScore -Student $_
    }
} | Sort-Object Average -Descending | Select-Object -First 1

Write-Host "`nTop Student: $($topStudent.Name) with average $($topStudent.Average)" -ForegroundColor Yellow
```

### å®éªŒ2: ç±»å‹è½¬æ¢å·¥å…·

```powershell
<#
.SYNOPSIS
    ç±»å‹è½¬æ¢å·¥å…·
.DESCRIPTION
    æ¼”ç¤ºå„ç§æ•°æ®ç±»å‹è½¬æ¢
#>

function Convert-Value {
    param(
        [Parameter(Mandatory)]
        $Value,
        
        [Parameter(Mandatory)]
        [string]$TargetType
    )
    
    Write-Host "`nOriginal Value: $Value"
    Write-Host "Original Type: $($Value.GetType().Name)"
    
    try {
        $result = switch ($TargetType) {
            "String" { [string]$Value }
            "Int" { [int]$Value }
            "Double" { [double]$Value }
            "Bool" { [bool]$Value }
            "DateTime" { [datetime]$Value }
            default { throw "Unsupported type: $TargetType" }
        }
        
        Write-Host "Converted Value: $result" -ForegroundColor Green
        Write-Host "Converted Type: $($result.GetType().Name)" -ForegroundColor Green
        
        return $result
    }
    catch {
        Write-Host "Conversion failed: $_" -ForegroundColor Red
        return $null
    }
}

# æµ‹è¯•è½¬æ¢
Convert-Value -Value "123" -TargetType "Int"
Convert-Value -Value "3.14" -TargetType "Double"
Convert-Value -Value "true" -TargetType "Bool"
Convert-Value -Value "2024-01-15" -TargetType "DateTime"
```

---

## 3.9 è¯¾åç»ƒä¹ 

### ç»ƒä¹ 1: æ•°ç»„æ“ä½œ

åˆ›å»ºä¸€ä¸ª1-100çš„æ•°ç»„,æ‰¾å‡º:
1. æ‰€æœ‰å¶æ•°
2. æ‰€æœ‰èƒ½è¢«3æ•´é™¤çš„æ•°
3. æ‰€æœ‰è´¨æ•°

### ç»ƒä¹ 2: å“ˆå¸Œè¡¨åº”ç”¨

åˆ›å»ºä¸€ä¸ªå“ˆå¸Œè¡¨å­˜å‚¨5æœ¬ä¹¦çš„ä¿¡æ¯(ä¹¦åã€ä½œè€…ã€ä»·æ ¼),ç„¶å:
1. æŒ‰ä»·æ ¼æ’åº
2. æ‰¾å‡ºæœ€è´µçš„ä¹¦
3. è®¡ç®—æ€»ä»·

### ç»ƒä¹ 3: ç±»å‹è½¬æ¢

ç¼–å†™å‡½æ•°éªŒè¯å¹¶è½¬æ¢ç”¨æˆ·è¾“å…¥:
1. å­—ç¬¦ä¸²è½¬æ•°å­—(å¸¦é”™è¯¯å¤„ç†)
2. æ—¥æœŸå­—ç¬¦ä¸²è½¬DateTime
3. å­—ç¬¦ä¸²è½¬å¸ƒå°”å€¼

---

## 3.10 æœ¬ç« å°ç»“

### æ ¸å¿ƒæ¦‚å¿µ

âœ… **å˜é‡**: ç”¨`$`å¼€å¤´,å­˜å‚¨æ•°æ®

âœ… **æ•°æ®ç±»å‹**: String, Int, Double, Bool, Array, Hashtable

âœ… **æ•°ç»„**: æœ‰åºé›†åˆ,æ”¯æŒç´¢å¼•å’Œåˆ‡ç‰‡

âœ… **å“ˆå¸Œè¡¨**: é”®å€¼å¯¹é›†åˆ

âœ… **ç±»å‹è½¬æ¢**: éšå¼å’Œæ˜¾å¼è½¬æ¢

âœ… **ä½œç”¨åŸŸ**: Global, Script, Local, Private

### å…³é”®è¯­æ³•

```powershell
# å˜é‡
$var = "value"
[type]$var = value

# æ•°ç»„
$arr = 1, 2, 3
$arr = @(1, 2, 3)

# å“ˆå¸Œè¡¨
$hash = @{key="value"}

# ç±»å‹è½¬æ¢
[int]"123"
$value -is [type]

# ä½œç”¨åŸŸ
$global:var
$script:var
$local:var
```

### ä¸‹ä¸€ç« é¢„å‘Š

**ç¬¬4ç«  - è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼**,å°†å­¦ä¹ :
- â• ç®—æœ¯è¿ç®—ç¬¦
- ğŸ” æ¯”è¾ƒè¿ç®—ç¬¦
- ğŸ”— é€»è¾‘è¿ç®—ç¬¦
- ğŸ“Š å…¶ä»–è¿ç®—ç¬¦

---

[â† ä¸Šä¸€ç« ](./2-PowerShellåŸºç¡€è¯­æ³•.md) | [è¿”å›ç›®å½•](./README.md) | [ä¸‹ä¸€ç« : è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼ â†’](./4-è¿ç®—ç¬¦ä¸è¡¨è¾¾å¼.md)
