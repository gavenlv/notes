# 第3章：多语言开发环境配置

## 3.1 Python开发环境配置

### 3.1.1 基础Python环境

```json
{
    "name": "Python开发环境",
    "image": "mcr.microsoft.com/devcontainers/python:3.11",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "python.linting.enabled": true,
                "python.linting.pylintEnabled": true,
                "python.formatting.autopep8Path": "/usr/local/py-utils/bin/autopep8"
            },
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-python.black-formatter"
            ]
        }
    },
    "postCreateCommand": "pip install --upgrade pip && pip install -r requirements.txt"
}
```

### 3.1.2 数据科学环境

```json
{
    "name": "Python数据科学",
    "image": "mcr.microsoft.com/devcontainers/python:3.11",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "jupyter.notebookFileRoot": "/workspace"
            },
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-toolsai.jupyter",
                "ms-toolsai.jupyter-keymap",
                "ms-toolsai.jupyter-renderers"
            ]
        }
    },
    "forwardPorts": [8888],
    "postCreateCommand": "pip install numpy pandas matplotlib seaborn scikit-learn jupyter plotly"
}
```

### 3.1.3 Web开发环境（Django/Flask）

```json
{
    "name": "Python Web开发",
    "image": "mcr.microsoft.com/devcontainers/python:3.11",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "python.defaultInterpreterPath": "/usr/local/bin/python"
            },
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "batisteo.vscode-django",
                "ms-azuretools.vscode-docker"
            ]
        }
    },
    "forwardPorts": [8000, 5432],
    "postCreateCommand": "pip install django flask fastapi uvicorn gunicorn psycopg2-binary"
}
```

## 3.2 Node.js开发环境配置

### 3.2.1 基础Node.js环境

```json
{
    "name": "Node.js开发环境",
    "image": "mcr.microsoft.com/devcontainers/javascript-node:18",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "editor.formatOnSave": true,
                "eslint.validate": ["javascript", "typescript"]
            },
            "extensions": [
                "ms-vscode.vscode-typescript-next",
                "esbenp.prettier-vscode",
                "dbaeumer.vscode-eslint"
            ]
        }
    },
    "postCreateCommand": "npm install -g npm@latest && npm install"
}
```

### 3.2.2 React前端开发环境

```json
{
    "name": "React开发环境",
    "image": "mcr.microsoft.com/devcontainers/javascript-node:18",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "editor.formatOnSave": true,
                "emmet.includeLanguages": {
                    "javascript": "javascriptreact"
                }
            },
            "extensions": [
                "ms-vscode.vscode-typescript-next",
                "bradlc.vscode-tailwindcss",
                "esbenp.prettier-vscode",
                "dsznajder.es7-react-js-snippets"
            ]
        }
    },
    "forwardPorts": [3000],
    "postCreateCommand": "npm install -g create-react-app && npm install"
}
```

### 3.2.3 全栈开发环境（Node.js + 数据库）

```json
{
    "name": "Node.js全栈开发",
    "image": "mcr.microsoft.com/devcontainers/javascript-node:18",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "editor.formatOnSave": true
            },
            "extensions": [
                "ms-vscode.vscode-typescript-next",
                "esbenp.prettier-vscode",
                "ms-azuretools.vscode-docker",
                "mongodb.mongodb-vscode"
            ]
        }
    },
    "forwardPorts": [3000, 3001, 27017, 5432],
    "postCreateCommand": "npm install -g @nestjs/cli && npm install"
}
```

## 3.3 Java开发环境配置

### 3.3.1 Java基础环境

```json
{
    "name": "Java开发环境",
    "image": "mcr.microsoft.com/devcontainers/java:17",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "java.configuration.updateBuildConfiguration": "automatic"
            },
            "extensions": [
                "redhat.java",
                "vscjava.vscode-java-pack",
                "vscjava.vscode-maven",
                "vmware.vscode-spring-boot"
            ]
        }
    },
    "postCreateCommand": "mvn clean compile"
}
```

### 3.3.2 Spring Boot开发环境

```json
{
    "name": "Spring Boot开发",
    "image": "mcr.microsoft.com/devcontainers/java:17",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "java.configuration.updateBuildConfiguration": "automatic"
            },
            "extensions": [
                "redhat.java",
                "vscjava.vscode-java-pack",
                "vmware.vscode-spring-boot",
                "vmware.vscode-spring-initializr"
            ]
        }
    },
    "forwardPorts": [8080, 5432],
    "postCreateCommand": "mvn clean compile"
}
```

## 3.4 Go开发环境配置

### 3.4.1 Go基础环境

```json
{
    "name": "Go开发环境",
    "image": "mcr.microsoft.com/devcontainers/go:1.20",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "go.gopath": "/go",
                "go.useLanguageServer": true
            },
            "extensions": [
                "golang.Go",
                "ms-vscode.makefile-tools"
            ]
        }
    },
    "postCreateCommand": "go mod tidy && go mod download"
}
```

### 3.4.2 Go Web开发环境

```json
{
    "name": "Go Web开发",
    "image": "mcr.microsoft.com/devcontainers/go:1.20",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "golang.Go",
                "ms-azuretools.vscode-docker"
            ]
        }
    },
    "forwardPorts": [8080, 5432],
    "postCreateCommand": "go mod tidy && go mod download"
}
```

## 3.5 Rust开发环境配置

### 3.5.1 Rust基础环境

```json
{
    "name": "Rust开发环境",
    "image": "mcr.microsoft.com/devcontainers/rust:1",
    "features": {
        "ghcr.io/devcontainers/features/git:1": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "rust-analyzer.check.command": "clippy"
            },
            "extensions": [
                "rust-lang.rust-analyzer",
                "bungcip.better-toml",
                "vadimcn.vscode-lldb"
            ]
        }
    },
    "postCreateCommand": "cargo build"
}
```

## 3.6 多语言混合开发环境

### 3.6.1 前后端分离项目

```json
{
    "name": "前后端分离项目",
    "image": "mcr.microsoft.com/devcontainers/base:ubuntu",
    "features": {
        "ghcr.io/devcontainers/features/node:1": {
            "version": "18"
        },
        "ghcr.io/devcontainers/features/python:1": {
            "version": "3.11"
        },
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {}
    },
    "customizations": {
        "vscode": {
            "settings": {
                "python.defaultInterpreterPath": "/usr/local/bin/python",
                "editor.formatOnSave": true
            },
            "extensions": [
                "ms-python.python",
                "ms-python.vscode-pylance",
                "ms-vscode.vscode-typescript-next",
                "esbenp.prettier-vscode",
                "ms-azuretools.vscode-docker"
            ]
        }
    },
    "forwardPorts": [3000, 8000, 5432],
    "postCreateCommand": "cd frontend && npm install && cd ../backend && pip install -r requirements.txt"
}
```

### 3.6.2 微服务架构项目

```json
{
    "name": "微服务项目",
    "image": "mcr.microsoft.com/devcontainers/base:ubuntu",
    "features": {
        "ghcr.io/devcontainers/features/node:1": {
            "version": "18"
        },
        "ghcr.io/devcontainers/features/java:1": {
            "version": "17",
            "installMaven": true
        },
        "ghcr.io/devcontainers/features/python:1": {
            "version": "3.11"
        },
        "ghcr.io/devcontainers/features/git:1": {},
        "ghcr.io/devcontainers/features/docker-in-docker:2": {},
        "ghcr.io/devcontainers/features/kubernetes-helm:1": {}
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-vscode.vscode-typescript-next",
                "redhat.java",
                "ms-azuretools.vscode-docker",
                "ms-kubernetes-tools.vscode-kubernetes-tools"
            ]
        }
    },
    "forwardPorts": [3000, 8080, 8081, 8082, 5432, 27017],
    "postCreateCommand": "echo '请根据具体项目结构安装依赖'"
}
```

## 3.7 数据库和工具集成

### 3.7.1 数据库容器集成

```json
{
    "name": "带数据库的开发环境",
    "dockerComposeFile": "docker-compose.yml",
    "service": "app",
    "workspaceFolder": "/workspace",
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-python.python",
                "ms-azuretools.vscode-docker",
                "mtxr.sqltools",
                "mtxr.sqltools-driver-pg"
            ]
        }
    }
}
```

对应的 `docker-compose.yml`:

```yaml
version: '3.8'
services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - .:/workspace
    command: sleep infinity
    depends_on:
      - postgres
      - redis

  postgres:
    image: postgres:14
    environment:
      POSTGRES_DB: myapp
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"

  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
```

## 3.8 环境配置最佳实践

### 3.8.1 版本锁定

```json
{
    "image": "mcr.microsoft.com/devcontainers/python:3.11@sha256:abc123...",
    "features": {
        "ghcr.io/devcontainers/features/node:1": {
            "version": "18.17.0"
        }
    }
}
```

### 3.8.2 分层构建优化

```dockerfile
# 基础层：系统依赖
FROM mcr.microsoft.com/devcontainers/base:ubuntu
RUN apt-get update && apt-get install -y git curl

# 开发工具层
RUN curl -fsSL https://deb.nodesource.com/setup_18.x | bash - && \
    apt-get install -y nodejs

# 项目依赖层
COPY package.json .
RUN npm install

# 源代码层
COPY . .
```

### 3.8.3 环境变量管理

```json
{
    "remoteEnv": {
        "NODE_ENV": "development",
        "DATABASE_URL": "postgresql://user:password@localhost:5432/myapp",
        "REDIS_URL": "redis://localhost:6379"
    }
}
```

## 3.9 本章总结

本章我们详细学习了：

- Python开发环境的多种配置方式
- Node.js前端和后端开发环境
- Java和Spring Boot开发环境
- Go和Rust开发环境
- 多语言混合开发环境配置
- 数据库和工具集成
- 环境配置的最佳实践

每种语言环境都提供了从基础到高级的配置示例，你可以根据项目需求选择合适的配置。

---

**实践任务**：
1. 为你常用的编程语言创建一个DevContainer环境
2. 尝试配置多语言混合开发环境
3. 集成数据库和其他开发工具
4. 测试环境的功能完整性

**下一章**：[第4章：高级特性和最佳实践](./04-高级特性和最佳实践.md)