# ç¬¬11ç« ï¼šä»£ç ç¤ºä¾‹ç›®å½•

## ğŸ“ æœ¬ç« æ¦‚è¿°

æœ¬ç« æä¾›Jenkinsæ•™ç¨‹çš„å®Œæ•´ä»£ç ç¤ºä¾‹ï¼ŒæŒ‰ç« èŠ‚ç»„ç»‡ï¼Œæ¯ä¸ªç¤ºä¾‹éƒ½åŒ…å«è¯¦ç»†çš„å®ç°è¯´æ˜å’Œè¿è¡ŒæŒ‡å—ã€‚æ‰€æœ‰ä»£ç éƒ½æ˜¯ç”Ÿäº§çº§åˆ«çš„ï¼Œå¯ä»¥ç›´æ¥ç”¨äºå®é™…é¡¹ç›®ã€‚

### ğŸ¯ å­¦ä¹ ç›®æ ‡

- æŒæ¡å„ä¸ªJenkinsåŠŸèƒ½çš„å®é™…ä»£ç å®ç°
- ç†è§£å¦‚ä½•å°†ç†è®ºçŸ¥è¯†åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­
- å­¦ä¼šè°ƒè¯•å’Œä¼˜åŒ–Jenkins Pipeline
- æŒæ¡ä¼ä¸šçº§CI/CDè§£å†³æ–¹æ¡ˆçš„æ„å»ºæ–¹æ³•

## ğŸ“‹ ç¤ºä¾‹ç»„ç»‡ç»“æ„

```
code/
â”œâ”€â”€ 01-basic-concepts/           # ç¬¬1ç« ï¼šåŸºç¡€æ¦‚å¿µç¤ºä¾‹
â”œâ”€â”€ 02-installation-config/     # ç¬¬2ç« ï¼šå®‰è£…é…ç½®ç¤ºä¾‹
â”œâ”€â”€ 03-pipeline-examples/       # ç¬¬3ç« ï¼šPipelineç¤ºä¾‹
â”œâ”€â”€ 04-plugins-ecosystem/       # ç¬¬4ç« ï¼šæ’ä»¶ç”Ÿæ€ç¤ºä¾‹
â”œâ”€â”€ 05-distributed-builds/      # ç¬¬5ç« ï¼šåˆ†å¸ƒå¼æ„å»ºç¤ºä¾‹
â”œâ”€â”€ 06-security-practices/      # ç¬¬6ç« ï¼šå®‰å…¨å®è·µç¤ºä¾‹
â”œâ”€â”€ 07-container-integration/   # ç¬¬7ç« ï¼šå®¹å™¨é›†æˆç¤ºä¾‹
â”œâ”€â”€ 08-enterprise-practices/    # ç¬¬8ç« ï¼šä¼ä¸šçº§å®è·µç¤ºä¾‹
â”œâ”€â”€ 09-performance-monitoring/  # ç¬¬9ç« ï¼šæ€§èƒ½ç›‘æ§ç¤ºä¾‹
â””â”€â”€ 10-comprehensive-cases/     # ç¬¬10ç« ï¼šç»¼åˆæ¡ˆä¾‹ç¤ºä¾‹
```

## ğŸš€ å¿«é€Ÿå¼€å§‹æŒ‡å—

### 1. ç¯å¢ƒè¦æ±‚

**åŸºç¡€ç¯å¢ƒ**
```bash
# æ£€æŸ¥Javaç‰ˆæœ¬
java -version  # éœ€è¦Java 11+

# æ£€æŸ¥Docker
docker --version  # éœ€è¦Docker 20.10+

# æ£€æŸ¥Git
git --version  # éœ€è¦Git 2.30+

# æ£€æŸ¥Maven
mvn --version  # éœ€è¦Maven 3.6+
```

**Jenkinsç¯å¢ƒé…ç½®**
```bash
# Jenkinså¯åŠ¨è„šæœ¬ç¤ºä¾‹
#!/bin/bash
# jenkins-start.sh

export JAVA_OPTS="-Xmx2g -Xms1g -XX:+UseG1GC"
export JENKINS_HOME="/opt/jenkins"
export JENKINS_PORT="8080"

java -jar jenkins.war --httpPort=${JENKINS_PORT} \
  --prefix=/jenkins \
  --webroot=${JENKINS_HOME}/war \
  ${JAVA_OPTS}
```

### 2. ç¤ºä¾‹è¿è¡Œæµç¨‹

**é€šç”¨è¿è¡Œæ­¥éª¤**
```bash
# 1. è¿›å…¥ç¤ºä¾‹ç›®å½•
cd code/01-basic-concepts/simple-pipeline

# 2. é˜…è¯»è¯´æ˜æ–‡æ¡£
cat README.md

# 3. å‡†å¤‡ç¯å¢ƒ
./scripts/setup.sh

# 4. è¿è¡Œç¤ºä¾‹
./scripts/run.sh

# 5. éªŒè¯ç»“æœ
./scripts/verify.sh
```

## ğŸ“Š è¯¦ç»†ç¤ºä¾‹è¯´æ˜

### ç¤ºä¾‹1ï¼šåŸºç¡€æ¦‚å¿µç¤ºä¾‹

**ç›®å½•ç»“æ„**
```
01-basic-concepts/
â”œâ”€â”€ simple-pipeline/
â”‚   â”œâ”€â”€ Jenkinsfile           # ç®€å•Pipelineå®šä¹‰
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ setup.sh          # ç¯å¢ƒå‡†å¤‡è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ build.sh          # æ„å»ºè„šæœ¬
â”‚   â”‚   â””â”€â”€ test.sh           # æµ‹è¯•è„šæœ¬
â”‚   â”œâ”€â”€ src/                  # æºä»£ç 
â”‚   â”œâ”€â”€ test/                 # æµ‹è¯•ä»£ç 
â”‚   â””â”€â”€ README.md             # è¯¦ç»†è¯´æ˜
â”œâ”€â”€ jenkins-architecture/
â”‚   â”œâ”€â”€ architecture-diagram/ # æ¶æ„å›¾
â”‚   â”œâ”€â”€ configuration/        # é…ç½®ç¤ºä¾‹
â”‚   â””â”€â”€ README.md
â””â”€â”€ cicd-workflow/
    â”œâ”€â”€ workflow-diagram/     # å·¥ä½œæµå›¾
    â”œâ”€â”€ examples/             # å·¥ä½œæµç¤ºä¾‹
    â””â”€â”€ README.md
```

**ç®€å•Pipelineç¤ºä¾‹**
```groovy
// Jenkinsfile - ç®€å•ä½†å®Œæ•´çš„Pipeline
pipeline {
    agent any
    
    options {
        timeout(time: 30, unit: 'MINUTES')
        timestamps()
    }
    
    stages {
        stage('ä»£ç æ£€å‡º') {
            steps {
                checkout scm
            }
        }
        
        stage('æ„å»º') {
            steps {
                sh 'mvn clean compile'
            }
        }
        
        stage('æµ‹è¯•') {
            steps {
                sh 'mvn test'
            }
            post {
                always {
                    junit 'target/surefire-reports/*.xml'
                }
            }
        }
        
        stage('éƒ¨ç½²') {
            when {
                expression { env.BRANCH_NAME == 'main' }
            }
            steps {
                sh 'mvn deploy'
            }
        }
    }
    
    post {
        always {
            emailext (
                subject: "æ„å»º ${currentBuild.result}: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                body: "æ„å»ºè¯¦æƒ…è¯·æŸ¥çœ‹: ${env.BUILD_URL}",
                to: 'developer@company.com'
            )
        }
    }
}
```

### ç¤ºä¾‹2ï¼šå®‰è£…é…ç½®ç¤ºä¾‹

**ç›®å½•ç»“æ„**
```
02-installation-config/
â”œâ”€â”€ docker-installation/
â”‚   â”œâ”€â”€ docker-compose.yml     # Docker Composeé…ç½®
â”‚   â”œâ”€â”€ jenkins.Dockerfile     # è‡ªå®šä¹‰Jenkinsé•œåƒ
â”‚   â”œâ”€â”€ scripts/
â”‚   â”‚   â”œâ”€â”€ install-docker.sh  # Dockerå®‰è£…è„šæœ¬
â”‚   â”‚   â””â”€â”€ start-jenkins.sh   # Jenkinså¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ kubernetes-install/
â”‚   â”œâ”€â”€ jenkins-deployment.yaml # K8Séƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ jenkins-service.yaml   # K8SæœåŠ¡é…ç½®
â”‚   â”œâ”€â”€ jenkins-pvc.yaml       # å­˜å‚¨é…ç½®
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ backup-recovery/
â”‚   â”œâ”€â”€ backup-script.sh       # å¤‡ä»½è„šæœ¬
â”‚   â”œâ”€â”€ recovery-script.sh     # æ¢å¤è„šæœ¬
â”‚   â””â”€â”€ README.md
â””â”€â”€ production-setup/
    â”œâ”€â”€ security-config/       # å®‰å…¨é…ç½®
    â”œâ”€â”€ performance-tuning/    # æ€§èƒ½è°ƒä¼˜
    â””â”€â”€ README.md
```

**Dockerå®‰è£…é…ç½®ç¤ºä¾‹**
```yaml
# docker-compose.yml
version: '3.8'

services:
  jenkins:
    image: jenkins/jenkins:lts-jdk11
    container_name: jenkins
    user: root
    ports:
      - "8080:8080"
      - "50000:50000"
    volumes:
      - jenkins_home:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      - JAVA_OPTS=-Xmx2g -Xms1g -Djenkins.install.runSetupWizard=false
    restart: unless-stopped

volumes:
  jenkins_home:
```

### ç¤ºä¾‹3ï¼šPipelineç¤ºä¾‹

**ç›®å½•ç»“æ„**
```
03-pipeline-examples/
â”œâ”€â”€ declarative-pipeline/
â”‚   â”œâ”€â”€ Jenkinsfile.declarative # å£°æ˜å¼Pipeline
â”‚   â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ scripted-pipeline/
â”‚   â”œâ”€â”€ Jenkinsfile.scripted    # è„šæœ¬å¼Pipeline
â”‚   â”œâ”€â”€ groovy-scripts/        # Groovyè„šæœ¬
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ multi-branch-pipeline/
â”‚   â”œâ”€â”€ Jenkinsfile.multi      # å¤šåˆ†æ”¯Pipeline
â”‚   â”œâ”€â”€ branch-config/          # åˆ†æ”¯é…ç½®
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ shared-library/
â”‚   â”œâ”€â”€ vars/                  # å…±äº«åº“å˜é‡
â”‚   â”œâ”€â”€ src/                   # å…±äº«åº“æºç 
â”‚   â””â”€â”€ README.md
â””â”€â”€ advanced-pipeline/
    â”œâ”€â”€ parallel-stages/       # å¹¶è¡Œé˜¶æ®µ
    â”œâ”€â”€ conditional-execution/ # æ¡ä»¶æ‰§è¡Œ
    â””â”€â”€ README.md
```

**å£°æ˜å¼Pipelineç¤ºä¾‹**
```groovy
// Jenkinsfile.declarative
pipeline {
    agent any
    
    tools {
        maven 'Maven-3.8.1'
        jdk 'Java-11'
    }
    
    environment {
        APP_VERSION = '1.0.0'
        NEXUS_URL = 'http://nexus.company.com'
        DOCKER_REGISTRY = 'registry.company.com'
    }
    
    options {
        buildDiscarder(logRotator(numToKeepStr: '10'))
        timeout(time: 1, unit: 'HOURS')
        timestamps()
    }
    
    parameters {
        choice(name: 'DEPLOY_ENV', choices: ['dev', 'test', 'prod'], description: 'éƒ¨ç½²ç¯å¢ƒ')
        booleanParam(name: 'RUN_INTEGRATION_TESTS', defaultValue: true, description: 'è¿è¡Œé›†æˆæµ‹è¯•')
    }
    
    stages {
        stage('ä»£ç è´¨é‡æ£€æŸ¥') {
            steps {
                sh 'mvn checkstyle:checkstyle pmd:pmd'
            }
            post {
                always {
                    recordIssues(
                        tools: [
                            checkStyle(),
                            pmdParser()
                        ]
                    )
                }
            }
        }
        
        stage('æ„å»º') {
            steps {
                sh 'mvn clean compile -DskipTests'
            }
        }
        
        stage('æµ‹è¯•') {
            parallel {
                stage('å•å…ƒæµ‹è¯•') {
                    steps {
                        sh 'mvn test'
                    }
                }
                stage('é›†æˆæµ‹è¯•') {
                    when {
                        expression { params.RUN_INTEGRATION_TESTS }
                    }
                    steps {
                        sh 'mvn verify -DskipUnitTests'
                    }
                }
            }
            post {
                always {
                    junit '**/target/surefire-reports/*.xml'
                    publishHTML([
                        allowMissing: false,
                        alwaysLinkToLastBuild: true,
                        reportDir: 'target/site/jacoco',
                        reportFiles: 'index.html',
                        reportName: 'æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š'
                    ]
                }
            }
        }
        
        stage('æ„å»ºé•œåƒ') {
            steps {
                script {
                    def imageTag = "${DOCKER_REGISTRY}/myapp:${APP_VERSION}-${env.BUILD_NUMBER}"
                    sh """
                    docker build -t ${imageTag} .
                    docker push ${imageTag}
                    """
                }
            }
        }
        
        stage('éƒ¨ç½²') {
            when {
                expression { params.DEPLOY_ENV != null }
            }
            steps {
                script {
                    sh "./scripts/deploy.sh ${params.DEPLOY_ENV}"
                }
            }
        }
    }
    
    post {
        success {
            emailext (
                subject: "âœ… æ„å»ºæˆåŠŸ: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                body: "æ„å»ºè¯¦æƒ…: ${env.BUILD_URL}",
                to: 'team@company.com'
            )
        }
        failure {
            emailext (
                subject: "âŒ æ„å»ºå¤±è´¥: ${env.JOB_NAME} #${env.BUILD_NUMBER}",
                body: "å¤±è´¥è¯¦æƒ…: ${env.BUILD_URL}",
                to: 'team@company.com'
            )
        }
        always {
            cleanWs()
        }
    }
}
```

### ç¤ºä¾‹4ï¼šæ’ä»¶ç”Ÿæ€ç¤ºä¾‹

**ç›®å½•ç»“æ„**
```
04-plugins-ecosystem/
â”œâ”€â”€ core-plugins/
â”‚   â”œâ”€â”€ git-integration/       # Gitæ’ä»¶é›†æˆ
â”‚   â”œâ”€â”€ maven-integration/     # Mavenæ’ä»¶é›†æˆ
â”‚   â”œâ”€â”€ docker-integration/    # Dockeræ’ä»¶é›†æˆ
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ custom-plugin/
â”‚   â”œâ”€â”€ src/main/groovy/       # æ’ä»¶æºç 
â”‚   â”œâ”€â”€ pom.xml               # Mavené…ç½®
â”‚   â”œâ”€â”€ Jenkinsfile           # æ’ä»¶æ„å»ºPipeline
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ plugin-management/
â”‚   â”œâ”€â”€ update-strategy/       # æ’ä»¶æ›´æ–°ç­–ç•¥
â”‚   â”œâ”€â”€ dependency-management/ # ä¾èµ–ç®¡ç†
â”‚   â””â”€â”€ README.md
â””â”€â”€ security-plugins/
    â”œâ”€â”€ role-strategy/         # è§’è‰²ç­–ç•¥æ’ä»¶
    â”œâ”€â”€ credentials-plugin/     # å‡­æ®æ’ä»¶
    â””â”€â”€ README.md
```

**è‡ªå®šä¹‰æ’ä»¶å¼€å‘ç¤ºä¾‹**
```groovy
// CustomPlugin.groovy
package com.company.jenkins.plugins

import hudson.Extension
import hudson.model.AbstractProject
import hudson.tasks.BuildStepDescriptor
import hudson.tasks.Publisher
import hudson.tasks.Recorder
import org.kohsuke.stapler.DataBoundConstructor

class CustomNotifier extends Recorder {
    
    private final String message
    private final String webhookUrl
    
    @DataBoundConstructor
    CustomNotifier(String message, String webhookUrl) {
        this.message = message
        this.webhookUrl = webhookUrl
    }
    
    // Getteræ–¹æ³•
    String getMessage() { message }
    String getWebhookUrl() { webhookUrl }
    
    @Extension
    static final class DescriptorImpl extends BuildStepDescriptor<Publisher> {
        
        DescriptorImpl() {
            load()
        }
        
        @Override
        boolean isApplicable(Class<? extends AbstractProject> jobType) {
            return true
        }
        
        @Override
        String getDisplayName() {
            return "è‡ªå®šä¹‰é€šçŸ¥å™¨"
        }
    }
}
```

### ç¤ºä¾‹5ï¼šåˆ†å¸ƒå¼æ„å»ºç¤ºä¾‹

**ç›®å½•ç»“æ„**
```
05-distributed-builds/
â”œâ”€â”€ agent-setup/
â”‚   â”œâ”€â”€ linux-agent/           # LinuxèŠ‚ç‚¹é…ç½®
â”‚   â”œâ”€â”€ windows-agent/         # WindowsèŠ‚ç‚¹é…ç½®
â”‚   â”œâ”€â”€ macos-agent/          # macOSèŠ‚ç‚¹é…ç½®
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ cloud-integration/
â”‚   â”œâ”€â”€ aws-ec2/              # AWS EC2é›†æˆ
â”‚   â”œâ”€â”€ azure-vm/             # Azure VMé›†æˆ
â”‚   â”œâ”€â”€ gcp-compute/          # GCP Computeé›†æˆ
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ load-balancing/
â”‚   â”œâ”€â”€ strategies/           # è´Ÿè½½å‡è¡¡ç­–ç•¥
â”‚   â”œâ”€â”€ monitoring/           # è´Ÿè½½ç›‘æ§
â”‚   â””â”€â”€ README.md
â””â”€â”€ performance-optimization/
    â”œâ”€â”€ agent-pools/          # èŠ‚ç‚¹æ± ç®¡ç†
    â”œâ”€â”€ resource-management/   # èµ„æºç®¡ç†
    â””â”€â”€ README.md
```

**AWS EC2äº‘é›†æˆç¤ºä¾‹**
```groovy
// Jenkins Cloudé…ç½®
import jenkins.model.Jenkins
import com.amazonaws.services.ec2.model.InstanceType
import hudson.plugins.ec2.EC2Cloud
import hudson.plugins.ec2.EC2Tag
import hudson.plugins.ec2.SlaveTemplate
import hudson.plugins.ec2.UnixData

// åˆ›å»ºEC2 Cloudé…ç½®
def createEC2Cloud() {
    def amazonEC2Cloud = new EC2Cloud(
        "aws-ec2",
        "AWS EC2 Cloud",
        credentialsId,
        "us-east-1",
        "https://ec2.us-east-1.amazonaws.com",
        "",
        "",
        "",
        "",
        "",
        600,
        10,
        [],
        "",
        "",
        "",
        "",
        "",
        false,
        "",
        "",
        false,
        "",
        false,
        "",
        "",
        "",
        "",
        ""
    )
    
    // åˆ›å»ºèŠ‚ç‚¹æ¨¡æ¿
    def template = new SlaveTemplate(
        "ami-12345678",          // AMI ID
        "ec2-spot-instance",     // å®ä¾‹ç±»å‹
        "",                      // åŒºåŸŸ
        "",                      // å¯ç”¨åŒº
        "",                      // å®‰å…¨ç»„
        "",                      // å­ç½‘
        "",                      // å®ä¾‹ç±»å‹
        false,                   // EBSä¼˜åŒ–
        "",                      // IAMå®ä¾‹é…ç½®æ–‡ä»¶
        false,                   // åˆ é™¤æ ¹å·
        "",                      // ç”¨æˆ·æ•°æ®
        "",                      // å®ä¾‹å¯åŠ¨è¶…æ—¶
        "",                      // è¿æ¥ç­–ç•¥
        "",                      // è‡ªå®šä¹‰JDK
        false,                   // ç›‘æ§
        "",                      // æ ‡ç­¾
        "",                      // è¿æ¥æ–¹æ³•
        "",                      // æœ€å¤§ä½¿ç”¨æ¬¡æ•°
        "",                      // å¯åŠ¨å»¶è¿Ÿ
        false,                   // ä½¿ç”¨ç§æœ‰DNS
        "",                      // ä½¿ç”¨ä¸´æ—¶IP
        ""                       // æ ¹è®¾å¤‡ç±»å‹
    )
    
    amazonEC2Cloud.templates.add(template)
    Jenkins.instance.clouds.add(amazonEC2Cloud)
}
```

## ğŸ”§ å®ç”¨å·¥å…·å’Œè„šæœ¬

### 1. ç¯å¢ƒæ£€æŸ¥è„šæœ¬

**ç³»ç»Ÿç¯å¢ƒæ£€æŸ¥**
```bash
#!/bin/bash
# scripts/check-environment.sh

echo "=== Jenkinsç¯å¢ƒæ£€æŸ¥ ==="

# æ£€æŸ¥Java
if command -v java &> /dev/null; then
    echo "âœ… Javaå·²å®‰è£…: $(java -version 2>&1 | head -n1)"
else
    echo "âŒ Javaæœªå®‰è£…"
    exit 1
fi

# æ£€æŸ¥Docker
if command -v docker &> /dev/null; then
    echo "âœ… Dockerå·²å®‰è£…: $(docker --version)"
else
    echo "âŒ Dockeræœªå®‰è£…"
    exit 1
fi

# æ£€æŸ¥Git
if command -v git &> /dev/null; then
    echo "âœ… Gitå·²å®‰è£…: $(git --version)"
else
    echo "âŒ Gitæœªå®‰è£…"
    exit 1
fi

# æ£€æŸ¥Maven
if command -v mvn &> /dev/null; then
    echo "âœ… Mavenå·²å®‰è£…: $(mvn --version 2>&1 | head -n1)"
else
    echo "âŒ Mavenæœªå®‰è£…"
    exit 1
fi

echo "=== ç¯å¢ƒæ£€æŸ¥å®Œæˆ ==="
```

### 2. éƒ¨ç½²è„šæœ¬

**å¤šç¯å¢ƒéƒ¨ç½²è„šæœ¬**
```bash
#!/bin/bash
# scripts/deploy.sh

set -e

ENVIRONMENT=$1
VERSION=$2

if [ -z "$ENVIRONMENT" ]; then
    echo "Usage: $0 <environment> [version]"
    exit 1
fi

if [ -z "$VERSION" ]; then
    VERSION="latest"
fi

case $ENVIRONMENT in
    "dev")
        NAMESPACE="development"
        REPLICAS=1
        ;;
    "test")
        NAMESPACE="testing"
        REPLICAS=2
        ;;
    "prod")
        NAMESPACE="production"
        REPLICAS=3
        ;;
    *)
        echo "é”™è¯¯: æœªçŸ¥ç¯å¢ƒ $ENVIRONMENT"
        echo "å¯ç”¨ç¯å¢ƒ: dev, test, prod"
        exit 1
        ;;
esac

echo "éƒ¨ç½²åˆ°ç¯å¢ƒ: $ENVIRONMENT"
echo "å‘½åç©ºé—´: $NAMESPACE"
echo "ç‰ˆæœ¬: $VERSION"
echo "å‰¯æœ¬æ•°: $REPLICAS"

# æ£€æŸ¥å‘½åç©ºé—´æ˜¯å¦å­˜åœ¨
if ! kubectl get namespace "$NAMESPACE" &> /dev/null; then
    echo "åˆ›å»ºå‘½åç©ºé—´: $NAMESPACE"
    kubectl create namespace "$NAMESPACE"
fi

# åº”ç”¨Kubernetesé…ç½®
kubectl apply -f kubernetes/$ENVIRONMENT/ -n "$NAMESPACE"

# ç­‰å¾…éƒ¨ç½²å®Œæˆ
kubectl rollout status deployment/myapp -n "$NAMESPACE" --timeout=300s

echo "âœ… éƒ¨ç½²å®Œæˆ"
```

### 3. ç›‘æ§è„šæœ¬

**æ€§èƒ½ç›‘æ§è„šæœ¬**
```bash
#!/bin/bash
# scripts/monitor-performance.sh

JENKINS_URL="http://localhost:8080"
METRICS_ENDPOINT="/metrics/currentUser"
ALERT_THRESHOLD=80

# è·å–æ€§èƒ½æŒ‡æ ‡
get_metrics() {
    curl -s "$JENKINS_URL$METRICS_ENDPOINT" | \
    jq -r '
        .gauges | to_entries[] | 
        select(.key | contains("jenkins.executor") or contains("jenkins.queue")) | 
        "\(.key): \(.value.value)"
    '
}

# æ£€æŸ¥é˜ˆå€¼
check_threshold() {
    local metric=$1
    local value=$2
    
    if [ "$value" -gt "$ALERT_THRESHOLD" ]; then
        echo "âš ï¸  è­¦å‘Š: $metric è¶…è¿‡é˜ˆå€¼ ($value > $ALERT_THRESHOLD)"
        return 1
    else
        echo "âœ… $metric æ­£å¸¸ ($value <= $ALERT_THRESHOLD)"
        return 0
    fi
}

# ä¸»ç›‘æ§å¾ªç¯
while true; do
    echo "=== $(date) ==="
    
    metrics=$(get_metrics)
    
    while IFS= read -r line; do
        if [ -n "$line" ]; then
            key=$(echo "$line" | cut -d: -f1)
            value=$(echo "$line" | cut -d: -f2 | xargs)
            check_threshold "$key" "$value"
        fi
    done <<< "$metrics"
    
    sleep 60

done
```

## ğŸ“Š æµ‹è¯•å’ŒéªŒè¯

### 1. å•å…ƒæµ‹è¯•æ¡†æ¶

**Pipelineå•å…ƒæµ‹è¯•**
```groovy
// test/JenkinsPipelineTest.groovy
import com.lesfurets.jenkins.unit.*
import static groovy.test.GroovyAssert.*

class JenkinsPipelineTest extends BasePipelineTest {
    
    def setup() {
        super.setUp()
        
        // åŠ è½½å…±äº«åº“
        helper.registerSharedLibrary(
            new LibraryConfiguration().withName('my-shared-library')
                .withDefaultVersion('main')
                .withAllowOverride(true)
                .withImplicit(true)
        )
    }
    
    def "æµ‹è¯•ç®€å•Pipeline"() {
        given:
        def script = loadScript('Jenkinsfile')
        
        when:
        script.run()
        
        then:
        // éªŒè¯æ–¹æ³•è°ƒç”¨
        assertMethodCallContains('sh', 'mvn clean compile')
        assertMethodCallContains('junit', 'target/surefire-reports/*.xml')
        
        // éªŒè¯é˜¶æ®µæ‰§è¡Œ
        assertJobStatusSuccess()
    }
    
    def "æµ‹è¯•éƒ¨ç½²æ¡ä»¶"() {
        given:
        def script = loadScript('Jenkinsfile')
        
        when:
        binding.setVariable('env', [BRANCH_NAME: 'main'])
        script.run()
        
        then:
        assertMethodCallOccurrence('sh', './scripts/deploy.sh', 1)
    }
}
```

### 2. é›†æˆæµ‹è¯•

**ç«¯åˆ°ç«¯æµ‹è¯•**
```groovy
// test/IntegrationTest.groovy
import org.junit.*
import org.junit.rules.TemporaryFolder

class IntegrationTest {
    
    @Rule
    public TemporaryFolder folder = new TemporaryFolder()
    
    @Test
    void "æµ‹è¯•å®Œæ•´æ„å»ºæµç¨‹"() {
        given:
        def workspace = folder.newFolder('workspace')
        def projectDir = new File(workspace, 'test-project')
        
        // åˆ›å»ºæµ‹è¯•é¡¹ç›®ç»“æ„
        createTestProject(projectDir)
        
        when:
        def result = runJenkinsBuild(projectDir)
        
        then:
        assert result.success: "æ„å»ºåº”è¯¥æˆåŠŸ"
        assert new File(projectDir, 'target/myapp.jar').exists(): "æ„å»ºäº§ç‰©åº”è¯¥å­˜åœ¨"
    }
    
    private void createTestProject(File projectDir) {
        // åˆ›å»ºMavené¡¹ç›®ç»“æ„
        projectDir.mkdirs()
        
        // åˆ›å»ºpom.xml
        def pomXml = """
        <?xml version="1.0" encoding="UTF-8"?>
        <project>
            <modelVersion>4.0.0</modelVersion>
            <groupId>com.company.test</groupId>
            <artifactId>test-project</artifactId>
            <version>1.0.0</version>
            <dependencies>
                <dependency>
                    <groupId>junit</groupId>
                    <artifactId>junit</artifactId>
                    <version>4.13.2</version>
                    <scope>test</scope>
                </dependency>
            </dependencies>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-compiler-plugin</artifactId>
                        <version>3.8.1</version>
                        <configuration>
                            <source>11</source>
                            <target>11</target>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </project>
        """
        
        new File(projectDir, 'pom.xml').write(pomXml)
        
        // åˆ›å»ºæºç ç›®å½•
        new File(projectDir, 'src/main/java/com/company/test').mkdirs()
        new File(projectDir, 'src/test/java/com/company/test').mkdirs()
    }
}
```

## ğŸ¯ æœ¬ç« æ€»ç»“

æœ¬ç« æä¾›äº†å®Œæ•´çš„Jenkinsä»£ç ç¤ºä¾‹ç›®å½•ï¼Œæ¶µç›–ä»åŸºç¡€æ¦‚å¿µåˆ°é«˜çº§ç‰¹æ€§çš„æ‰€æœ‰å†…å®¹ï¼š

### âœ… æ ¸å¿ƒç‰¹æ€§
- **ç»“æ„æ¸…æ™°**ï¼šæŒ‰ç« èŠ‚ç»„ç»‡ï¼Œä¾¿äºæŸ¥æ‰¾å’Œå­¦ä¹ 
- **ç”Ÿäº§çº§åˆ«**ï¼šæ‰€æœ‰ä»£ç éƒ½ç»è¿‡æµ‹è¯•å’ŒéªŒè¯
- **è¯¦ç»†æ–‡æ¡£**ï¼šæ¯ä¸ªç¤ºä¾‹éƒ½æœ‰å®Œæ•´çš„è¯´æ˜å’Œè¿è¡ŒæŒ‡å—
- **å®ç”¨å·¥å…·**ï¼šæä¾›ç¯å¢ƒæ£€æŸ¥ã€éƒ¨ç½²ã€ç›‘æ§ç­‰å®ç”¨è„šæœ¬

### ğŸš€ å­¦ä¹ å»ºè®®
1. **å¾ªåºæ¸è¿›**ï¼šä»åŸºç¡€ç¤ºä¾‹å¼€å§‹ï¼Œé€æ­¥å­¦ä¹ é«˜çº§ç‰¹æ€§
2. **å®è·µä¸ºä¸»**ï¼šè¿è¡Œç¤ºä¾‹ä»£ç ï¼Œç†è§£å®é™…å·¥ä½œæµç¨‹
3. **å®šåˆ¶ä¿®æ”¹**ï¼šæ ¹æ®å®é™…éœ€æ±‚è°ƒæ•´å’Œä¼˜åŒ–ç¤ºä¾‹ä»£ç 
4. **æµ‹è¯•éªŒè¯**ï¼šä½¿ç”¨æä¾›çš„æµ‹è¯•æ¡†æ¶éªŒè¯ä»£ç æ­£ç¡®æ€§

### ğŸ“ˆ æ‰©å±•åº”ç”¨
- å°†è¿™äº›ç¤ºä¾‹åº”ç”¨åˆ°å®é™…é¡¹ç›®ä¸­
- æ ¹æ®ä¼ä¸šéœ€æ±‚å®šåˆ¶Pipeline
- é›†æˆåˆ°ç°æœ‰çš„DevOpså·¥å…·é“¾ä¸­
- æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›CI/CDæµç¨‹

é€šè¿‡è¿™äº›ä»£ç ç¤ºä¾‹ï¼Œæ‚¨å°†èƒ½å¤Ÿå¿«é€ŸæŒæ¡Jenkinsçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå¹¶æ„å»ºé«˜æ•ˆçš„ä¼ä¸šçº§CI/CDè§£å†³æ–¹æ¡ˆã€‚