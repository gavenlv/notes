# ç¬¬9ç« ï¼šæ•°æ®å¤„ç†(NumPy/Pandas)

> **å­¦ä¹ æ—¶é•¿**: 8-10å°æ—¶  
> **éš¾åº¦**: â­â­â­â­  
> **å‰ç½®çŸ¥è¯†**: ç¬¬1-8ç« 

## æœ¬ç« ç›®æ ‡

å­¦å®Œæœ¬ç« å,ä½ å°†èƒ½å¤Ÿ:

- âœ… ä½¿ç”¨NumPyè¿›è¡Œæ•°ç»„è®¡ç®—
- âœ… æŒæ¡Pandasæ•°æ®ç»“æ„(Series/DataFrame)
- âœ… è¿›è¡Œæ•°æ®æ¸…æ´—ä¸è½¬æ¢
- âœ… æ•°æ®åˆ†ç»„èšåˆåˆ†æ
- âœ… è¯»å†™å„ç§æ•°æ®æ ¼å¼
- âœ… å¤„ç†æ—¶é—´åºåˆ—æ•°æ®

---

## 9.1 NumPyåŸºç¡€

### 9.1.1 å®‰è£…ä¸å¯¼å…¥

```bash
pip install numpy
```

```python
import numpy as np

print(np.__version__)  # æŸ¥çœ‹ç‰ˆæœ¬
```

### 9.1.2 åˆ›å»ºæ•°ç»„

```python
import numpy as np

# ä»åˆ—è¡¨åˆ›å»º
arr = np.array([1, 2, 3, 4, 5])
print(arr)  # [1 2 3 4 5]
print(type(arr))  # <class 'numpy.ndarray'>

# äºŒç»´æ•°ç»„
arr2d = np.array([[1, 2, 3], [4, 5, 6]])
print(arr2d)

# å…¨0æ•°ç»„
zeros = np.zeros((3, 4))
print(zeros)

# å…¨1æ•°ç»„
ones = np.ones((2, 3))
print(ones)

# å•ä½çŸ©é˜µ
eye = np.eye(3)
print(eye)

# ç­‰å·®æ•°åˆ—
arr = np.arange(0, 10, 2)  # [0 2 4 6 8]
print(arr)

# çº¿æ€§ç©ºé—´
arr = np.linspace(0, 1, 5)  # [0.   0.25 0.5  0.75 1.  ]
print(arr)

# éšæœºæ•°ç»„
rand_arr = np.random.rand(3, 3)  # 0-1ä¹‹é—´å‡åŒ€åˆ†å¸ƒ
randint_arr = np.random.randint(0, 10, (3, 3))  # éšæœºæ•´æ•°
```

### 9.1.3 æ•°ç»„å±æ€§

```python
arr = np.array([[1, 2, 3], [4, 5, 6]])

print(arr.shape)    # (2, 3) å½¢çŠ¶
print(arr.ndim)     # 2 ç»´åº¦
print(arr.size)     # 6 å…ƒç´ æ€»æ•°
print(arr.dtype)    # int64 æ•°æ®ç±»å‹

# æ”¹å˜å½¢çŠ¶
reshaped = arr.reshape(3, 2)
print(reshaped)

# å±•å¹³
flattened = arr.flatten()
print(flattened)  # [1 2 3 4 5 6]
```

### 9.1.4 æ•°ç»„è¿ç®—

```python
import numpy as np

a = np.array([1, 2, 3, 4])
b = np.array([5, 6, 7, 8])

# å…ƒç´ çº§è¿ç®—
print(a + b)   # [ 6  8 10 12]
print(a - b)   # [-4 -4 -4 -4]
print(a * b)   # [ 5 12 21 32]
print(a / b)   # [0.2 0.33 0.43 0.5]
print(a ** 2)  # [ 1  4  9 16]

# ç»Ÿè®¡å‡½æ•°
arr = np.array([1, 2, 3, 4, 5])
print(np.sum(arr))    # 15
print(np.mean(arr))   # 3.0
print(np.std(arr))    # 1.414
print(np.max(arr))    # 5
print(np.min(arr))    # 1
print(np.median(arr)) # 3.0

# çŸ©é˜µè¿ç®—
A = np.array([[1, 2], [3, 4]])
B = np.array([[5, 6], [7, 8]])

print(np.dot(A, B))   # çŸ©é˜µä¹˜æ³•
print(A @ B)          # ä¹Ÿæ˜¯çŸ©é˜µä¹˜æ³•
print(A.T)            # è½¬ç½®
```

### 9.1.5 ç´¢å¼•ä¸åˆ‡ç‰‡

```python
arr = np.array([10, 20, 30, 40, 50])

# ç´¢å¼•
print(arr[0])    # 10
print(arr[-1])   # 50

# åˆ‡ç‰‡
print(arr[1:4])  # [20 30 40]
print(arr[::2])  # [10 30 50]

# äºŒç»´æ•°ç»„
arr2d = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
print(arr2d[0, 1])    # 2
print(arr2d[1, :])    # [4 5 6]
print(arr2d[:, 1])    # [2 5 8]

# å¸ƒå°”ç´¢å¼•
arr = np.array([1, 2, 3, 4, 5])
mask = arr > 3
print(arr[mask])  # [4 5]
print(arr[arr % 2 == 0])  # [2 4]
```

---

## 9.2 PandasåŸºç¡€

### 9.2.1 å®‰è£…ä¸å¯¼å…¥

```bash
pip install pandas
```

```python
import pandas as pd

print(pd.__version__)
```

### 9.2.2 Series

```python
import pandas as pd

# ä»åˆ—è¡¨åˆ›å»º
s = pd.Series([1, 2, 3, 4, 5])
print(s)

# æŒ‡å®šç´¢å¼•
s = pd.Series([10, 20, 30], index=['a', 'b', 'c'])
print(s)

# ä»å­—å…¸åˆ›å»º
data = {'a': 10, 'b': 20, 'c': 30}
s = pd.Series(data)
print(s)

# è®¿é—®å…ƒç´ 
print(s['a'])   # 10
print(s.iloc[0])  # 10 (ä½ç½®ç´¢å¼•)

# Seriesè¿ç®—
s1 = pd.Series([1, 2, 3])
s2 = pd.Series([4, 5, 6])
print(s1 + s2)
```

### 9.2.3 DataFrame

```python
import pandas as pd

# ä»å­—å…¸åˆ›å»º
data = {
    'name': ['Alice', 'Bob', 'Charlie'],
    'age': [25, 30, 35],
    'city': ['Beijing', 'Shanghai', 'Guangzhou']
}
df = pd.DataFrame(data)
print(df)

# æŸ¥çœ‹æ•°æ®
print(df.head())       # å‰5è¡Œ
print(df.tail(2))      # å2è¡Œ
print(df.info())       # ä¿¡æ¯
print(df.describe())   # ç»Ÿè®¡æè¿°

# è®¿é—®åˆ—
print(df['name'])      # å•åˆ—
print(df[['name', 'age']])  # å¤šåˆ—

# è®¿é—®è¡Œ
print(df.iloc[0])      # ç¬¬ä¸€è¡Œ(ä½ç½®)
print(df.loc[0])       # ç¬¬ä¸€è¡Œ(æ ‡ç­¾)

# è®¿é—®ç‰¹å®šå•å…ƒæ ¼
print(df.loc[0, 'name'])   # Alice
print(df.iloc[0, 0])       # Alice

# æ·»åŠ åˆ—
df['salary'] = [8000, 10000, 12000]
print(df)

# åˆ é™¤åˆ—
df = df.drop('salary', axis=1)
print(df)
```

### 9.2.4 æ•°æ®è¯»å†™

```python
import pandas as pd

# CSV
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6]
})

# å†™å…¥CSV
df.to_csv('data.csv', index=False)

# è¯»å–CSV
df = pd.read_csv('data.csv')
print(df)

# Excel
# df.to_excel('data.xlsx', index=False)
# df = pd.read_excel('data.xlsx')

# JSON
df.to_json('data.json')
df = pd.read_json('data.json')

# SQL (éœ€è¦sqlalchemy)
# from sqlalchemy import create_engine
# engine = create_engine('sqlite:///data.db')
# df.to_sql('table_name', engine)
# df = pd.read_sql('SELECT * FROM table_name', engine)
```

---

## 9.3 æ•°æ®æ¸…æ´—

### 9.3.1 ç¼ºå¤±å€¼å¤„ç†

```python
import pandas as pd
import numpy as np

# åˆ›å»ºå«ç¼ºå¤±å€¼çš„æ•°æ®
df = pd.DataFrame({
    'A': [1, 2, np.nan, 4],
    'B': [5, np.nan, 7, 8],
    'C': [9, 10, 11, 12]
})

# æ£€æŸ¥ç¼ºå¤±å€¼
print(df.isnull())
print(df.isnull().sum())  # æ¯åˆ—ç¼ºå¤±å€¼æ•°é‡

# åˆ é™¤ç¼ºå¤±å€¼
df_dropped = df.dropna()  # åˆ é™¤å«ç¼ºå¤±å€¼çš„è¡Œ
print(df_dropped)

# å¡«å……ç¼ºå¤±å€¼
df_filled = df.fillna(0)  # å¡«å……ä¸º0
print(df_filled)

df_filled = df.fillna(df.mean())  # å¡«å……ä¸ºå‡å€¼
print(df_filled)

# å‰å‘/åå‘å¡«å……
df_ffill = df.fillna(method='ffill')  # å‰å‘å¡«å……
df_bfill = df.fillna(method='bfill')  # åå‘å¡«å……
```

### 9.3.2 æ•°æ®ç±»å‹è½¬æ¢

```python
df = pd.DataFrame({
    'A': ['1', '2', '3'],
    'B': ['4.5', '5.5', '6.5']
})

print(df.dtypes)

# è½¬æ¢ç±»å‹
df['A'] = df['A'].astype(int)
df['B'] = df['B'].astype(float)
print(df.dtypes)

# è½¬æ¢æ—¥æœŸ
df = pd.DataFrame({
    'date': ['2024-01-15', '2024-01-16', '2024-01-17']
})
df['date'] = pd.to_datetime(df['date'])
print(df.dtypes)
```

### 9.3.3 å»é‡

```python
df = pd.DataFrame({
    'A': [1, 1, 2, 2, 3],
    'B': [4, 4, 5, 5, 6]
})

# æ£€æŸ¥é‡å¤
print(df.duplicated())

# åˆ é™¤é‡å¤
df_unique = df.drop_duplicates()
print(df_unique)

# åŸºäºç‰¹å®šåˆ—å»é‡
df_unique = df.drop_duplicates(subset=['A'])
print(df_unique)
```

---

## 9.4 æ•°æ®è½¬æ¢

### 9.4.1 ç­›é€‰

```python
df = pd.DataFrame({
    'name': ['Alice', 'Bob', 'Charlie', 'David'],
    'age': [25, 30, 35, 40],
    'salary': [8000, 10000, 12000, 15000]
})

# å•æ¡ä»¶ç­›é€‰
young = df[df['age'] < 35]
print(young)

# å¤šæ¡ä»¶ç­›é€‰
high_earners = df[(df['age'] > 25) & (df['salary'] > 10000)]
print(high_earners)

# ä½¿ç”¨query()
result = df.query('age > 30 and salary < 15000')
print(result)
```

### 9.4.2 æ’åº

```python
df = pd.DataFrame({
    'A': [3, 1, 2],
    'B': [6, 4, 5]
})

# æŒ‰åˆ—æ’åº
sorted_df = df.sort_values('A')
print(sorted_df)

# é™åº
sorted_df = df.sort_values('A', ascending=False)
print(sorted_df)

# å¤šåˆ—æ’åº
sorted_df = df.sort_values(['A', 'B'])
print(sorted_df)
```

### 9.4.3 åˆ†ç»„èšåˆ

```python
df = pd.DataFrame({
    'dept': ['IT', 'IT', 'HR', 'HR', 'Sales'],
    'name': ['Alice', 'Bob', 'Charlie', 'David', 'Eve'],
    'salary': [8000, 10000, 7000, 9000, 8500]
})

# åˆ†ç»„
grouped = df.groupby('dept')

# èšåˆ
print(grouped['salary'].mean())  # å¹³å‡å·¥èµ„
print(grouped['salary'].sum())   # æ€»å·¥èµ„
print(grouped.size())            # æ¯ç»„äººæ•°

# å¤šä¸ªèšåˆå‡½æ•°
agg_result = grouped['salary'].agg(['mean', 'sum', 'count'])
print(agg_result)

# è‡ªå®šä¹‰èšåˆ
agg_result = grouped['salary'].agg({
    'avg_salary': 'mean',
    'total_salary': 'sum',
    'num_employees': 'count'
})
print(agg_result)
```

---

## 9.5 æ•°æ®åˆå¹¶

### 9.5.1 æ‹¼æ¥

```python
df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'A': [5, 6], 'B': [7, 8]})

# å‚ç›´æ‹¼æ¥
result = pd.concat([df1, df2])
print(result)

# æ°´å¹³æ‹¼æ¥
result = pd.concat([df1, df2], axis=1)
print(result)
```

### 9.5.2 åˆå¹¶

```python
# ç±»ä¼¼SQLçš„JOIN
employees = pd.DataFrame({
    'emp_id': [1, 2, 3],
    'name': ['Alice', 'Bob', 'Charlie'],
    'dept_id': [10, 20, 10]
})

departments = pd.DataFrame({
    'dept_id': [10, 20, 30],
    'dept_name': ['IT', 'HR', 'Sales']
})

# å†…è¿æ¥
result = pd.merge(employees, departments, on='dept_id', how='inner')
print(result)

# å·¦è¿æ¥
result = pd.merge(employees, departments, on='dept_id', how='left')
print(result)

# å¤–è¿æ¥
result = pd.merge(employees, departments, on='dept_id', how='outer')
print(result)
```

---

## 9.6 å®éªŒ:æ•°æ®åˆ†æé¡¹ç›®

```python
"""
é”€å”®æ•°æ®åˆ†æ
åˆ†æç”µå•†é”€å”®æ•°æ®,å¾—å‡ºä¸šåŠ¡æ´å¯Ÿ
"""

import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
np.random.seed(42)

dates = pd.date_range('2024-01-01', periods=100, freq='D')
products = ['iPhone', 'iPad', 'MacBook', 'AirPods', 'Apple Watch']
regions = ['åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³']

data = {
    'date': np.random.choice(dates, 500),
    'product': np.random.choice(products, 500),
    'region': np.random.choice(regions, 500),
    'quantity': np.random.randint(1, 10, 500),
    'price': np.random.randint(1000, 10000, 500)
}

df = pd.DataFrame(data)
df['revenue'] = df['quantity'] * df['price']

print("=== æ•°æ®é¢„è§ˆ ===")
print(df.head())

print("\n=== æ•°æ®ä¿¡æ¯ ===")
print(df.info())

print("\n=== ç»Ÿè®¡æè¿° ===")
print(df.describe())

# æŒ‰äº§å“åˆ†æ
print("\n=== äº§å“é”€å”®é¢æ’å ===")
product_sales = df.groupby('product')['revenue'].sum().sort_values(ascending=False)
print(product_sales)

# æŒ‰åœ°åŒºåˆ†æ
print("\n=== åœ°åŒºé”€å”®é¢æ’å ===")
region_sales = df.groupby('region')['revenue'].sum().sort_values(ascending=False)
print(region_sales)

# æ—¶é—´åºåˆ—åˆ†æ
print("\n=== æ¯æ—¥é”€å”®è¶‹åŠ¿ ===")
daily_sales = df.groupby('date')['revenue'].sum().sort_index()
print(daily_sales.head())

# ç»¼åˆåˆ†æ
print("\n=== äº§å“Ã—åœ°åŒºé”€å”®çŸ©é˜µ ===")
pivot_table = df.pivot_table(
    values='revenue',
    index='product',
    columns='region',
    aggfunc='sum',
    fill_value=0
)
print(pivot_table)

# æœ€ç•…é”€ç»„åˆ
print("\n=== æœ€ç•…é”€äº§å“-åœ°åŒºç»„åˆ ===")
combo_sales = df.groupby(['product', 'region'])['revenue'].sum().sort_values(ascending=False)
print(combo_sales.head())
```

---

## 9.7 è¯¾åç»ƒä¹ 

### ç»ƒä¹ 1: å­¦ç”Ÿæˆç»©åˆ†æ

å¤„ç†å­¦ç”Ÿæˆç»©æ•°æ®:
- è®¡ç®—æ¯ä¸ªå­¦ç”Ÿçš„å¹³å‡åˆ†
- æ‰¾å‡ºå„ç§‘æœ€é«˜åˆ†
- æŒ‰æ€»åˆ†æ’å

### ç»ƒä¹ 2: ç”µå½±è¯„åˆ†åˆ†æ

åˆ†æç”µå½±è¯„åˆ†æ•°æ®é›†:
- æœ€å—æ¬¢è¿çš„ç”µå½±ç±»å‹
- è¯„åˆ†è¶‹åŠ¿
- é«˜åˆ†ç”µå½±ç‰¹å¾

### ç»ƒä¹ 3: è‚¡ç¥¨æ•°æ®åˆ†æ

åˆ†æè‚¡ç¥¨å†å²æ•°æ®:
- è®¡ç®—ç§»åŠ¨å¹³å‡
- æ‰¾å‡ºæœ€å¤§æ¶¨å¹…
- åˆ†ææ³¢åŠ¨æ€§

---

## 9.8 æœ¬ç« å°ç»“

### NumPyæ ¸å¿ƒ

```python
import numpy as np

# åˆ›å»ºæ•°ç»„
arr = np.array([1, 2, 3])
zeros = np.zeros((3, 3))
ones = np.ones((2, 2))

# è¿ç®—
arr + 1
arr * 2
np.mean(arr)
```

### Pandasæ ¸å¿ƒ

```python
import pandas as pd

# Series
s = pd.Series([1, 2, 3])

# DataFrame
df = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})

# è¯»å†™
df.to_csv('data.csv')
df = pd.read_csv('data.csv')

# æ“ä½œ
df.groupby('col').mean()
df[df['col'] > 10]
df.sort_values('col')
```

### ä¸‹ä¸€ç« é¢„å‘Š

**ç¬¬10ç«  - Webå¼€å‘(Flask/Django)**,å°†å­¦ä¹ :
- ğŸŒ Flask Webæ¡†æ¶
- ğŸ”— è·¯ç”±ä¸è§†å›¾
- ğŸ“ æ¨¡æ¿æ¸²æŸ“
- ğŸ’¾ æ•°æ®åº“æ“ä½œ

---

[â† ä¸Šä¸€ç« ](./8-æ ‡å‡†åº“ä¸å¸¸ç”¨æ¨¡å—.md) | [è¿”å›ç›®å½•](./README.md) | [ä¸‹ä¸€ç« : Webå¼€å‘ â†’](./10-Webå¼€å‘.md)
