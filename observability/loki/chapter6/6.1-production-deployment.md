# 6.1 ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

## ğŸ¯ å­¦ä¹ ç›®æ ‡

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š

- è®¾è®¡ç”Ÿäº§çº§Lokiæ¶æ„
- æŒæ¡é«˜å¯ç”¨éƒ¨ç½²ç­–ç•¥
- äº†è§£æ€§èƒ½ä¼˜åŒ–æŠ€å·§
- å­¦ä¹ ç›‘æ§å’Œæ•…éšœæ’é™¤
- æŒæ¡å¤‡ä»½å’Œæ¢å¤ç­–ç•¥

## ğŸ—ï¸ ç”Ÿäº§æ¶æ„è®¾è®¡

### æ¶æ„åŸåˆ™

1. **é«˜å¯ç”¨æ€§**: æ— å•ç‚¹æ•…éšœ
2. **å¯æ‰©å±•æ€§**: æ”¯æŒæ°´å¹³æ‰©å±•
3. **å¯é æ€§**: æ•°æ®å®‰å…¨å’ŒæŒä¹…æ€§
4. **æ€§èƒ½ä¼˜åŒ–**: ä½å»¶è¿Ÿå’Œé«˜åå
5. **å®‰å…¨æ€§**: è®¿é—®æ§åˆ¶å’Œæ•°æ®åŠ å¯†

### å‚è€ƒæ¶æ„

#### å¤§è§„æ¨¡éƒ¨ç½²æ¶æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    è´Ÿè½½å‡è¡¡       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                â”‚         â”‚         â”‚                â”‚
â–¼                â–¼         â–¼         â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gateway  â”‚  â”‚Distributorâ”‚ â”‚Query   â”‚ â”‚Ingester â”‚  â”‚Compactorâ”‚
â”‚          â”‚  â”‚          â”‚ â”‚Frontendâ”‚ â”‚         â”‚  â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚             â”‚           â”‚           â”‚            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚           â”‚           â”‚
                    â–¼           â–¼           â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚          å­˜å‚¨åç«¯              â”‚
            â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”‚
            â”‚ â”‚å¯¹è±¡å­˜å‚¨â”‚ â”‚ç´¢å¼•å­˜å‚¨â”‚ â”‚é…ç½®å­˜å‚¨â”‚ â”‚
            â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Kuberneteséƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Kubernetes                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚Gateway  â”‚  â”‚ Loki    â”‚  â”‚Promtail â”‚  â”‚Grafana  â”‚        â”‚
â”‚  â”‚Deploymentâ”‚  â”‚Stateful â”‚  â”‚DaemonSet â”‚  â”‚Deploymentâ”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚Set      â”‚  â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                        â”‚         â”‚                           â”‚
â”‚                        â–¼         â–¼                           â”‚
â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚               â”‚     PV/PVC            â”‚                        â”‚
â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ é«˜å¯ç”¨éƒ¨ç½²

### ç»„ä»¶å†—ä½™

#### Distributorå†—ä½™

```yaml
# Kubernetes Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: loki-distributor
spec:
  replicas: 3  # è‡³å°‘3ä¸ªå‰¯æœ¬
  selector:
    matchLabels:
      app: loki-distributor
  template:
    metadata:
      labels:
        app: loki-distributor
    spec:
      containers:
      - name: distributor
        image: grafana/loki:2.9.0
        args:
        - -config.file=/etc/loki/local-config.yaml
        - -target=distributor
        ports:
        - containerPort: 3100
        volumeMounts:
        - name: config
          mountPath: /etc/loki
      volumes:
      - name: config
        configMap:
          name: loki-config
```

#### Ingesterå†—ä½™

```yaml
# Kubernetes StatefulSet
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: loki-ingester
spec:
  replicas: 3  # è‡³å°‘3ä¸ªå‰¯æœ¬
  serviceName: loki-ingester
  selector:
    matchLabels:
      app: loki-ingester
  template:
    metadata:
      labels:
        app: loki-ingester
    spec:
      containers:
      - name: ingester
        image: grafana/loki:2.9.0
        args:
        - -config.file=/etc/loki/local-config.yaml
        - -target=ingester
        ports:
        - containerPort: 3100
        volumeMounts:
        - name: config
          mountPath: /etc/loki
        - name: data
          mountPath: /data
      volumes:
      - name: config
        configMap:
          name: loki-config
  volumeClaimTemplates:
  - metadata:
      name: data
    spec:
      accessModes: ["ReadWriteOnce"]
      resources:
        requests:
          storage: 100Gi
```

### å­˜å‚¨é«˜å¯ç”¨

#### å¯¹è±¡å­˜å‚¨é…ç½®

```yaml
# AWS S3
storage_config:
  aws:
    s3: null
    bucketnames: loki-chunks
    endpoint: s3.amazonaws.com
    region: us-east-1
    access_key_id: your_access_key
    secret_access_key: your_secret_key
    s3forcepathstyle: false
    insecure: false
  # å¯ç”¨å¤šåŒºåŸŸå¤åˆ¶
  s3_encryption:
    encryption_key: your_kms_key
```

#### ç´¢å¼•å­˜å‚¨é…ç½®

```yaml
# DynamoDBé…ç½®
storage_config:
  aws:
    dynamodb:
      dynamodb_url: dynamodb://us-east-1
      dynamodb_table: loki-index
      dynamodb_read_capacity: 300
      dynamodb_write_capacity: 300
```

### æœåŠ¡å‘ç°

#### Consulé…ç½®

```yaml
# loki.yaml
memberlist:
  join_members:
    - consul:8500

ring:
  kvstore:
    store: consul
    consul:
      host: consul:8500
      http_client_config:
        tls_config:
          insecure_skip_verify: true
```

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ç¡¬ä»¶ä¼˜åŒ–

#### èµ„æºåˆ†é…å»ºè®®

| ç»„ä»¶ | CPU | å†…å­˜ | ç£ç›˜ | ç½‘ç»œ |
|------|-----|------|------|------|
| Distributor | 2-4 cores | 4-8GB | 50GB SSD | 1Gbps |
| Ingester | 4-8 cores | 16-32GB | 100GB SSD | 1Gbps |
| Querier | 4-8 cores | 16-32GB | 50GB SSD | 1Gbps |
| Compactor | 4-8 cores | 8-16GB | 100GB SSD | 1Gbps |

#### å­˜å‚¨ä¼˜åŒ–

```yaml
# ä½¿ç”¨NVMe SSD
ingester:
  chunk_idle_period: 30m
  max_chunk_age: 1h
  chunk_target_size: 2097152  # 2MB chunks
  max_transfer_retries: 0
```

### è½¯ä»¶ä¼˜åŒ–

#### Ingesterä¼˜åŒ–

```yaml
ingester:
  lifecycler:
    ring:
      kvstore:
        store: consul
      replication_factor: 3
  chunk_idle_period: 30m
  max_chunk_age: 1h
  chunk_target_size: 2097152
  concurrent_flushes: 16
  max_transfer_retries: 0
  sync_period: 30s
  sync_min_backoff: 1s
  sync_max_backoff: 30s
```

#### Querierä¼˜åŒ–

```yaml
querier:
  query_timeout: 10m
  max_concurrent: 50
  engine:
    max_look_back_period: 30d
    max_samples_per_query: 50000000
  query_ingester_within: 3h
  query_store_after: 30m
  index_gateway_client:
    client_config:
      max_idle_conn_duration: 90s
      max_idle_connections: 100
      max_idle_connections_per_host: 10
```

#### Query Frontendä¼˜åŒ–

```yaml
frontend:
  compress_responses: true
  max_outstanding_per_tenant: 4096
  log_queries_longer_than: 10s
  query_stats_enabled: true
  scheduler_address: dns+query-scheduler-discovery:9090
  scheduler_worker_address: dns+frontend:9096
  max_retries: 2
```

### ç¼“å­˜ä¼˜åŒ–

#### Memcachedç¼“å­˜

```yaml
query_range:
  split_queries_by_interval: 15m
  align_queries_with_step: true
  cache_results: true
  results_cache:
    cache:
      memcached_client:
        addresses: "dns+memcached:11211"
        timeout: 500ms
        max_idle_connections: 16
        update_interval: 1m
```

#### Redisç¼“å­˜

```yaml
frontend:
  cache:
    enable_fifocache: true
    fifocache:
      max_size_items: 10000
      ttl: 24h
      validity: 10s
      prefix: "loki:"
      redis:
        endpoint: redis:6379
        password: redis_password
        db: 0
        pool_size: 100
```

## ğŸ“Š ç›‘æ§å’Œå‘Šè­¦

### Prometheusç›‘æ§

#### ç›‘æ§æŒ‡æ ‡

```yaml
# ç›‘æ§é…ç½®
scrape_configs:
  - job_name: loki
    kubernetes_sd_configs:
    - role: pod
      namespaces:
        names:
        - loki
    relabel_configs:
    - source_labels: [__meta_kubernetes_pod_label_name]
      action: keep
      regex: (loki-distributor|loki-ingester|loki-querier)
    - source_labels: [__meta_kubernetes_pod_container_name]
      target_label: component
```

#### å‘Šè­¦è§„åˆ™

```yaml
# loki-alerts.yaml
groups:
  - name: loki.rules
    rules:
      # Ingesterå¥åº·çŠ¶æ€
      - alert: LokiIngesterUnhealthy
        expr: up{job="loki-ingester"} == 0
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: "Loki ingester is unhealthy"
          description: "Loki ingester {{ $labels.instance }} has been unhealthy for more than 5 minutes"

      # ç£ç›˜ç©ºé—´ä¸è¶³
      - alert: LokiDiskSpaceLow
        expr: (node_filesystem_avail_bytes{mountpoint="/data"} / node_filesystem_size_bytes{mountpoint="/data"}) * 100 < 10
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Loki disk space low"
          description: "Loki disk space is below 10% on {{ $labels.instance }}"

      # æŸ¥è¯¢å»¶è¿Ÿé«˜
      - alert: LokiQueryLatencyHigh
        expr: histogram_quantile(0.95, rate(loki_request_duration_seconds_bucket{job="loki-querier"}[5m])) > 5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Loki query latency is high"
          description: "95th percentile query latency is {{ $value }} seconds"

      # é™æµè§¦å‘
      - alert: LokiRateLimited
        expr: rate(loki_ingester_rate_limited_total[5m]) > 0.1
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: "Loki rate limiting active"
          description: "Loki is rate limiting requests at {{ $value }} req/s"
```

### Grafanaä»ªè¡¨ç›˜

#### æ ¸å¿ƒæŒ‡æ ‡ä»ªè¡¨ç›˜

1. **æ‘„å…¥æŒ‡æ ‡**: æ—¥å¿—æ‘„å…¥é€Ÿç‡ã€å»¶è¿Ÿã€é”™è¯¯ç‡
2. **å­˜å‚¨æŒ‡æ ‡**: ç£ç›˜ä½¿ç”¨ã€å—å¤§å°ã€å‹ç¼©ç‡
3. **æŸ¥è¯¢æŒ‡æ ‡**: æŸ¥è¯¢é€Ÿç‡ã€å»¶è¿Ÿã€å¹¶å‘æ•°
4. **èµ„æºæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨

## ğŸ—„ï¸ å¤‡ä»½å’Œæ¢å¤

### å¤‡ä»½ç­–ç•¥

#### å¯¹è±¡å­˜å‚¨å¤‡ä»½

```bash
# S3å¤‡ä»½è„šæœ¬
#!/bin/bash
DATE=$(date +%Y%m%d)
BUCKET="loki-chunks"
BACKUP_BUCKET="loki-backup-$DATE"

# åˆ›å»ºå¤‡ä»½å­˜å‚¨æ¡¶
aws s3api create-bucket --bucket $BACKUP_BUCKET --region us-east-1

# å¯ç”¨ç‰ˆæœ¬æ§åˆ¶
aws s3api put-bucket-versioning --bucket $BACKUP_BUCKET --versioning-configuration Status=Enabled

# å¤åˆ¶æ•°æ®
aws s3 sync s3://$BUCKET/ s3://$BACKUP_BUCKET/ --delete

# è®¾ç½®ç”Ÿå‘½å‘¨æœŸè§„åˆ™ï¼ˆå¤‡ä»½ä¿ç•™30å¤©ï¼‰
aws s3api put-bucket-lifecycle-configuration --bucket $BACKUP_BUCKET --lifecycle-configuration file://backup-lifecycle.json
```

#### ç´¢å¼•å¤‡ä»½

```bash
# DynamoDBå¤‡ä»½
aws dynamodb create-backup --table-name loki-index --backup-name "loki-index-backup-$(date +%Y%m%d)"

# å¯¼å‡ºåˆ°S3
aws dynamodb export-table-to-point-in-time \
  --table-arn arn:aws:dynamodb:us-east-1:account-id:table/loki-index \
  --s3-bucket loki-index-backup \
  --export-format DYNAMODB_JSON \
  --s3-prefix "$(date +%Y%m%d)"
```

### æ¢å¤ç­–ç•¥

#### å¯¹è±¡å­˜å‚¨æ¢å¤

```bash
# ä»å¤‡ä»½æ¢å¤
aws s3 sync s3://loki-backup-20231001/ s3://loki-chunks/ --delete
```

#### ç´¢å¼•æ¢å¤

```bash
# åˆ›å»ºä¸´æ—¶è¡¨
aws dynamodb create-table \
  --table-name loki-index-restore \
  --attribute-definitions \
    AttributeName=hash,AttributeType=S \
    AttributeName=range,AttributeType=S \
  --key-schema \
    AttributeName=hash,KeyType=HASH \
    AttributeName=range,KeyType=RANGE \
  --provisioned-throughput \
    ReadCapacityUnits=300,WriteCapacityUnits=300

# å¯¼å…¥æ•°æ®
aws dynamodb import-from-s3 \
  --table-arn arn:aws:dynamodb:us-east-1:account-id:table/loki-index-restore \
  --s3-bucket loki-index-backup \
  --s3-prefix 20231001 \
  --input-format DYNAMODB_JSON

# åˆ‡æ¢åˆ°æ¢å¤çš„è¡¨
# æ³¨æ„ï¼šè¿™éœ€è¦æ›´æ–°Lokié…ç½®
```

### è‡ªåŠ¨åŒ–å¤‡ä»½

#### Kubernetes CronJob

```yaml
apiVersion: batch/v1
kind: CronJob
metadata:
  name: loki-backup
spec:
  schedule: "0 2 * * *"  # æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: backup
            image: amazon/aws-cli
            command:
            - /bin/bash
            - -c
            - |
              # å¤‡ä»½è„šæœ¬
              DATE=$(date +%Y%m%d)
              aws s3 sync s3://loki-chunks s3://loki-backup-$DATE --delete
              aws dynamodb create-backup --table-name loki-index --backup-name "loki-index-backup-$DATE"
            env:
            - name: AWS_ACCESS_KEY_ID
              valueFrom:
                secretKeyRef:
                  name: aws-credentials
                  key: access-key
            - name: AWS_SECRET_ACCESS_KEY
              valueFrom:
                secretKeyRef:
                  name: aws-credentials
                  key: secret-key
          restartPolicy: OnFailure
```

## ğŸ§ª å®éªŒï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

è®©æˆ‘ä»¬é€šè¿‡å®éªŒéƒ¨ç½²ä¸€ä¸ªç”Ÿäº§çº§çš„Lokié›†ç¾¤ï¼š

1. è®¾è®¡ç”Ÿäº§æ¶æ„
2. éƒ¨ç½²é«˜å¯ç”¨é›†ç¾¤
3. é…ç½®ç›‘æ§å’Œå‘Šè­¦
4. æµ‹è¯•å¤‡ä»½å’Œæ¢å¤

**å®éªŒä»£ç å’Œé…ç½®ï¼š**

è§[code/experiments/production-deployment.yaml](../code/chapter6/production-deployment.yaml)

### å®éªŒæ­¥éª¤

1. **éƒ¨ç½²ç”Ÿäº§é›†ç¾¤**:

```bash
# éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ
kubectl apply -f production-deployment.yaml
```

2. **éªŒè¯é«˜å¯ç”¨**:

```bash
# æ£€æŸ¥ç»„ä»¶çŠ¶æ€
kubectl get pods -n loki

# æµ‹è¯•æ•…éšœè½¬ç§»
kubectl delete pod -n loki loki-ingester-0
```

3. **é…ç½®ç›‘æ§**:

```bash
# éƒ¨ç½²Prometheuså’ŒGrafana
kubectl apply -f monitoring.yaml
```

4. **æµ‹è¯•å¤‡ä»½æ¢å¤**:

```bash
# è§¦å‘å¤‡ä»½
kubectl create job --from=cronjob/loki-backup manual-backup-$(date +%s)

# æ¨¡æ‹Ÿç¾éš¾æ¢å¤
kubectl delete ns loki
# ä»å¤‡ä»½æ¢å¤
```

## ğŸ“ æœ¬ç« å°ç»“

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ï¼š

- ç”Ÿäº§çº§Lokiæ¶æ„è®¾è®¡åŸåˆ™
- é«˜å¯ç”¨éƒ¨ç½²ç­–ç•¥å’Œæ–¹æ³•
- æ€§èƒ½ä¼˜åŒ–æŠ€å·§å’Œé…ç½®
- ç›‘æ§å‘Šè­¦ç³»ç»Ÿå’ŒæŒ‡æ ‡
- å¤‡ä»½æ¢å¤ç­–ç•¥å’Œè‡ªåŠ¨åŒ–

è¿™äº›çŸ¥è¯†å°†å¸®åŠ©æ‚¨æ„å»ºä¸€ä¸ªç¨³å®šã€å¯é ä¸”é«˜æ€§èƒ½çš„Lokiç”Ÿäº§ç³»ç»Ÿï¼Œæ»¡è¶³ä¼ä¸šçº§åº”ç”¨çš„éœ€æ±‚ã€‚

## ğŸ¤” æ€è€ƒé¢˜

1. å¦‚ä½•ç¡®å®šLokié›†ç¾¤çš„è§„æ¨¡ï¼Ÿ
2. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹éœ€è¦è°ƒæ•´replication_factorï¼Ÿ
3. å¦‚ä½•å¹³è¡¡æ€§èƒ½ä¼˜åŒ–å’Œæˆæœ¬æ§åˆ¶ï¼Ÿ

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [Lokiç”Ÿäº§éƒ¨ç½²æŒ‡å—](https://grafana.com/docs/loki/latest/operations/)
- [Lokié«˜å¯ç”¨é…ç½®](https://grafana.com/docs/loki/latest/operations/high-availability/)
- [Lokiæ€§èƒ½è°ƒä¼˜](https://grafana.com/docs/loki/latest/operations/performance/)