# 3.1 æ—¥å¿—æ”¶é›†æ¦‚è¿°

## ğŸ¯ å­¦ä¹ ç›®æ ‡

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š

- ç†è§£Lokiæ—¥å¿—æ”¶é›†çš„åŸºæœ¬åŸç†
- æŒæ¡ä¸åŒæ—¥å¿—æ”¶é›†æ–¹å¼çš„ä¼˜ç¼ºç‚¹
- äº†è§£æ—¥å¿—æ”¶é›†çš„æœ€ä½³å®è·µ
- å­¦ä¹ å¦‚ä½•è®¾è®¡æœ‰æ•ˆçš„æ—¥å¿—æ”¶é›†ç­–ç•¥
- è®¤è¯†å¸¸è§çš„æ—¥å¿—æ”¶é›†é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

## ğŸ” æ—¥å¿—æ”¶é›†åŸç†

### åŸºæœ¬æµç¨‹

Lokiçš„æ—¥å¿—æ”¶é›†éµå¾ªä»¥ä¸‹åŸºæœ¬æµç¨‹ï¼š

```
åº”ç”¨ç¨‹åº/ç³»ç»Ÿ â†’ æ—¥å¿—æ–‡ä»¶/è¾“å‡º â†’ æ—¥å¿—æ”¶é›†ä»£ç† â†’ æ ‡ç­¾æå– â†’ å‘é€åˆ°Loki
```

### æ ¸å¿ƒç»„ä»¶

1. **æ—¥å¿—æº**: åº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿäº§ç”Ÿçš„æ—¥å¿—
2. **æ—¥å¿—æ”¶é›†ä»£ç†**: è´Ÿè´£è¯»å–ã€å¤„ç†å’Œå‘é€æ—¥å¿—
3. **æ ‡ç­¾æå–**: ä»æ—¥å¿—å†…å®¹ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯
4. **ä¼ è¾“åè®®**: å°†æ—¥å¿—ä¼ è¾“åˆ°Lokiçš„åè®®

## ğŸ“Š æ—¥å¿—æ”¶é›†æ–¹å¼å¯¹æ¯”

| æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| Promtail | å®˜æ–¹æ”¯æŒï¼Œä¸Lokié›†æˆåº¦é«˜ | åŠŸèƒ½ç›¸å¯¹ç®€å• | æ ‡å‡†Kubernetesç¯å¢ƒ |
| Fluent Bit | åŠŸèƒ½å¼ºå¤§ï¼Œæ€§èƒ½é«˜ | é…ç½®å¤æ‚ | å¤æ‚æ—¥å¿—å¤„ç†éœ€æ±‚ |
| ç›´æ¥æ¨é€ | å®æ—¶æ€§é«˜ï¼Œæ¶æ„ç®€å• | åº”ç”¨ç¨‹åºè€¦åˆåº¦ | å¾®æœåŠ¡æ¶æ„ |
| Logstash | åŠŸèƒ½ä¸°å¯Œï¼Œç”Ÿæ€æˆç†Ÿ | èµ„æºæ¶ˆè€—å¤§ | ELKè¿ç§»åœºæ™¯ |

## ğŸ—ï¸ æ—¥å¿—æ”¶é›†æ¶æ„

### å•ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   åº”ç”¨ç¨‹åº       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚   æ—¥å¿—æ–‡ä»¶   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Promtail     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Loki       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åˆ†å¸ƒå¼æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åº”ç”¨1   â”‚ åº”ç”¨2   â”‚ åº”ç”¨3   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚           â”‚         â”‚
     â–¼           â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚Promtail1â”‚Promtail2â”‚Promtail3â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜
      â”‚             â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          â–¼
                    â–¼     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     Loki     â”‚
              â”‚ Balancer â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¾¹ç¼˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    è¾¹ç¼˜èŠ‚ç‚¹1     â”‚    â”‚    è¾¹ç¼˜èŠ‚ç‚¹2     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Promtail +  â”‚ â”‚    â”‚ â”‚ Promtail +  â”‚ â”‚
â”‚ â”‚ ç¼“å­˜å±‚      â”‚ â”‚    â”‚ â”‚ ç¼“å­˜å±‚      â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                      â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     Loki        â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ·ï¸ æ—¥å¿—æ ‡ç­¾ç­–ç•¥

### æ ‡ç­¾å±‚æ¬¡è®¾è®¡

#### ä¸‰å±‚æ ‡ç­¾æ¨¡å‹

```
ç¬¬ä¸€å±‚: ç¯å¢ƒæ ‡è¯†
  - environment: production/staging/development
  - region: us-east-1/eu-west-1

ç¬¬äºŒå±‚: æœåŠ¡æ ‡è¯†
  - job: nginx/mysql/api
  - instance: host-1/host-2

ç¬¬ä¸‰å±‚: ä¸šåŠ¡æ ‡è¯†
  - component: auth/payment/user
  - version: v1.0/v2.0
```

#### ç¤ºä¾‹æ ‡ç­¾é›†

```yaml
# WebæœåŠ¡å™¨æ—¥å¿—
{environment="production", region="us-east-1", job="nginx", instance="web-1", component="frontend"}

# æ•°æ®åº“æ—¥å¿—
{environment="production", region="us-east-1", job="mysql", instance="db-1", component="backend"}

# åº”ç”¨ç¨‹åºæ—¥å¿—
{environment="production", region="us-east-1", job="api", instance="app-1", component="auth", version="v2.1"}
```

### æ ‡ç­¾å‘½åè§„èŒƒ

#### å‘½åçº¦å®š

1. **å°å†™å­—æ¯**: ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦
2. **æœ‰æ„ä¹‰**: ä½¿ç”¨æè¿°æ€§åç§°
3. **ä¸€è‡´æ€§**: ä¿æŒå‘½åä¸€è‡´æ€§
4. **ç®€æ´æ€§**: é¿å…è¿‡é•¿åç§°

#### ç¤ºä¾‹

```yaml
# æ¨è
environment: production
region: us-east-1
job: nginx
instance: web-01

# ä¸æ¨è
env: prod
regionName: east1
job_name: nginx_server
instance_id: web-server-01
```

### æ ‡ç­¾åŸºæ•°æ§åˆ¶

#### é«˜åŸºæ•°æ ‡ç­¾é—®é¢˜

é«˜åŸºæ•°æ ‡ç­¾ä¼šæ˜¾è‘—å¢åŠ èµ„æºæ¶ˆè€—ï¼š

```yaml
# é«˜åŸºæ•°ï¼ˆé¿å…ï¼‰
{request_id="a1b2c3d4-e5f6-7890-1234-567890abcdef"}
{user_id="12345"}
{session_id="abcdef-123456-7890"}

# ä½åŸºæ•°ï¼ˆæ¨èï¼‰
{request_id_hash="a1b2"}
{user_authenticated="true"}
{session_active="true"}
```

#### åŸºæ•°æ§åˆ¶ç­–ç•¥

1. **å“ˆå¸Œæˆªæ–­**: å°†é•¿IDæˆªæ–­ä¸ºå“ˆå¸Œå€¼
2. **å¸ƒå°”åŒ–**: å°†æ•°å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼
3. **èŒƒå›´åŒ–**: å°†æ•°å€¼è½¬æ¢ä¸ºèŒƒå›´

```yaml
# ç¤ºä¾‹è½¬æ¢
{user_id="12345"} â†’ {user_authenticated="true"}
{response_time="150ms"} â†’ {response_time_range="100-200ms"}
{memory_usage="75%"} â†’ {memory_status="high"}
```

## ğŸ“ æ—¥å¿—æ ¼å¼æ ‡å‡†åŒ–

### ç»“æ„åŒ–æ—¥å¿—

#### JSONæ ¼å¼

```json
{
  "timestamp": "2023-10-01T10:00:00.000Z",
  "level": "INFO",
  "message": "User login successful",
  "user_id": "12345",
  "ip_address": "192.168.1.100",
  "user_agent": "Mozilla/5.0...",
  "duration": "250ms"
}
```

#### é”®å€¼å¯¹æ ¼å¼

```
timestamp=2023-10-01T10:00:00.000Z level=INFO message="User login successful" user_id=12345 ip_address=192.168.1.100 duration=250ms
```

### åŠç»“æ„åŒ–æ—¥å¿—

#### ç»Ÿä¸€å‰ç¼€æ ¼å¼

```
2023-10-01T10:00:00.000Z [INFO] [api] [user-service] User login successful
```

#### æ­£åˆ™è¡¨è¾¾å¼è§£æ

```yaml
pipeline_stages:
  - regex:
      expression: '(?P<timestamp>\S+) \[(?P<level>\w+)\] \[(?P<service>\w+)\] \[(?P<component>\w+)\] (?P<message>.*)'
  - labels:
      level:
      service:
      component:
  - timestamp:
      format: RFC3339Nano
      source: timestamp
```

## ğŸ”„ æ—¥å¿—æ”¶é›†æœ€ä½³å®è·µ

### 1. æœ‰æ•ˆçš„æ ‡ç­¾è®¾è®¡

#### æ ‡ç­¾é€‰æ‹©åŸåˆ™

1. **æŸ¥è¯¢é¢‘ç¹**: é€‰æ‹©ç»å¸¸ç”¨äºæŸ¥è¯¢çš„å­—æ®µ
2. **åŸºæ•°é€‚ä¸­**: é¿å…é«˜åŸºæ•°æ ‡ç­¾
3. **ç¨³å®šä¸å˜**: é€‰æ‹©ä¸é¢‘ç¹å˜åŒ–çš„å­—æ®µ
4. **ä¸šåŠ¡ç›¸å…³**: é€‰æ‹©å¯¹ä¸šåŠ¡æœ‰æ„ä¹‰çš„å­—æ®µ

#### ç¤ºä¾‹

```yaml
# é€‚åˆä½œä¸ºæ ‡ç­¾
- environment: production/staging
- job: nginx/mysql/api
- service: user-service/order-service
- component: frontend/backend

# ä¸é€‚åˆä½œä¸ºæ ‡ç­¾
- request_id: éšæœºç”Ÿæˆçš„é«˜å”¯ä¸€å€¼
- user_id: æ•°é‡å¤šä¸”å˜åŒ–é¢‘ç¹
- timestamp: æœ‰ä¸“é—¨çš„æ—¶é—´å­—æ®µ
- message: å†…å®¹å¤šå˜ä¸”é•¿åº¦ä¸ç¡®å®š
```

### 2. æ—¥å¿—çº§åˆ«ç®¡ç†

#### æ ‡å‡†æ—¥å¿—çº§åˆ«

1. **TRACE**: æœ€è¯¦ç»†çš„è°ƒè¯•ä¿¡æ¯
2. **DEBUG**: è°ƒè¯•ä¿¡æ¯
3. **INFO**: ä¸€èˆ¬ä¿¡æ¯
4. **WARN**: è­¦å‘Šä¿¡æ¯
5. **ERROR**: é”™è¯¯ä¿¡æ¯
6. **FATAL**: è‡´å‘½é”™è¯¯

#### æ—¥å¿—çº§åˆ«é…ç½®

```yaml
# å¼€å‘ç¯å¢ƒ
level: DEBUG

# æµ‹è¯•ç¯å¢ƒ
level: INFO

# ç”Ÿäº§ç¯å¢ƒ
level: WARN
```

### 3. æ—¥å¿—é‡‡æ ·ç­–ç•¥

#### é«˜é¢‘ç‡æ—¥å¿—é‡‡æ ·

```yaml
# é‡‡æ ·é…ç½®ï¼ˆä»…è®°å½•éƒ¨åˆ†DEBUGæ—¥å¿—ï¼‰
pipeline_stages:
  - sampling:
      drop: true
      drop_ratio: 0.8  # ä¸¢å¼ƒ80%çš„DEBUGæ—¥å¿—
```

#### åŸºäºå†…å®¹çš„é‡‡æ ·

```yaml
# åŸºäºé”™è¯¯ç±»å‹é‡‡æ ·
pipeline_stages:
  - match:
      selector: '{level="DEBUG"}'
      pipeline_stages:
        - sampling:
            drop: true
            drop_ratio: 0.9
  - match:
      selector: '{level="ERROR"}'
      pipeline_stages:
        - sampling:
            drop: false  # ä¿ç•™æ‰€æœ‰ERRORæ—¥å¿—
```

### 4. æ—¥å¿—èšåˆå’Œæ‰¹å¤„ç†

#### æ‰¹å¤„ç†é…ç½®

```yaml
clients:
  - url: http://localhost:3100/loki/api/v1/push
    batchwait: 1s           # ç­‰å¾…æ—¶é—´
    batchsize: 100 * 1024    # æ‰¹å¤§å°(100KB)
    timeout: 10s
    backoff_config:
      minbackoff: 100ms
      maxbackoff: 5s
```

#### èšåˆç­–ç•¥

1. **æ—¶é—´èšåˆ**: æŒ‰æ—¶é—´çª—å£èšåˆ
2. **å¤§å°èšåˆ**: æŒ‰æ¶ˆæ¯å¤§å°èšåˆ
3. **æ ‡ç­¾èšåˆ**: æŒ‰æ ‡ç­¾é›†èšåˆ

## ğŸš¨ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. æ—¥å¿—ä¸¢å¤±

#### åŸå› åˆ†æ

1. **ç½‘ç»œä¸­æ–­**: ç½‘ç»œè¿æ¥ä¸ç¨³å®š
2. **å­˜å‚¨é™åˆ¶**: æœ¬åœ°å­˜å‚¨ç©ºé—´ä¸è¶³
3. **é…ç½®é”™è¯¯**: é”™è¯¯çš„æ ‡ç­¾æˆ–è¿‡æ»¤è§„åˆ™
4. **èµ„æºé™åˆ¶**: CPUæˆ–å†…å­˜ä¸è¶³

#### è§£å†³æ–¹æ¡ˆ

```yaml
# å¯ç”¨æœ¬åœ°ç¼“å†²
positions:
  filename: /tmp/positions.yaml

# é…ç½®é‡è¯•ç­–ç•¥
clients:
  - url: http://localhost:3100/loki/api/v1/push
    backoff_config:
      minbackoff: 100ms
      maxbackoff: 5s
      maxretries: 10
```

### 2. é«˜åŸºæ•°æ ‡ç­¾é—®é¢˜

#### è¯†åˆ«é«˜åŸºæ•°æ ‡ç­¾

```bash
# æŸ¥è¯¢æ ‡ç­¾åŸºæ•°
curl -G -s "http://localhost:3100/loki/api/v1/label/label_name/values"
```

#### è§£å†³æ–¹æ¡ˆ

1. **å“ˆå¸Œæˆªæ–­**: å°†é•¿IDæˆªæ–­
2. **å¸ƒå°”åŒ–**: è½¬æ¢ä¸ºå¸ƒå°”å€¼
3. **èŒƒå›´åŒ–**: è½¬æ¢ä¸ºèŒƒå›´
4. **ç§»é™¤æ ‡ç­¾**: è½¬ç§»åˆ°æ—¥å¿—å†…å®¹

### 3. æ€§èƒ½é—®é¢˜

#### è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ

1. **CPUä½¿ç”¨ç‡é«˜**: æ­£åˆ™è¡¨è¾¾å¼è¿‡äºå¤æ‚
2. **å†…å­˜ä½¿ç”¨é«˜**: å—å¤§å°è¿‡å¤§
3. **ç½‘ç»œä½¿ç”¨é«˜**: å‘é€é¢‘ç‡è¿‡é«˜

#### ä¼˜åŒ–ç­–ç•¥

```yaml
# ç®€åŒ–æ­£åˆ™è¡¨è¾¾å¼
pipeline_stages:
  - regex:
      expression: '(?P<timestamp>\S+) \[(?P<level>\w+)\] (?P<message>.*)'

# è°ƒæ•´æ‰¹å¤„ç†
clients:
  - url: http://localhost:3100/loki/api/v1/push
    batchwait: 5s          # å¢åŠ ç­‰å¾…æ—¶é—´
    batchsize: 1024 * 1024  # å¢å¤§æ‰¹å¤§å°
```

## ğŸ§ª å®éªŒï¼šæ—¥å¿—æ”¶é›†ä¼˜åŒ–

è®©æˆ‘ä»¬é€šè¿‡å®éªŒä¼˜åŒ–æ—¥å¿—æ”¶é›†æ€§èƒ½ï¼š

1. åˆ›å»ºä¸åŒæ ¼å¼çš„æ—¥å¿—
2. é…ç½®ä¸åŒçš„æ ‡ç­¾ç­–ç•¥
3. æµ‹è¯•æ€§èƒ½å·®å¼‚
4. ä¼˜åŒ–é…ç½®

**å®éªŒä»£ç å’Œé…ç½®ï¼š**

è§[code/experiments/log-collection-optimization.sh](../code/chapter3/log-collection-optimization.sh)

### å®éªŒæ­¥éª¤

1. **ç”Ÿæˆæµ‹è¯•æ—¥å¿—**:

```bash
# ç”Ÿæˆé«˜åŸºæ•°æ—¥å¿—
for i in {1..10000}; do
  echo "2023-10-01T10:00:00.000Z [INFO] Request processed with ID $(uuidgen)" >> high-cardinality.log
done

# ç”Ÿæˆä½åŸºæ•°æ—¥å¿—
for i in {1..10000}; do
  echo "2023-10-01T10:00:00.000Z [INFO] Request processed" >> low-cardinality.log
done
```

2. **é…ç½®ä¸åŒç­–ç•¥**:

```yaml
# é«˜åŸºæ•°é…ç½®
scrape_configs:
  - job_name: high-cardinality
    static_configs:
      - targets:
          - localhost
        labels:
          job: high-card
        __path__: /tmp/high-cardinality.log

# ä½åŸºæ•°é…ç½®
scrape_configs:
  - job_name: low-cardinality
    static_configs:
      - targets:
          - localhost
        labels:
          job: low-card
        __path__: /tmp/low-cardinality.log
```

3. **æ€§èƒ½æµ‹è¯•**:

```bash
# æµ‹è¯•é«˜åŸºæ•°æ”¶é›†
time ./promtail-linux-amd64 -config.file=high-cardinality-config.yaml

# æµ‹è¯•ä½åŸºæ•°æ”¶é›†
time ./promtail-linux-amd64 -config.file=low-cardinality-config.yaml
```

## ğŸ“ æœ¬ç« å°ç»“

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ï¼š

- æ—¥å¿—æ”¶é›†çš„åŸºæœ¬åŸç†å’Œæµç¨‹
- ä¸åŒæ—¥å¿—æ”¶é›†æ–¹å¼çš„ä¼˜ç¼ºç‚¹
- æœ‰æ•ˆçš„æ ‡ç­¾è®¾è®¡ç­–ç•¥
- æ—¥å¿—æ ¼å¼æ ‡å‡†åŒ–æ–¹æ³•
- æ—¥å¿—æ”¶é›†çš„æœ€ä½³å®è·µå’Œå¸¸è§é—®é¢˜

æŒæ¡è¿™äº›çŸ¥è¯†å°†å¸®åŠ©æ‚¨è®¾è®¡å‡ºé«˜æ•ˆã€å¯é çš„æ—¥å¿—æ”¶é›†ç³»ç»Ÿï¼Œä¸ºåç»­çš„æ—¥å¿—æŸ¥è¯¢å’Œåˆ†ææ‰“ä¸‹åšå®åŸºç¡€ã€‚åœ¨ä¸‹ä¸€ç« [3.2 Promtailè¯¦è§£](./3.2-promtail.md)ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨Promtailçš„é…ç½®å’Œä½¿ç”¨æ–¹æ³•ã€‚

## ğŸ¤” æ€è€ƒé¢˜

1. ä¸ºä»€ä¹ˆé«˜åŸºæ•°æ ‡ç­¾ä¼šå½±å“Lokiçš„æ€§èƒ½ï¼Ÿ
2. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥é€‰æ‹©æ—¥å¿—é‡‡æ ·ï¼Ÿ
3. å¦‚ä½•å¹³è¡¡æ—¥å¿—è¯¦ç»†ç¨‹åº¦å’Œç³»ç»Ÿæ€§èƒ½ï¼Ÿ

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [Lokiæ—¥å¿—æ”¶é›†æœ€ä½³å®è·µ](https://grafana.com/docs/loki/latest/best-practices/)
- [Promtailé…ç½®æ–‡æ¡£](https://grafana.com/docs/loki/latest/clients/promtail/configuration/)
- [æ—¥å¿—æ”¶é›†æ¶æ„è®¾è®¡](https://grafana.com/docs/loki/latest/clients/)