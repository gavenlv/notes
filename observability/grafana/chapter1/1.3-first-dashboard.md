# 1.3 åˆ›å»ºç¬¬ä¸€ä¸ªä»ªè¡¨ç›˜

## ğŸ¯ å­¦ä¹ ç›®æ ‡

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ ï¼š

- ç†è§£Grafanaç•Œé¢å’ŒåŸºæœ¬æ¦‚å¿µ
- æ·»åŠ å’Œé…ç½®æ•°æ®æº
- åˆ›å»ºç¬¬ä¸€ä¸ªä»ªè¡¨ç›˜å’Œé¢æ¿
- ä½¿ç”¨æŸ¥è¯¢ç¼–è¾‘å™¨è·å–æ•°æ®
- è‡ªå®šä¹‰å¯è§†åŒ–é€‰é¡¹

## ğŸ–¥ï¸ Grafanaç•Œé¢æ¦‚è§ˆ

ç™»å½•Grafanaåï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹ä¸»è¦åŒºåŸŸï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ é¡¶éƒ¨å¯¼èˆªæ  (Grafanaå›¾æ ‡ + æœç´¢ + ç”¨æˆ·èœå•)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â”‚                                       â”‚
â”‚  ä¾§è¾¹æ       â”‚           ä¸»å†…å®¹åŒºåŸŸ                  â”‚
â”‚             â”‚                                       â”‚
â”‚ - ä»ªè¡¨ç›˜     â”‚                                       â”‚
â”‚ - æ¢ç´¢       â”‚                                       â”‚
â”‚ - å‘Šè­¦       â”‚                                       â”‚
â”‚ - é…ç½®       â”‚                                       â”‚
â”‚             â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å…³é”®æ¦‚å¿µ

1. **ä»ªè¡¨ç›˜(Dashboard)**: åŒ…å«å¤šä¸ªé¢æ¿çš„å®¹å™¨
2. **é¢æ¿(Panel)**: æ˜¾ç¤ºå•ä¸ªå¯è§†åŒ–å›¾è¡¨æˆ–æ–‡æœ¬
3. **æ•°æ®æº(Data Source)**: Grafanaä»ä¸­è·å–æ•°æ®çš„ç³»ç»Ÿ
4. **æŸ¥è¯¢(Query)**: ä»æ•°æ®æºè·å–æ•°æ®çš„è¯·æ±‚
5. **å˜é‡(Variable)**: å¯åŠ¨æ€æ”¹å˜å€¼çš„å ä½ç¬¦

## ğŸ”— æ·»åŠ æ•°æ®æº

è®©æˆ‘ä»¬é¦–å…ˆæ·»åŠ ä¸€ä¸ªæ•°æ®æºã€‚Grafanaæ”¯æŒå¤šç§æ•°æ®æºï¼Œå¦‚Prometheusã€InfluxDBã€Elasticsearchç­‰ã€‚å¯¹äºåˆå­¦è€…ï¼Œæˆ‘ä»¬é¦–å…ˆä½¿ç”¨Grafanaå†…ç½®çš„æµ‹è¯•æ•°æ®åº“ã€‚

### æ·»åŠ Test Dataæ•°æ®æº

1. ç‚¹å‡»å·¦ä¾§èœå•çš„"é½¿è½®"å›¾æ ‡(é…ç½®)
2. é€‰æ‹©"Data Sources"
3. ç‚¹å‡»"Add data source"
4. æœç´¢"TestData DB"
5. é€‰æ‹©"TestData DB"å¹¶ç‚¹å‡»"Select"
6. ä¿æŒé»˜è®¤è®¾ç½®ï¼Œç‚¹å‡»"Save & Test"

æ‚¨åº”è¯¥çœ‹åˆ°ç»¿è‰²çš„"Data source is working"æ¶ˆæ¯ã€‚

## ğŸ“Š åˆ›å»ºç¬¬ä¸€ä¸ªä»ªè¡¨ç›˜

### æ­¥éª¤1: åˆ›å»ºæ–°ä»ªè¡¨ç›˜

1. ç‚¹å‡»å·¦ä¾§èœå•çš„"+"å›¾æ ‡
2. é€‰æ‹©"Dashboard"
3. ç‚¹å‡»"Add new panel"

### æ­¥éª¤2: é…ç½®ç¬¬ä¸€ä¸ªé¢æ¿

1. åœ¨å³ä¾§é¢æ¿é…ç½®ä¸­ï¼Œé€‰æ‹©TestData DBæ•°æ®æº
2. åœ¨æŸ¥è¯¢ç¼–è¾‘å™¨ä¸­ï¼Œé€‰æ‹©"Random Walk"åœºæ™¯
3. é€‰æ‹©ä¸€ä¸ªåº¦é‡æŒ‡æ ‡ï¼Œå¦‚"Random Walk"
4. ç‚¹å‡»å³ä¸Šè§’çš„"Apply"æŒ‰é’®ä¿å­˜é¢æ¿

### æ­¥éª¤3: ä¿å­˜ä»ªè¡¨ç›˜

1. ç‚¹å‡»å³ä¸Šè§’çš„"Save"å›¾æ ‡
2. è¾“å…¥ä»ªè¡¨ç›˜åç§°ï¼š"æˆ‘çš„ç¬¬ä¸€ä¸ªä»ªè¡¨ç›˜"
3. æ·»åŠ å¯é€‰æè¿°
4. ç‚¹å‡»"Save"

## ğŸ¨ è‡ªå®šä¹‰é¢æ¿

### æ›´æ”¹å›¾è¡¨ç±»å‹

1. ç‚¹å‡»é¢æ¿æ ‡é¢˜
2. é€‰æ‹©"Edit"
3. åœ¨å³ä¾§é¢æ¿é…ç½®ä¸­ï¼Œæ‰¾åˆ°"Visualization"é€‰é¡¹
4. å°è¯•ä¸åŒçš„å¯è§†åŒ–ç±»å‹ï¼š
   - å›¾è¡¨(Graph)
   - å•å€¼ç»Ÿè®¡(Stat)
   - è¡¨æ ¼(Table)
   - ä»ªè¡¨ç›˜(Gauge)

### ä¿®æ”¹é¢æ¿é€‰é¡¹

#### å›¾è¡¨è®¾ç½®

1. **åæ ‡è½´**:
   - Yè½´ï¼šå•ä½ã€èŒƒå›´ã€æ ‡ç­¾
   - Xè½´ï¼šæ—¶é—´èŒƒå›´ã€æ˜¾ç¤ºé€‰é¡¹

2. **å›¾ä¾‹**:
   - ä½ç½®ï¼šåº•éƒ¨ã€å³ä¾§
   - æ˜¾ç¤ºæ–¹å¼ï¼šè¡¨æ ¼ã€åˆ—è¡¨
   - å€¼ï¼šæœ€å°å€¼ã€æœ€å¤§å€¼ã€å¹³å‡å€¼ç­‰

3. **æ˜¾ç¤ºé€‰é¡¹**:
   - çº¿æ¡ç²—ç»†ã€å¡«å……é€æ˜åº¦
   - ç‚¹å¤§å°å’Œæ˜¾ç¤ºæ–¹å¼

#### ç»Ÿè®¡é¢æ¿è®¾ç½®

1. **å€¼æ˜¾ç¤º**:
   - é€‰æ‹©è¦æ˜¾ç¤ºçš„ç»Ÿè®¡å€¼
   - å•ä½å’Œæ ¼å¼åŒ–
   - é˜ˆå€¼é¢œè‰²

2. **æ–‡æœ¬è®¾ç½®**:
   - å­—ä½“å¤§å°ã€é¢œè‰²
   - å¯¹é½æ–¹å¼

## ğŸ”§ æŸ¥è¯¢ç¼–è¾‘å™¨æ·±å…¥

æŸ¥è¯¢ç¼–è¾‘å™¨æ˜¯Grafanaçš„æ ¸å¿ƒç»„ä»¶ï¼Œç”¨äºä»æ•°æ®æºè·å–æ•°æ®ã€‚è®©æˆ‘ä»¬æ·±å…¥äº†è§£å…¶åŠŸèƒ½ï¼š

### åŸºæœ¬æŸ¥è¯¢

å¯¹äºTestData DBï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

1. é€‰æ‹©ä¸åŒçš„åœºæ™¯(Scenario):
   - Random Walk
   - CSV Metrics
   - Heatmap Data

2. é€‰æ‹©åº¦é‡æŒ‡æ ‡
3. è®¾ç½®åˆ«å(Alias)
4. è®¾ç½®è¿‡æ»¤å™¨å’Œæ ‡ç­¾

### é«˜çº§é€‰é¡¹

1. **æ ¼å¼**: æ—¶é—´åºåˆ—ã€è¡¨æ ¼ã€çƒ­åŠ›å›¾ç­‰
2. **é€‰é¡¹**:
   - æœ€å°é—´éš”
   - ç›¸å¯¹æ—¶é—´èŒƒå›´

## ğŸ“± ä»ªè¡¨ç›˜å¸ƒå±€

### è°ƒæ•´é¢æ¿å¤§å°å’Œä½ç½®

1. **è°ƒæ•´å¤§å°**: æ‹–åŠ¨é¢æ¿çš„å³ä¸‹è§’
2. **ç§»åŠ¨ä½ç½®**: æ‹–åŠ¨é¢æ¿çš„æ ‡é¢˜æ 
3. **ç½‘æ ¼ç³»ç»Ÿ**: Grafanaä½¿ç”¨24åˆ—ç½‘æ ¼ç³»ç»Ÿ

### æ·»åŠ æ›´å¤šé¢æ¿

1. ç‚¹å‡»å³ä¸Šè§’çš„"Add panel"
2. é‡å¤ä¹‹å‰çš„æ­¥éª¤åˆ›å»ºæ–°é¢æ¿
3. å°è¯•ä¸åŒçš„å¯è§†åŒ–ç±»å‹

### é¢æ¿æ’åˆ—ç¤ºä¾‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          ä¸»æ ‡é¢˜é¢æ¿                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   CPUä½¿ç”¨ç‡å›¾è¡¨  â”‚   å†…å­˜ä½¿ç”¨ç‡å›¾è¡¨   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ç£ç›˜I/Oç»Ÿè®¡    â”‚   ç½‘ç»œæµé‡å›¾è¡¨     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ å®è·µï¼šåˆ›å»ºç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ›´å®ç”¨çš„ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜ï¼š

### åˆ›å»ºCPUä½¿ç”¨ç‡é¢æ¿

1. ç‚¹å‡»"Add panel"
2. é€‰æ‹©TestData DBæ•°æ®æº
3. åœ¨æŸ¥è¯¢ç¼–è¾‘å™¨ä¸­ï¼š
   - åœºæ™¯: Random Walk
   - æŒ‡æ ‡: Random Walk #1
   - åˆ«å: CPUä½¿ç”¨ç‡
4. é€‰æ‹©"Stat"å¯è§†åŒ–ç±»å‹
5. åœ¨å³ä¾§è®¾ç½®ä¸­ï¼š
   - å•ä½: percent(0-100)
   - é˜ˆå€¼: ç»¿è‰²(0-50), é»„è‰²(50-80), çº¢è‰²(80-100)
6. ç‚¹å‡»"Apply"

### åˆ›å»ºå†…å­˜ä½¿ç”¨ç‡å›¾è¡¨

1. ç‚¹å‡»"Add panel"
2. é€‰æ‹©TestData DBæ•°æ®æº
3. åœ¨æŸ¥è¯¢ç¼–è¾‘å™¨ä¸­ï¼š
   - åœºæ™¯: Random Walk
   - æŒ‡æ ‡: Random Walk #2
   - åˆ«å: å†…å­˜ä½¿ç”¨ç‡
4. ä¿æŒ"Graph"å¯è§†åŒ–ç±»å‹
5. åœ¨å³ä¾§è®¾ç½®ä¸­ï¼š
   - Yè½´å•ä½: percent(0-100)
   - å›¾ä¾‹æ˜¾ç¤ºå¹³å‡å€¼å’Œæœ€å¤§å€¼
   - è®¾ç½®çº¿æ¡é¢œè‰²
6. ç‚¹å‡»"Apply"

### åˆ›å»ºç£ç›˜I/Oè¡¨æ ¼

1. ç‚¹å‡»"Add panel"
2. é€‰æ‹©TestData DBæ•°æ®æº
3. åœ¨æŸ¥è¯¢ç¼–è¾‘å™¨ä¸­ï¼š
   - åœºæ™¯: CSV Metrics
   - æŒ‡æ ‡: RandomWalk
   - æ ¼å¼: Table
4. é€‰æ‹©"Table"å¯è§†åŒ–ç±»å‹
5. åœ¨å³ä¾§è®¾ç½®ä¸­ï¼š
   - æ˜¾ç¤ºåˆ—é€‰æ‹©
   - åˆ—æ’åºå’Œç­›é€‰
6. ç‚¹å‡»"Apply"

## ğŸ” æ¢ç´¢æ¨¡å¼

é™¤äº†ä»ªè¡¨ç›˜ï¼ŒGrafanaè¿˜æä¾›äº†"Explore"åŠŸèƒ½ï¼Œç”¨äºä¸´æ—¶æŸ¥è¯¢å’Œæ¢ç´¢æ•°æ®ï¼š

1. ç‚¹å‡»å·¦ä¾§èœå•çš„"çˆ†ç‚¸"å›¾æ ‡(æ¢ç´¢)
2. é€‰æ‹©TestData DBæ•°æ®æº
3. è¾“å…¥æŸ¥è¯¢å¹¶å®æ—¶æŸ¥çœ‹ç»“æœ
4. ä½¿ç”¨æ—¶é—´é€‰æ‹©å™¨è°ƒæ•´æ—¶é—´èŒƒå›´
5. åœ¨ä¸åŒå¯è§†åŒ–ä¹‹é—´åˆ‡æ¢

## ğŸ’¾ å¯¼å…¥å’Œå¯¼å‡ºä»ªè¡¨ç›˜

### å¯¼å‡ºä»ªè¡¨ç›˜

1. æ‰“å¼€è¦å¯¼å‡ºçš„ä»ªè¡¨ç›˜
2. ç‚¹å‡»å³ä¸Šè§’çš„"å…±äº«"å›¾æ ‡
3. é€‰æ‹©"å¯¼å‡º"
4. é€‰æ‹©"ä¿å­˜ä¸ºJSONåˆ°æœ¬åœ°æ–‡ä»¶"
5. ç‚¹å‡»"ä¿å­˜"

### å¯¼å…¥ä»ªè¡¨ç›˜

1. ç‚¹å‡»å·¦ä¾§èœå•çš„"+"å›¾æ ‡
2. é€‰æ‹©"Import"
3. å¯é€‰æ‹©ï¼š
   - é€šè¿‡URLå¯¼å…¥
   - ä¸Šä¼ JSONæ–‡ä»¶
   - ç›´æ¥ç²˜è´´JSON
4. ç‚¹å‡»"Load"åè¿›è¡Œå¿…è¦çš„é…ç½®

## ğŸ§ª å®éªŒï¼šåˆ›å»ºå®Œæ•´ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜

ç°åœ¨ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜ï¼š

1. åˆ›å»ºä¸€ä¸ªåŒ…å«4ä¸ªé¢æ¿çš„ä»ªè¡¨ç›˜ï¼š
   - CPUä½¿ç”¨ç‡(Staté¢æ¿)
   - å†…å­˜ä½¿ç”¨ç‡(å›¾è¡¨)
   - ç£ç›˜I/O(è¡¨æ ¼)
   - ç½‘ç»œæµé‡(å›¾è¡¨)

2. ä¸ºæ¯ä¸ªé¢æ¿é…ç½®é€‚å½“çš„å•ä½å’Œé¢œè‰²

3. è®¾ç½®æ—¶é—´èŒƒå›´ä¸º"è¿‡å»1å°æ—¶"

4. ä¿å­˜ä»ªè¡¨ç›˜ä¸º"ç³»ç»Ÿç›‘æ§ä»ªè¡¨ç›˜"

**ç¤ºä¾‹ä»£ç å’Œé…ç½®ï¼š**

è§[code/experiments/system-dashboard.json](../code/chapter1/system-dashboard.json)

**è¦å¯¼å…¥æ­¤ä»ªè¡¨ç›˜ï¼š**
1. ç‚¹å‡»"+"å›¾æ ‡ > "Import"
2. ä¸Šä¼ system-dashboard.jsonæ–‡ä»¶
3. é€‰æ‹©TestData DBæ•°æ®æº
4. ç‚¹å‡»"Import"

## ğŸ¨ ä»ªè¡¨ç›˜ç¾åŒ–æŠ€å·§

### ä½¿ç”¨å˜é‡

1. ç‚¹å‡»ä»ªè¡¨ç›˜è®¾ç½®(é½¿è½®å›¾æ ‡)
2. é€‰æ‹©"Variables"
3. ç‚¹å‡»"Add variable"
4. æ·»åŠ ä¸»æœºåå˜é‡ï¼š
   - åç§°: hostname
   - ç±»å‹: å¸¸é‡
   - å€¼: server1,server2,server3

5. åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨å˜é‡: `$hostname`

### ä½¿ç”¨æ³¨é‡Š

1. åœ¨ä»ªè¡¨ç›˜è®¾ç½®ä¸­ï¼Œé€‰æ‹©"Annotations"
2. ç‚¹å‡»"New annotation"
3. é…ç½®æ˜¾ç¤ºæ¡ä»¶

### é¢æ¿é“¾æ¥å’Œé’»å–

1. ç¼–è¾‘é¢æ¿
2. åœ¨å³ä¾§æ‰¾åˆ°"Panel links"
3. æ·»åŠ é“¾æ¥åˆ°å…¶ä»–ä»ªè¡¨ç›˜

## ğŸ“ æœ¬ç« å°ç»“

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ï¼š

- Grafanaç•Œé¢çš„åŸºæœ¬ç»„æˆ
- å¦‚ä½•æ·»åŠ å’Œé…ç½®æ•°æ®æº
- åˆ›å»ºå’Œè‡ªå®šä¹‰ä»ªè¡¨ç›˜å’Œé¢æ¿
- ä½¿ç”¨æŸ¥è¯¢ç¼–è¾‘å™¨è·å–æ•°æ®
- å¯¼å…¥å’Œå¯¼å‡ºä»ªè¡¨ç›˜
- ä½¿ç”¨å˜é‡å’Œæ³¨é‡Šå¢å¼ºä»ªè¡¨ç›˜

ç°åœ¨æ‚¨å·²ç»æŒæ¡äº†Grafanaçš„åŸºç¡€æ“ä½œï¼Œå¯ä»¥åˆ›å»ºåŸºæœ¬çš„æ•°æ®å¯è§†åŒ–ä»ªè¡¨ç›˜ã€‚åœ¨ä¸‹ä¸€ç« [2.1 æ•°æ®æº](../chapter2/2.1-data-sources.md)ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨Grafanaæ”¯æŒçš„å„ç§æ•°æ®æºåŠå…¶é…ç½®æ–¹æ³•ã€‚

## ğŸ¤” æ€è€ƒé¢˜

1. ä¸ºä»€ä¹ˆåœ¨å®é™…ç¯å¢ƒä¸­ï¼ŒTestData DBä¸é€‚åˆä½œä¸ºé•¿æœŸæ•°æ®æºï¼Ÿ
2. ä»ªè¡¨ç›˜å’Œé¢æ¿çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸€ä¸ªä»ªè¡¨ç›˜æœ€å¤šå¯ä»¥åŒ…å«å¤šå°‘ä¸ªé¢æ¿ï¼Ÿ
3. åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨"æ¢ç´¢"æ¨¡å¼æ¯”ä»ªè¡¨ç›˜æ›´åˆé€‚ï¼Ÿ

## ğŸ“š å»¶ä¼¸é˜…è¯»

- [Grafanaä»ªè¡¨ç›˜å®˜æ–¹æ–‡æ¡£](https://grafana.com/docs/grafana/latest/dashboards/)
- [Grafanaé¢æ¿å¯è§†åŒ–æŒ‡å—](https://grafana.com/docs/grafana/latest/panels-visualizations/)
- [GrafanaæŸ¥è¯¢ç¼–è¾‘å™¨æ–‡æ¡£](https://grafana.com/docs/grafana/latest/panels-visualizations/query-editors/)