# ç¬¬2ç« ï¼šæ•°æ®åŠ è½½åŸºç¡€

> **å­¦ä¹ æ—¶é•¿**: 8-10å°æ—¶  
> **éš¾åº¦**: â­â­  
> **å‰ç½®çŸ¥è¯†**: ç¬¬1ç« 

## æœ¬ç« ç›®æ ‡

å­¦å®Œæœ¬ç« å,ä½ å°†èƒ½å¤Ÿ:

- âœ… æŒæ¡Qlik Senseæ‰€æœ‰æ•°æ®è¿æ¥å™¨çš„ä½¿ç”¨
- âœ… ç†Ÿç»ƒç¼–å†™åŸºç¡€Loadè„šæœ¬
- âœ… è¿æ¥æ–‡ä»¶ã€æ•°æ®åº“ã€Web APIç­‰æ•°æ®æº
- âœ… ç†è§£æ•°æ®åŠ è½½ç¼–è¾‘å™¨çš„å®Œæ•´åŠŸèƒ½
- âœ… è¿›è¡Œæ•°æ®é¢„è§ˆå’Œè°ƒè¯•
- âœ… å®ç°æ•°æ®è´¨é‡æ£€æŸ¥
- âœ… ä¼˜åŒ–æ•°æ®åŠ è½½æ€§èƒ½

---

## 2.1 æ•°æ®è¿æ¥å™¨æ¦‚è¿°

### 2.1.1 Qlik Senseæ”¯æŒçš„æ•°æ®æº

**Qlik Senseå¯ä»¥è¿æ¥å‡ ä¹æ‰€æœ‰æ•°æ®æº**:

```
æ•°æ®æºåˆ†ç±»:

ğŸ“ æ–‡ä»¶æ•°æ®æº
â”œâ”€ Excel (.xlsx, .xls)
â”œâ”€ CSV / TXT
â”œâ”€ JSON
â”œâ”€ XML
â”œâ”€ QVD (Qlikæ•°æ®æ–‡ä»¶)
â”œâ”€ QVX
â””â”€ Parquet

ğŸ—„ï¸ æ•°æ®åº“
â”œâ”€ SQL Server
â”œâ”€ Oracle
â”œâ”€ MySQL / MariaDB
â”œâ”€ PostgreSQL
â”œâ”€ SAP HANA
â”œâ”€ MongoDB
â”œâ”€ Teradata
â””â”€ Amazon Redshift

â˜ï¸ äº‘æ•°æ®æº
â”œâ”€ Salesforce
â”œâ”€ Google Analytics
â”œâ”€ Microsoft Dynamics
â”œâ”€ Azure SQL
â”œâ”€ Amazon S3
â””â”€ Google BigQuery

ğŸŒ Webæ•°æ®æº
â”œâ”€ REST API
â”œâ”€ SOAP Web Services
â”œâ”€ OData
â””â”€ SharePoint

ğŸ“Š å…¶ä»–
â”œâ”€ ODBC
â”œâ”€ OLE DB
â””â”€ Custom Connectors
```

### 2.1.2 æ•°æ®è¿æ¥å™¨æ¶æ„

**Qlik Senseè¿æ¥å™¨å·¥ä½œåŸç†**:

```mermaid
graph LR
    A[æ•°æ®æº] --> B[è¿æ¥å™¨]
    B --> C[æ•°æ®åŠ è½½ç¼–è¾‘å™¨]
    C --> D[åŠ è½½è„šæœ¬]
    D --> E[æ•°æ®è½¬æ¢]
    E --> F[å…³è”å¼•æ“]
    F --> G[å†…å­˜å­˜å‚¨]
```

**è¿æ¥å™¨ç±»å‹**:

1. **å†…ç½®è¿æ¥å™¨**: QlikåŸç”Ÿæ”¯æŒ
2. **ODBC/OLEDB**: é€šç”¨æ•°æ®åº“è¿æ¥
3. **è‡ªå®šä¹‰è¿æ¥å™¨**: Qlik Connector SDKå¼€å‘

### 2.1.3 æ•°æ®è¿æ¥æƒé™

**Desktop vs Enterprise**:

```
Qlik Sense Desktop:
â””â”€ æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿè®¿é—®
â””â”€ ODBCæ•°æ®æº
â””â”€ å—é™çš„Webè¿æ¥

Qlik Sense Enterprise:
â”œâ”€ æ•°æ®è¿æ¥åº“ç®¡ç†
â”œâ”€ é›†ä¸­å¼è¿æ¥é…ç½®
â”œâ”€ å®Œæ•´çš„å®‰å…¨æ§åˆ¶
â””â”€ æ‰€æœ‰è¿æ¥å™¨æ”¯æŒ
```

---

## 2.2 æ–‡ä»¶æ•°æ®æº

### 2.2.1 Excelæ–‡ä»¶

**åŠ è½½Excelæ–‡ä»¶çš„æ–¹æ³•**:

**æ–¹æ³•1: æ•°æ®ç®¡ç†å™¨ (æ¨èåˆå­¦è€…)**

1. ç‚¹å‡» **[æ·»åŠ æ•°æ®]**
2. é€‰æ‹©æ–‡ä»¶ä½ç½®
3. æµè§ˆé€‰æ‹©Excelæ–‡ä»¶
4. é€‰æ‹©å·¥ä½œè¡¨
5. é¢„è§ˆæ•°æ®
6. è°ƒæ•´å­—æ®µç±»å‹
7. ç‚¹å‡» **[æ·»åŠ æ•°æ®]**

**æ–¹æ³•2: æ•°æ®åŠ è½½ç¼–è¾‘å™¨ (ä¸“ä¸šæ–¹å¼)**

```qlik
// åŸºç¡€ExcelåŠ è½½
LOAD
    è®¢å•ID,
    è®¢å•æ—¥æœŸ,
    å®¢æˆ·åç§°,
    äº§å“åç§°,
    æ•°é‡,
    å•ä»·,
    é‡‘é¢
FROM [lib://DataFiles/é”€å”®æ•°æ®.xlsx]
(ooxml, embedded labels, table is Sheet1);
```

**é«˜çº§ExcelåŠ è½½**:

```qlik
// æŒ‡å®šç‰¹å®šåŒºåŸŸ
LOAD
    *
FROM [lib://DataFiles/æ•°æ®.xlsx]
(ooxml, embedded labels, table is Sheet1, range is 'A1:G100');

// è·³è¿‡è¡Œ
LOAD
    *
FROM [lib://DataFiles/æ•°æ®.xlsx]
(ooxml, no labels, header is 3 lines, table is Sheet1);

// åŠ è½½å¤šä¸ªå·¥ä½œè¡¨
LOAD * FROM [lib://DataFiles/æ•°æ®.xlsx]
(ooxml, embedded labels, table is é”€å”®);

LOAD * FROM [lib://DataFiles/æ•°æ®.xlsx]
(ooxml, embedded labels, table is å®¢æˆ·);

LOAD * FROM [lib://DataFiles/æ•°æ®.xlsx]
(ooxml, embedded labels, table is äº§å“);
```

**å¤„ç†Excelç‰¹æ®Šæƒ…å†µ**:

```qlik
// å¤„ç†æ—¥æœŸæ ¼å¼
LOAD
    è®¢å•ID,
    Date(Floor(è®¢å•æ—¥æœŸ)) as è®¢å•æ—¥æœŸ,  // æ ‡å‡†åŒ–æ—¥æœŸ
    å®¢æˆ·åç§°,
    é‡‘é¢
FROM [lib://DataFiles/è®¢å•.xlsx]
(ooxml, embedded labels, table is Sheet1);

// å¤„ç†ç©ºå€¼
LOAD
    è®¢å•ID,
    If(Len(Trim(å®¢æˆ·åç§°))=0, 'æœªçŸ¥', å®¢æˆ·åç§°) as å®¢æˆ·åç§°,
    If(IsNull(é‡‘é¢), 0, é‡‘é¢) as é‡‘é¢
FROM [lib://DataFiles/è®¢å•.xlsx]
(ooxml, embedded labels, table is Sheet1);

// è¿‡æ»¤æ•°æ®
LOAD
    *
FROM [lib://DataFiles/è®¢å•.xlsx]
(ooxml, embedded labels, table is Sheet1)
WHERE é‡‘é¢ > 0 AND Not IsNull(è®¢å•æ—¥æœŸ);
```

### 2.2.2 CSV/æ–‡æœ¬æ–‡ä»¶

**åŸºç¡€CSVåŠ è½½**:

```qlik
// æ ‡å‡†CSV (é€—å·åˆ†éš”)
LOAD
    *
FROM [lib://DataFiles/customers.csv]
(txt, utf8, embedded labels, delimiter is ',', msq);

// Tabåˆ†éš”
LOAD
    *
FROM [lib://DataFiles/data.txt]
(txt, utf8, embedded labels, delimiter is '\t', msq);

// åˆ†å·åˆ†éš”
LOAD
    *
FROM [lib://DataFiles/data_eu.csv]
(txt, utf8, embedded labels, delimiter is ';', msq);

// å›ºå®šå®½åº¦
LOAD
    @1:10 as å®¢æˆ·ID,
    @11:40 as å®¢æˆ·åç§°,
    @41:50 as åŸå¸‚
FROM [lib://DataFiles/fixed_width.txt]
(fix, utf8, no labels);
```

**å¤„ç†ç¼–ç é—®é¢˜**:

```qlik
// UTF-8ç¼–ç  (æ¨è)
LOAD * FROM data.csv (txt, utf8, embedded labels);

// UTF-16
LOAD * FROM data.csv (txt, unicode, embedded labels);

// ANSI/GBK (ä¸­æ–‡)
LOAD * FROM data.csv (txt, codepage is 936, embedded labels);

// è‡ªåŠ¨æ£€æµ‹
LOAD * FROM data.csv (txt, embedded labels);
```

**å¤§æ–‡ä»¶ä¼˜åŒ–**:

```qlik
// ç¼“å†²åŠ è½½(Buffer)
Buffer LOAD
    *
FROM [lib://DataFiles/large_file.csv]
(txt, utf8, embedded labels, delimiter is ',');

// åˆ†æ‰¹åŠ è½½
FOR i = 1 to 10
    LOAD
        *
    FROM [lib://DataFiles/data_part$(i).csv]
    (txt, utf8, embedded labels);
NEXT i;
```

### 2.2.3 JSONæ–‡ä»¶

**åŠ è½½JSON**:

```json
// sample.json
{
    "customers": [
        {
            "id": 1,
            "name": "å¼ ä¸‰",
            "orders": [
                {"orderId": "001", "amount": 100},
                {"orderId": "002", "amount": 200}
            ]
        },
        {
            "id": 2,
            "name": "æå››",
            "orders": [
                {"orderId": "003", "amount": 150}
            ]
        }
    ]
}
```

**Qlikè„šæœ¬**:

```qlik
// åŠ è½½JSON
LOAD
    id,
    name,
    orders
FROM [lib://DataFiles/sample.json]
(json);

// å±•å¼€åµŒå¥—ç»“æ„
customers:
LOAD
    id as CustomerID,
    name as CustomerName
FROM [lib://DataFiles/sample.json]
(json) WHERE NOT IsNull(id);

orders:
LOAD
    id as CustomerID,
    orderId,
    amount
FROM [lib://DataFiles/sample.json]
(json) WHERE NOT IsNull(orderId);
```

### 2.2.4 XMLæ–‡ä»¶

**XMLç¤ºä¾‹**:

```xml
<!-- products.xml -->
<products>
    <product>
        <id>P001</id>
        <name>äº§å“A</name>
        <price>100</price>
        <category>ç”µå­</category>
    </product>
    <product>
        <id>P002</id>
        <name>äº§å“B</name>
        <price>200</price>
        <category>å®¶ç”µ</category>
    </product>
</products>
```

**åŠ è½½XML**:

```qlik
products:
LOAD
    id as ProductID,
    name as ProductName,
    price as Price,
    category as Category
FROM [lib://DataFiles/products.xml]
(XmlSimple, table is [products/product]);
```

### 2.2.5 QVDæ–‡ä»¶

**ä»€ä¹ˆæ˜¯QVD?**

QVD (QlikView Data) æ˜¯Qlikä¸“æœ‰çš„é«˜æ€§èƒ½æ•°æ®æ ¼å¼:

- âœ… æå¿«çš„è¯»å†™é€Ÿåº¦
- âœ… é«˜å‹ç¼©æ¯” (é€šå¸¸10:1)
- âœ… ä¿ç•™æ•°æ®ç»“æ„
- âœ… å¢é‡åŠ è½½åŸºç¡€

**åˆ›å»ºQVD**:

```qlik
// ä»æ•°æ®æºåŠ è½½å¹¶ä¿å­˜ä¸ºQVD
Sales:
LOAD
    *
FROM [lib://DataFiles/sales.csv]
(txt, utf8, embedded labels);

STORE Sales INTO [lib://QVD/sales.qvd] (qvd);

// ä¼˜åŒ–çš„QVDå­˜å‚¨
LOAD
    OrderID,
    Date(OrderDate) as OrderDate,
    CustomerID,
    ProductID,
    Num(Quantity) as Quantity,
    Num(Amount, '#,##0.00') as Amount
FROM [lib://DataFiles/orders.csv]
(txt, utf8, embedded labels);

STORE Orders INTO [lib://QVD/orders.qvd] (qvd);
DROP Table Orders;
```

**ä½¿ç”¨QVD**:

```qlik
// ä¼˜åŒ–åŠ è½½(æ— è½¬æ¢)
Sales:
LOAD * FROM [lib://QVD/sales.qvd] (qvd);

// è¶…ä¼˜åŒ–åŠ è½½(æœ€å¿«)
Sales:
LOAD
    OrderID,
    OrderDate,
    CustomerID,
    Amount
FROM [lib://QVD/sales.qvd] (qvd);

// å¢é‡åŠ è½½
LET vLastLoad = Date(Floor(QvdCreateTime('[lib://QVD/sales.qvd]')));

// åŠ è½½å†å²æ•°æ®
Sales:
LOAD * FROM [lib://QVD/sales.qvd] (qvd);

// è¿½åŠ æ–°æ•°æ®
CONCATENATE (Sales)
LOAD *
FROM [lib://DataFiles/sales.csv]
(txt, utf8, embedded labels)
WHERE OrderDate > '$(vLastLoad)';

// ä¿å­˜æ›´æ–°çš„QVD
STORE Sales INTO [lib://QVD/sales.qvd] (qvd);
```

---

## 2.3 æ•°æ®åº“è¿æ¥

### 2.3.1 SQL Serverè¿æ¥

**åˆ›å»ºæ•°æ®è¿æ¥**:

1. **åœ¨QMCä¸­åˆ›å»ºè¿æ¥** (Enterprise):
   - è¿æ¥åç§°: `SQL_Server_Production`
   - ç±»å‹: SQL Server
   - æœåŠ¡å™¨: `server.company.com`
   - æ•°æ®åº“: `SalesDB`
   - è®¤è¯: Windows/SQL Server

2. **åœ¨Desktopä¸­ä½¿ç”¨ODBC**:

**ODBCé…ç½®**:

```powershell
# Windows ODBCæ•°æ®æºç®¡ç†å™¨
# æ§åˆ¶é¢æ¿ â†’ ç®¡ç†å·¥å…· â†’ ODBCæ•°æ®æº(64ä½)
# æ·»åŠ ç³»ç»ŸDSN â†’ SQL Server
```

**Loadè„šæœ¬**:

```qlik
LIB CONNECT TO 'SQL_Server_Production';

// åŠ è½½æ•´è¡¨
Sales:
SQL SELECT
    OrderID,
    OrderDate,
    CustomerID,
    ProductID,
    Quantity,
    Amount
FROM dbo.Sales;

// ä½¿ç”¨WHEREå­å¥
Sales:
SQL SELECT *
FROM dbo.Sales
WHERE OrderDate >= '2024-01-01';

// JOINå¤šè¡¨
Orders:
SQL SELECT
    o.OrderID,
    o.OrderDate,
    c.CustomerName,
    p.ProductName,
    od.Quantity,
    od.Amount
FROM Orders o
INNER JOIN Customers c ON o.CustomerID = c.CustomerID
INNER JOIN OrderDetails od ON o.OrderID = od.OrderID
INNER JOIN Products p ON od.ProductID = p.ProductID;

// ä½¿ç”¨å‚æ•°
LET vStartDate = '2024-01-01';
LET vEndDate = '2024-12-31';

Sales:
SQL SELECT *
FROM dbo.Sales
WHERE OrderDate BETWEEN '$(vStartDate)' AND '$(vEndDate)';
```

**æ€§èƒ½ä¼˜åŒ–**:

```qlik
// âŒ ä¸æ¨è: åŠ è½½åè¿‡æ»¤
Sales:
SQL SELECT * FROM Sales;  // åŠ è½½å…¨éƒ¨
WHERE OrderDate >= '2024-01-01';  // Qlikç«¯è¿‡æ»¤

// âœ… æ¨è: æ•°æ®åº“ç«¯è¿‡æ»¤
Sales:
SQL SELECT *
FROM Sales
WHERE OrderDate >= '2024-01-01';  // æ•°æ®åº“ç«¯è¿‡æ»¤

// âœ… æœ€ä½³: å…ˆå­˜QVD,å†ä½¿ç”¨QVD
// ç¬¬ä¸€æ¬¡å…¨é‡åŠ è½½
Sales:
SQL SELECT * FROM Sales;
STORE Sales INTO [lib://QVD/sales.qvd] (qvd);
DROP Table Sales;

// åç»­ä½¿ç”¨QVD
Sales:
LOAD * FROM [lib://QVD/sales.qvd] (qvd);
```

### 2.3.2 MySQLè¿æ¥

```qlik
LIB CONNECT TO 'MySQL_Connection';

// åŸºç¡€æŸ¥è¯¢
Products:
SQL SELECT
    product_id,
    product_name,
    category,
    price
FROM products;

// å¤„ç†UTF-8ä¸­æ–‡
SET CharacterSet='utf8mb4';

Products:
SQL SELECT * FROM products;
```

### 2.3.3 Oracleè¿æ¥

```qlik
LIB CONNECT TO 'Oracle_DB';

// Oracleç‰¹å®šè¯­æ³•
Sales:
SQL SELECT
    order_id,
    TO_CHAR(order_date, 'YYYY-MM-DD') as order_date,
    customer_id,
    amount
FROM sales
WHERE order_date >= TO_DATE('2024-01-01', 'YYYY-MM-DD');
```

### 2.3.4 PostgreSQLè¿æ¥

```qlik
LIB CONNECT TO 'PostgreSQL_DB';

Customers:
SQL SELECT
    customer_id::TEXT as customer_id,
    customer_name,
    city,
    country
FROM customers;
```

---

## 2.4 Webæ•°æ®æº

### 2.4.1 REST APIè¿æ¥

**åˆ›å»ºRESTè¿æ¥**:

```qlik
// REST Connectoré…ç½®
LIB CONNECT TO 'REST_API';

// GETè¯·æ±‚
RestConnectorMasterTable:
SQL SELECT
    "id",
    "name",
    "email"
FROM JSON (wrap on) "root"
WITH CONNECTION (
    URL "https://api.example.com/users"
);

// å¸¦è®¤è¯
RestConnectorMasterTable:
SQL SELECT *
FROM JSON
WITH CONNECTION (
    URL "https://api.example.com/data",
    HTTPHEADER "Authorization" "Bearer YOUR_TOKEN"
);

// POSTè¯·æ±‚
RestConnectorMasterTable:
SQL SELECT *
FROM JSON
WITH CONNECTION (
    URL "https://api.example.com/query",
    HTTPMETHOD "POST",
    BODY "{"query":"data"}",
    HTTPHEADER "Content-Type" "application/json"
);
```

**å¤„ç†åˆ†é¡µ**:

```qlik
// å¾ªç¯è·å–æ‰€æœ‰é¡µ
LET vPage = 1;
LET vHasMore = 1;

DO WHILE vHasMore = 1
    
    RestConnectorMasterTable:
    SQL SELECT
        "id",
        "name",
        "data"
    FROM JSON
    WITH CONNECTION (
        URL "https://api.example.com/data?page=$(vPage)"
    );
    
    LET vRecordCount = NoOfRows('RestConnectorMasterTable');
    
    IF vRecordCount = 0 THEN
        LET vHasMore = 0;
    ELSE
        LET vPage = vPage + 1;
    END IF
    
LOOP
```

### 2.4.2 Webæ–‡ä»¶åŠ è½½

```qlik
// ä»URLåŠ è½½CSV
LOAD *
FROM [https://example.com/data/sales.csv]
(txt, utf8, embedded labels, delimiter is ',');

// ä»WebåŠ è½½Excel
LOAD *
FROM [https://example.com/data/report.xlsx]
(ooxml, embedded labels, table is Sheet1);
```

---

## 2.5 æ•°æ®åŠ è½½ç¼–è¾‘å™¨è¯¦è§£

### 2.5.1 ç•Œé¢å¸ƒå±€

```
æ•°æ®åŠ è½½ç¼–è¾‘å™¨ç•Œé¢:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ–‡ä»¶ ç¼–è¾‘ æŸ¥çœ‹ è°ƒè¯• å¸®åŠ©                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      â”‚  // ä¸»éƒ¨åˆ† - è„šæœ¬ç¼–è¾‘åŒº              â”‚
â”‚ æ•°æ® â”‚  LOAD                                â”‚
â”‚ è¿æ¥ â”‚      OrderID,                        â”‚
â”‚      â”‚      OrderDate,                      â”‚
â”‚ é€‰æ‹© â”‚      Amount                          â”‚
â”‚ è„šæœ¬ â”‚  FROM [lib://Data/sales.csv]        â”‚
â”‚      â”‚  (txt, utf8, embedded labels);      â”‚
â”‚ å˜é‡ â”‚                                      â”‚
â”‚      â”‚                                      â”‚
â”‚ è¡¨   â”‚                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â–¶ åŠ è½½æ•°æ®    è°ƒè¯•    è¿›åº¦æ¡               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.5.2 è„šæœ¬ç»“æ„

**æ ‡å‡†è„šæœ¬ç»“æ„**:

```qlik
///$tab Main
// ========================================
// ä¸»è„šæœ¬
// ä½œè€…: [å§“å]
// æ—¥æœŸ: 2024-01-15
// æè¿°: é”€å”®æ•°æ®åˆ†æåº”ç”¨
// ========================================

///$tab å˜é‡è®¾ç½®
// è®¾ç½®å˜é‡
SET ThousandSep=',';
SET DecimalSep='.';
SET MoneyThousandSep=',';
SET MoneyDecimalSep='.';
SET MoneyFormat='Â¥#,##0.00;-Â¥#,##0.00';
SET TimeFormat='h:mm:ss';
SET DateFormat='YYYY-MM-DD';
SET TimestampFormat='YYYY-MM-DD hh:mm:ss[.fff]';

// è‡ªå®šä¹‰å˜é‡
LET vToday = Date(Today());
LET vYesterday = Date(Today()-1);
LET vDataPath = 'lib://DataFiles';

///$tab æ•°æ®åŠ è½½
// åŠ è½½é”€å”®æ•°æ®
Sales:
LOAD
    OrderID,
    Date(OrderDate) as OrderDate,
    CustomerID,
    ProductID,
    Quantity,
    Amount
FROM [$(vDataPath)/sales.csv]
(txt, utf8, embedded labels);

// åŠ è½½å®¢æˆ·æ•°æ®
Customers:
LOAD
    CustomerID,
    CustomerName,
    City,
    Country
FROM [$(vDataPath)/customers.csv]
(txt, utf8, embedded labels);

///$tab æ•°æ®è½¬æ¢
// æ•°æ®æ¸…æ´—å’Œè½¬æ¢
// (è§ç¬¬5ç« è¯¦ç»†å†…å®¹)

///$tab æ—¥å†è¡¨
// åˆ›å»ºæ—¥å†ç»´åº¦
// (è§åç»­ç« èŠ‚)

///$tab é€€å‡ºè„šæœ¬
// è„šæœ¬ç»“æŸ
EXIT SCRIPT;
```

### 2.5.3 è„šæœ¬è°ƒè¯•

**è°ƒè¯•æŠ€æœ¯**:

```qlik
// 1. ä½¿ç”¨TRACEè¾“å‡º
TRACE å¼€å§‹åŠ è½½é”€å”®æ•°æ®;
Sales:
LOAD * FROM sales.csv;
TRACE é”€å”®æ•°æ®åŠ è½½å®Œæˆ, è¡Œæ•°: $(NoOfRows('Sales'));

// 2. é™åˆ¶è¡Œæ•°æµ‹è¯•
Sales:
LOAD * FROM sales.csv (txt, utf8, embedded labels)
WHERE RecNo() <= 1000;  // ä»…åŠ è½½å‰1000è¡Œ

// 3. æ–­ç‚¹è°ƒè¯•
// åœ¨è„šæœ¬ä¸­å³é”® â†’ åˆ‡æ¢æ–­ç‚¹
// ç„¶åç‚¹å‡»"è°ƒè¯•"æŒ‰é’®

// 4. æŸ¥çœ‹åŠ è½½è¿›åº¦
TRACE ===== å¼€å§‹åŠ è½½ =====;
FOR Each vFile in FileList('$(vDataPath)/*.csv')
    TRACE åŠ è½½æ–‡ä»¶: $(vFile);
    LOAD * FROM [$(vFile)] (txt, utf8, embedded labels);
NEXT

// 5. é”™è¯¯å¤„ç†
Sales:
LOAD * FROM sales.csv;

IF ScriptError THEN
    TRACE é”™è¯¯: æ— æ³•åŠ è½½é”€å”®æ•°æ®;
    TRACE é”™è¯¯ä»£ç : $(ScriptErrorCount);
    EXIT SCRIPT;
END IF
```

---

## 2.6 æ•°æ®é¢„è§ˆä¸éªŒè¯

### 2.6.1 æ•°æ®é¢„è§ˆ

**åœ¨åŠ è½½è¿‡ç¨‹ä¸­é¢„è§ˆ**:

```qlik
// åŠ è½½æ•°æ®
Sales:
LOAD *
FROM [lib://Data/sales.csv]
(txt, utf8, embedded labels);

// é¢„è§ˆè¡¨
// æ–¹æ³•1: è„šæœ¬ä¸­æ·»åŠ 
NullAsValue *;
SET NullValue = '<NULL>';

// æ–¹æ³•2: æ•°æ®æ¨¡å‹æŸ¥çœ‹å™¨
// åŠ è½½åè‡ªåŠ¨å¯ä»¥æŸ¥çœ‹
```

### 2.6.2 æ•°æ®è´¨é‡æ£€æŸ¥

```qlik
///$tab æ•°æ®è´¨é‡æ£€æŸ¥

// 1. æ£€æŸ¥ç©ºå€¼
QualityCheck_NullValues:
LOAD
    'Sales' as TableName,
    'OrderID' as FieldName,
    Count(*) as TotalRows,
    Sum(If(Len(Trim(OrderID))=0, 1, 0)) as NullCount
RESIDENT Sales;

// 2. æ£€æŸ¥é‡å¤
QualityCheck_Duplicates:
LOAD
    OrderID,
    Count(*) as DuplicateCount
RESIDENT Sales
GROUP BY OrderID
HAVING Count(*) > 1;

// 3. æ£€æŸ¥æ•°æ®èŒƒå›´
QualityCheck_Range:
LOAD
    Min(OrderDate) as MinDate,
    Max(OrderDate) as MaxDate,
    Min(Amount) as MinAmount,
    Max(Amount) as MaxAmount,
    Avg(Amount) as AvgAmount
RESIDENT Sales;

// 4. æ£€æŸ¥æ•°æ®ç±»å‹
QualityCheck_DataTypes:
LOAD
    OrderID,
    OrderDate,
    If(IsNum(Amount), 'Number', 'Not Number') as AmountType
RESIDENT Sales
WHERE If(IsNum(Amount), 0, 1) = 1;  // ä»…æ˜¾ç¤ºé”™è¯¯çš„

// è¾“å‡ºæ£€æŸ¥ç»“æœåˆ°æ—¥å¿—
TRACE ===== æ•°æ®è´¨é‡æ£€æŸ¥ =====;
FOR i = 0 TO NoOfRows('QualityCheck_NullValues')-1
    LET vTableName = Peek('TableName', i, 'QualityCheck_NullValues');
    LET vFieldName = Peek('FieldName', i, 'QualityCheck_NullValues');
    LET vNullCount = Peek('NullCount', i, 'QualityCheck_NullValues');
    TRACE è¡¨: $(vTableName), å­—æ®µ: $(vFieldName), ç©ºå€¼: $(vNullCount);
NEXT
```

---

## 2.7 æ€§èƒ½ä¼˜åŒ–

### 2.7.1 åŠ è½½æ€§èƒ½ä¼˜åŒ–

```qlik
// âŒ ä½æ•ˆ
LOAD * FROM large_table.csv;  // åŠ è½½æ‰€æœ‰åˆ—

// âœ… é«˜æ•ˆ
LOAD
    OrderID,
    OrderDate,
    Amount  // ä»…åŠ è½½éœ€è¦çš„åˆ—
FROM large_table.csv;

// âŒ ä½æ•ˆ: å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®æº
Sales:
LOAD * FROM data.csv;

Products:
LOAD DISTINCT ProductID FROM data.csv;

// âœ… é«˜æ•ˆ: ä¸€æ¬¡è¯»å–,å¤šæ¬¡ä½¿ç”¨
TempData:
LOAD * FROM data.csv;

Sales:
LOAD * RESIDENT TempData;

Products:
LOAD DISTINCT ProductID RESIDENT TempData;

DROP Table TempData;
```

### 2.7.2 ä½¿ç”¨Buffer

```qlik
// Bufferä¼šç¼“å­˜æ•°æ®,ä¸‹æ¬¡åŠ è½½æ—¶ç›´æ¥ä»ç¼“å­˜è¯»å–
Buffer (Incremental) LOAD
    *
FROM [lib://Data/large_file.csv]
(txt, utf8, embedded labels);

// Bufferæœ‰æ•ˆæœŸè®¾ç½®
Buffer (Stale after 7 days) LOAD
    *
FROM data.csv;
```

---

## 2.8 å®éªŒ:ç»¼åˆæ•°æ®åŠ è½½

### å®éªŒ1: å¤šæºæ•°æ®æ•´åˆ

**ç›®æ ‡**: ä»Excelã€CSVã€æ•°æ®åº“åŠ è½½æ•°æ®å¹¶æ•´åˆ

**æ•°æ®å‡†å¤‡**:

åˆ›å»ºä»¥ä¸‹æ–‡ä»¶:

**orders.xlsx**:
```
OrderID | OrderDate  | CustomerID | Amount
001     | 2024-01-01 | C001       | 1000
002     | 2024-01-02 | C002       | 1500
```

**customers.csv**:
```
CustomerID,CustomerName,City
C001,å¼ ä¸‰,åŒ—äº¬
C002,æå››,ä¸Šæµ·
```

**Qlikè„šæœ¬**:

```qlik
///$tab è®¢å•æ•°æ®
Orders:
LOAD
    OrderID,
    Date(OrderDate) as OrderDate,
    CustomerID,
    Num(Amount) as Amount
FROM [lib://Data/orders.xlsx]
(ooxml, embedded labels, table is Sheet1);

///$tab å®¢æˆ·æ•°æ®
Customers:
LOAD
    CustomerID,
    CustomerName,
    City
FROM [lib://Data/customers.csv]
(txt, utf8, embedded labels);

///$tab æ•°æ®æ•´åˆ
// Qlikä¼šè‡ªåŠ¨å…³è”CustomerIDå­—æ®µ
// æ— éœ€æ‰‹åŠ¨JOIN

///$tab éªŒè¯
TRACE è®¢å•æ•°: $(NoOfRows('Orders'));
TRACE å®¢æˆ·æ•°: $(NoOfRows('Customers'));
```

### å®éªŒ2: å¢é‡åŠ è½½

```qlik
///$tab å¢é‡åŠ è½½è®¾ç½®

// æ£€æŸ¥QVDæ˜¯å¦å­˜åœ¨
IF NOT IsNull(QvdCreateTime('[lib://QVD/sales.qvd]')) THEN
    
    // è·å–ä¸Šæ¬¡åŠ è½½æ—¶é—´
    LET vLastLoadDate = Date(QvdCreateTime('[lib://QVD/sales.qvd]'), 'YYYY-MM-DD');
    
    // åŠ è½½å†å²æ•°æ®
    Sales:
    LOAD * FROM [lib://QVD/sales.qvd] (qvd);
    
    // è¿½åŠ æ–°æ•°æ®
    CONCATENATE (Sales)
    LOAD *
    FROM [lib://Data/sales.csv]
    (txt, utf8, embedded labels)
    WHERE OrderDate > '$(vLastLoadDate)';
    
ELSE
    // ç¬¬ä¸€æ¬¡åŠ è½½å…¨éƒ¨æ•°æ®
    Sales:
    LOAD *
    FROM [lib://Data/sales.csv]
    (txt, utf8, embedded labels);
    
END IF

// ä¿å­˜æ›´æ–°çš„QVD
STORE Sales INTO [lib://QVD/sales.qvd] (qvd);
```

---

## 2.9 è¯¾åç»ƒä¹ 

### ç»ƒä¹ 1: å¤šæ ¼å¼æ•°æ®åŠ è½½

**ä»»åŠ¡**:
1. åŠ è½½Excelæ–‡ä»¶ (products.xlsx)
2. åŠ è½½CSVæ–‡ä»¶ (sales.csv)
3. ç¡®ä¿æ•°æ®å…³è”æ­£ç¡®
4. åˆ›å»ºç®€å•å¯è§†åŒ–éªŒè¯æ•°æ®

### ç»ƒä¹ 2: æ•°æ®è´¨é‡æ£€æŸ¥

**ä»»åŠ¡**:
ç¼–å†™è„šæœ¬æ£€æŸ¥:
1. ç©ºå€¼æ•°é‡
2. é‡å¤è®°å½•
3. æ•°æ®ç±»å‹é”™è¯¯
4. æ—¥æœŸèŒƒå›´

### ç»ƒä¹ 3: QVDä¼˜åŒ–

**ä»»åŠ¡**:
1. å°†CSVæ•°æ®è½¬æ¢ä¸ºQVD
2. å®ç°å¢é‡åŠ è½½
3. å¯¹æ¯”åŠ è½½æ—¶é—´å·®å¼‚

---

## 2.10 æœ¬ç« å°ç»“

### æ ¸å¿ƒçŸ¥è¯†ç‚¹

âœ… **æ•°æ®è¿æ¥å™¨**: æ–‡ä»¶ã€æ•°æ®åº“ã€Web API

âœ… **Loadè¯­æ³•**: åŸºç¡€åŠ è½½è¯­å¥ç»“æ„

âœ… **æ•°æ®æºç±»å‹**:
- Excel: ooxml
- CSV: txt
- JSON/XML: json/XmlSimple
- QVD: qvd

âœ… **æ€§èƒ½ä¼˜åŒ–**:
- ä½¿ç”¨QVD
- ä»…åŠ è½½éœ€è¦çš„åˆ—
- æ•°æ®åº“ç«¯è¿‡æ»¤
- Bufferç¼“å­˜

âœ… **æ•°æ®è´¨é‡**: é¢„è§ˆã€éªŒè¯ã€æ£€æŸ¥

### å…³é”®è¯­æ³•

```qlik
// Excel
LOAD * FROM file.xlsx
(ooxml, embedded labels, table is Sheet1);

// CSV
LOAD * FROM file.csv
(txt, utf8, embedded labels, delimiter is ',');

// SQL
SQL SELECT * FROM table WHERE condition;

// QVD
LOAD * FROM file.qvd (qvd);
STORE table INTO file.qvd (qvd);
```

### æœ€ä½³å®è·µ

1. **å…ˆQVDååˆ†æ**: åŸå§‹æ•°æ®â†’QVDâ†’åº”ç”¨
2. **æ•°æ®éªŒè¯**: æ¯æ¬¡åŠ è½½åæ£€æŸ¥æ•°æ®è´¨é‡
3. **è„šæœ¬æ³¨é‡Š**: æ¸…æ™°çš„æ³¨é‡Šå’Œæ–‡æ¡£
4. **ç‰ˆæœ¬æ§åˆ¶**: é‡è¦è„šæœ¬ä¿å­˜å¤šç‰ˆæœ¬
5. **å¢é‡åŠ è½½**: å¤§æ•°æ®é›†ä½¿ç”¨å¢é‡

### ä¸‹ä¸€ç« é¢„å‘Š

**ç¬¬3ç«  - æ•°æ®æ¨¡å‹è®¾è®¡**,å°†å­¦ä¹ :
- ğŸŒŸ æ˜Ÿå‹æ¨¡å‹è®¾è®¡
- ğŸ”— æ•°æ®å…³è”åŸç†
- ğŸ”„ å¤åˆé”®ä¸åˆæˆé”®
- ğŸš« å¾ªç¯å¼•ç”¨å¤„ç†
- âš¡ æ¨¡å‹ä¼˜åŒ–

---

[â† ä¸Šä¸€ç« ](./1-Qlik_Senseæ¦‚è¿°ä¸ç¯å¢ƒæ­å»º.md) | [è¿”å›ç›®å½•](./README.md) | [ä¸‹ä¸€ç« : æ•°æ®æ¨¡å‹è®¾è®¡ â†’](./3-æ•°æ®æ¨¡å‹è®¾è®¡.md)
