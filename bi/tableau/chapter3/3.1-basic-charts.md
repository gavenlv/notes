# 3.1 基本图表类型

## 图表概述

数据可视化是Tableau的核心功能，通过图表将抽象的数据转换为直观的视觉呈现。本章将详细介绍Tableau中的基本图表类型、创建方法以及适用场景，帮助您选择合适的图表类型并创建有效的数据可视化。

## Tableau中的图表分类

### 按功能分类

1. **比较型图表**：比较不同类别的数据
   - 条形图/柱状图
   - 线形图（用于比较趋势）
   - 热力图

2. **趋势型图表**：显示数据随时间的变化
   - 线形图
   - 面积图

3. **分布型图表**：展示数据分布情况
   - 直方图
   - 箱线图
   - 散点图

4. **占比型图表**：显示部分与整体的关系
   - 饼图
   - 堆叠条形图
   - 树状图

5. **关系型图表**：展示变量之间的关系
   - 散点图
   - 气泡图

## 条形图与柱状图

### 基本概念

条形图和柱状图是最常用的比较型图表，用于比较不同类别的数值大小。在Tableau中，条形图（水平条）和柱状图（垂直条）本质上是同一种图表，只是方向不同。

### 创建步骤

1. **基本柱状图**
   ```markdown
   1. 将维度字段（如类别）拖到"列"功能区
   2. 将度量字段（如销售额）拖到"行"功能区
   3. Tableau会自动创建柱状图
   4. 默认使用SUM聚合，可以在"标记"卡中更改
   ```

2. **转换为条形图**
   ```markdown
   1. 选择"交换"按钮（工具栏中的交换按钮）或
   2. 手动交换"行"和"列"功能区中的字段
   3. 或在"标记"卡中将图表类型更改为"条形图"
   ```

### 应用场景

- **产品销售比较**：比较不同产品的销售额或销量
- **地区业绩分析**：比较不同地区的业绩表现
- **时间对比**：比较不同时间段的数据表现
- **排名分析**：展示类别排名情况

### 最佳实践

1. **排序**
   ```markdown
   1. 按数值大小排序：
      - 右键点击坐标轴
      - 选择"排序"
      - 设置排序规则
   2. 使用排序按钮：
      - 点击工具栏中的排序按钮
      - 选择升序或降序
   ```

2. **标签与格式**
   ```markdown
   1. 添加标签：
      - 将数值字段拖到"标记"卡的"标签"
   2. 调整标签格式：
      - 右键点击标签，选择"格式"
   3. 设置坐标轴格式：
      - 右键点击坐标轴，选择"格式"
   ```

### 高级技巧

1. **分层条形图**
   ```markdown
   1. 添加第二个维度到"颜色"标记
   2. 或将第二个维度拖到第一个维度前面
   3. Tableau会创建分层条形图
   ```

2. **参考线与参考区间**
   ```markdown
   1. 从"分析"窗格拖拽参考线到图表
   2. 设置参考线类型：
      - 常量线
      - 平均值、中位数等统计值
      - 百分位数
   3. 可以添加参考区间突出显示范围
   ```

## 线形图

### 基本概念

线形图用于显示数据随时间或其他连续变量的变化趋势，非常适合分析时间序列数据和趋势预测。

### 创建步骤

1. **基本线形图**
   ```markdown
   1. 将日期/时间字段拖到"列"功能区
   2. 将数值字段拖到"行"功能区
   3. Tableau会自动创建线形图
   4. 默认按年聚合，可以更改日期级别（如月、日）
   ```

2. **多系列线形图**
   ```markdown
   1. 创建基本线形图
   2. 将另一个维度字段拖到"颜色"标记
   3. Tableau会为每个类别创建单独的线条
   ```

### 应用场景

- **销售趋势分析**：分析销售额随时间的变化
- **股票价格走势**：展示股票价格的历史变化
- **网站流量分析**：跟踪网站访问量的变化趋势
- **温度变化监测**：显示温度随时间的变化

### 最佳实践

1. **时间序列配置**
   ```markdown
   1. 选择合适的时间粒度：
      - 点击日期字段下拉箭头
      - 选择详细级别（日、周、月、季、年）
   2. 处理缺失日期：
      - 右键点击日期字段
      - 选择"显示缺失值"
   ```

2. **线条格式设置**
   ```markdown
   1. 在"标记"卡中调整线条：
      - 线条样式（实线、虚线等）
      - 线条粗细
      - 标记类型
   2. 设置颜色：
      - 单色或渐变色
      - 根据数值字段设置颜色
   ```

3. **趋势线**
   ```markdown
   1. 从"分析"窗格拖拽"趋势线"到图表
   2. Tableau会自动添加线性趋势线
   3. 可以配置趋势线模型：
      - 线性、对数、多项式等
      - 置信区间显示
      - 趋势线描述信息
   ```

### 高级技巧

1. **双轴图表**
   ```markdown
   1. 将第二个度量字段拖到"行"功能区
   2. 右键点击第二个度量字段
   3. 选择"双轴"
   4. 可以同步轴范围以进行比较
   5. 调整各图表的格式和标记类型
   ```

2. **移动平均**
   ```markdown
   1. 创建计算字段：
      [移动平均] = WINDOW_AVG(SUM([销售额]), -3, 0)  // 4周移动平均
   2. 使用表计算设置计算方向
   3. 添加到图表中与原数据对比
   ```

## 饼图

### 基本概念

饼图用于显示部分与整体的关系，通过扇形大小表示各类别在总量中的占比。虽然饼图常被过度使用，但在特定场景下仍是有效的可视化工具。

### 创建步骤

1. **基本饼图**
   ```markdown
   1. 将维度字段拖到"标记"卡的"颜色"
   2. 将度量字段拖到"角度"标记
   3. 或使用"智能显示"选择饼图
   4. Tableau会自动创建饼图
   ```

### 应用场景

- **市场份额分析**：显示各品牌的市场份额
- **预算分配**：展示各部门预算占比
- **人口统计**：显示不同群体的人口比例
- **调查结果**：展示选项选择比例

### 最佳实践

1. **类别数量控制**
   ```markdown
   1. 饼图适合展示不超过5-7个类别
   2. 过多类别会导致难以阅读
   3. 考虑将小类别合并为"其他"
   ```

2. **标签与百分比**
   ```markdown
   1. 添加标签：
      - 右键点击饼图，选择"显示标记标签"
   2. 显示百分比：
      - 将度量字段拖到"标签"
      - 设置为快速表计算"百分比总计"
   ```

3. **颜色选择**
   ```markdown
   1. 使用区分度高、对比明显的颜色
   2. 考虑颜色含义和文化差异
   3. 保持色彩一致性（使用一致的配色方案）
   ```

### 高级技巧

1. **环形图（甜甜圈图）**
   ```markdown
   1. 创建基本饼图
   2. 在"标记"卡中设置饼图大小
   3. 添加第二个相同的饼图
   4. 调整第二个饼图的大小并居中
   5. 可以在中心添加汇总信息
   ```

2. **多层饼图**
   ```markdown
   1. 创建第一个饼图（外层）
   2. 创建第二个饼图（内层）
   3. 使用双轴组合两个饼图
   4. 调整大小和位置实现嵌套效果
   ```

## 散点图

### 基本概念

散点图用于展示两个数值变量之间的关系，通过点的位置和分布模式揭示变量间的相关性、集群和异常值。

### 创建步骤

1. **基本散点图**
   ```markdown
   1. 将第一个度量字段拖到"列"功能区（X轴）
   2. 将第二个度量字段拖到"行"功能区（Y轴）
   3. Tableau会自动创建散点图
   4. 可以将维度字段拖到"详细信息"标记区分点
   ```

### 应用场景

- **相关性分析**：研究两个变量之间的关系
- **异常值检测**：识别数据中的异常点
- **集群分析**：发现数据中的自然分组
- **性能对比**：比较不同实体的两项性能指标

### 最佳实践

1. **点密度处理**
   ```markdown
   1. 当点过于密集时：
      - 使用透明度：调整"标记"卡中的"不透明度"
      - 添加抖动：创建随机位置偏移
      - 使用热力图显示密度
   2. 考虑使用筛选器减少数据点
   ```

2. **参考线与趋势线**
   ```markdown
   1. 添加趋势线显示相关性：
      - 从"分析"窗格拖拽"趋势线"
      - 选择线性或非线性模型
      - 显示R平方值和方程
   2. 添加参考线突出重要阈值
   ```

3. **大小与颜色编码**
   ```markdown
   1. 使用第三个度量作为点大小：
      - 将度量拖到"大小"标记
   2. 使用维度编码颜色：
      - 将维度拖到"颜色"标记
      - 创建气泡图效果
   ```

### 高级技巧

1. **LOD表达式应用**
   ```markdown
   1. 添加整体平均值参考：
      [整体平均值] = {FIXED: AVG([度量字段])}
   2. 添加类别平均值：
      [类别平均值] = {FIXED [类别]: AVG([度量字段])}
   3. 使用这些值创建参考线
   ```

2. **动态散点图（动画）**
   ```markdown
   1. 添加时间字段到"页面"功能区
   2. 使用页面播放器创建动画效果
   3. 可以显示数据随时间的变化
   ```

## 直方图

### 基本概念

直方图用于显示数值数据的分布情况，通过条形的高度表示数据在各个区间内的频数分布。

### 创建步骤

1. **基本直方图**
   ```markdown
   1. 选择要分析的数值字段
   2. 右键点击，选择"创建" > "数据桶"
   3. 设置数据桶大小（区间宽度）
   4. 将数据桶字段拖到"列"功能区
   5. 将字段（或记录数）拖到"行"功能区
   6. Tableau会自动创建直方图
   ```

### 应用场景

- **年龄分布**：显示客户年龄分布情况
- **成绩分析**：展示学生成绩分布
- **价格分布**：分析产品价格分布
- **响应时间分析**：分析系统响应时间分布

### 最佳实践

1. **数据桶设置**
   ```markdown
   1. 合理设置数据桶大小：
      - 过小会导致分布不连续
      - 过大会掩盖分布细节
   2. 可以尝试不同的数据桶大小
   3. 使用公式计算建议的数据桶大小
   ```

2. **正态分布曲线**
   ```markdown
   1. 添加参考线显示平均值
   2. 可以添加正态分布曲线：
      - 使用计算字段创建正态分布函数
      - 添加到图表中与直方图比较
   ```

## 热力图

### 基本概念

热力图使用颜色强度表示数值大小，特别适合展示两个类别交叉点的数值情况。

### 创建步骤

1. **基本热力图**
   ```markdown
   1. 将第一个维度字段拖到"列"功能区
   2. 将第二个维度字段拖到"行"功能区
   3. 将度量字段拖到"标记"卡的"颜色"
   4. 可以添加度量到"文本"标记显示数值
   ```

### 应用场景

- **相关性矩阵**：展示变量间相关性
- **时间与类别分析**：显示不同类别在时间上的表现
- **地理与产品分析**：展示不同地区的各类产品表现
- **星期与小时分析**：显示一周中不同小时的业务量

### 最佳实践

1. **颜色选择**
   ```markdown
   1. 使用渐变色表示数值大小
   2. 选择适合色觉障碍人士的配色方案
   3. 考虑颜色含义（如红色表示高值）
   4. 避免使用过多颜色级别
   ```

2. **标签处理**
   ```markdown
   1. 当单元格较多时，可能需要调整标签
   2. 可以使用条件格式隐藏某些标签
   3. 考虑添加工具提示显示详细信息
   ```

## 图表选择指南

### 按分析目标选择

1. **比较**
   - 比较类别：条形图/柱状图
   - 比较趋势：线形图
   - 比较分布：直方图、箱线图

2. **趋势**
   - 时间趋势：线形图
   - 周期性：线形图、热力图
   - 趋势预测：线形图+趋势线

3. **分布**
   - 数值分布：直方图、箱线图
   - 地理分布：地图
   - 多维分布：散点图

4. **占比**
   - 简单占比：饼图
   - 复杂占比：堆叠条形图、树状图

5. **关系**
   - 变量关系：散点图
   - 多维关系：散点图（大小、颜色编码）

### 常见图表误用与替代方案

1. **饼图误用**
   - 误用：类别过多（>7个）的饼图
   - 替代：条形图、树状图

2. **3D图表误用**
   - 误用：使用3D效果但无必要
   - 替代：2D图表（更清晰）

3. **双轴图误用**
   - 误用：度量单位不同或范围差异过大
   - 替代：分离图表或使用组合图

## 实验练习

为了巩固本章所学知识，请完成以下练习：

1. **基础图表创建**
   - 创建销售数据的柱状图
   - 创建月度销售趋势的线形图
   - 创建产品类别占比的饼图

2. **图表比较分析**
   - 使用相同数据创建不同类型图表
   - 比较各图表的优缺点和适用场景

3. **高级图表技巧**
   - 创建包含趋势线的销售趋势图
   - 创建显示相关性的散点图
   - 创建时间与产品的热力图

4. **图表选择实践**
   - 根据给定的分析目标选择合适图表
   - 创建可视化并解释选择原因

通过完成这些练习，您将掌握Tableau中各种基本图表的创建方法和应用场景，为后续学习高级可视化技巧打下基础。