# 1.3 第一个可视化项目

## 项目概述

在本章中，我们将创建一个简单的销售数据分析可视化项目，通过这个过程学习Tableau的基本操作和界面。我们将使用示例数据集，展示如何连接数据、创建基本图表、构建仪表盘，并保存和分享结果。

## 数据准备

### 下载示例数据

我们将使用"Sample - Superstore"数据集，这是Tableau提供的示例数据集，包含零售销售信息。

1. **获取数据**
   - 如果您使用的是Tableau Desktop，这个数据集通常已经包含在安装中
   - 您也可以从Tableau官网下载：https://www.tableau.com/learn/sample-data-sets

2. **数据集结构**
   - **Orders**表：包含订单详情
     - Order ID：订单ID
     - Order Date：订单日期
     - Ship Date：发货日期
     - Ship Mode：发货方式
     - Customer ID：客户ID
     - Customer Name：客户名称
     - Segment：客户细分
     - Country：国家
     - City：城市
     - State：州/省
     - Postal Code：邮政编码
     - Region：地区
     - Product ID：产品ID
     - Category：产品类别
     - Sub-Category：产品子类别
     - Product Name：产品名称
     - Sales：销售额
     - Quantity：数量
     - Discount：折扣
     - Profit：利润

## 创建第一个工作簿

### 启动Tableau并连接数据

1. **启动Tableau Desktop**
   - 双击桌面上的Tableau图标
   - 在欢迎界面，选择"连接到数据"

2. **连接示例数据**
   - 在"连接"窗格中，点击"更多..."
   - 浏览到保存Sample - Superstore数据集的位置
   - 选择Excel文件并点击"打开"
   - 或者直接使用欢迎界面上的"示例工作簿"中的"Sample - Superstore"

### 了解Tableau工作区

1. **数据源页面**
   - 左侧：数据源连接信息
   - 中间：数据预览网格
   - 右侧：数据源设置选项

2. **工作表页面**
   - 左侧：数据窗格（维度和度量）
   - 中间：可视化画布
   - 顶部：工具栏
   - 右侧：标记、筛选器、页面等面板

3. **仪表盘页面**
   - 左侧：仪表盘对象
   - 中间：仪表盘画布
   - 底部：工作表列表

4. **故事页面**
   - 左侧：故事导航
   - 中间：故事画布
   - 底部：仪表盘和工作表列表

## 创建基本可视化

### 柱状图：各产品类别销售额

1. **创建新工作表**
   - 点击底部工作表标签旁的"+"号
   - 双击工作表名称，重命名为"Category Sales"

2. **创建柱状图**
   - 从左侧数据窗格中，将"Category"拖拽到"列"功能区
   - 将"Sales"拖拽到"行"功能区
   - Tableau将自动创建柱状图

3. **自定义图表**
   - 点击"标记"卡中的"颜色"，选择喜欢的配色方案
   - 将"Sales"拖拽到"标记"卡的"标签"上，显示销售额数值
   - 右键点击图表标题，选择"编辑标题"，修改为"各产品类别销售额"

4. **排序**
   - 点击列标题旁的排序按钮，按销售额降序排列

### 折线图：月度销售趋势

1. **创建新工作表**
   - 创建新的工作表，命名为"Monthly Trend"

2. **创建折线图**
   - 将"Order Date"拖拽到"列"功能区
   - 将"Sales"拖拽到"行"功能区
   - Tableau会自动按年份聚合数据

3. **调整时间粒度**
   - 点击"列"功能区中的"YEAR(Order Date)"旁边的下拉箭头
   - 选择"月"（带年份）
   - 现在图表显示月度销售趋势

4. **添加趋势线**
   - 在"分析"窗格中，拖拽"趋势线"到图表上
   - 将显示一条线性趋势线

5. **美化图表**
   - 将"Sales"拖拽到"标记"卡的"标签"
   - 修改图表标题为"月度销售趋势"

### 地图：各州销售额分布

1. **创建新工作表**
   - 创建新的工作表，命名为"Sales by State"

2. **创建地图**
   - 将"State"拖拽到"标记"卡的"详细信息"
   - 将"Sales"拖拽到"标记"卡的"颜色"
   - Tableau会自动创建地图可视化

3. **调整地图显示**
   - 点击"地图"选项卡（顶部工具栏）
   - 选择"地图层"，调整显示选项
   - 可以添加州标签、边界等

4. **优化地图**
   - 将"Sales"拖拽到"标记"卡的"标签"
   - 调整图例位置和标签格式
   - 修改图表标题为"各州销售额分布"

## 创建仪表盘

### 组合工作表

1. **创建新仪表盘**
   - 点击底部标签栏中的"新建仪表盘"图标
   - 将仪表盘命名为"销售分析仪表盘"

2. **添加工作表**
   - 从左侧"仪表盘"窗格中，将"Category Sales"工作表拖拽到画布
   - 拖拽"Monthly Trend"工作表到画布的右侧
   - 拖拽"Sales by State"工作表到画布的下方

3. **调整布局**
   - 调整各个工作表的大小和位置
   - 选择适合的布局方式（如平铺或浮动）

### 添加筛选器和交互

1. **添加全局筛选器**
   - 在仪表盘上，点击"Category Sales"工作表
   - 点击右上角的下拉箭头，选择"筛选器"
   - 将"Category"拖拽到筛选器区域
   - 在筛选器设置中，选择"应用于所有工作表"

2. **设置筛选器交互**
   - 选择筛选器，点击右侧下拉箭头
   - 选择"筛选器" > "应用于工作表" > "选中的工作表"
   - 勾选所有工作表

3. **添加动态标题**
   - 在"仪表盘"窗格中，拖拽"文本框"到仪表盘顶部
   - 输入标题"销售分析仪表盘"
   - 设置文本格式和样式

4. **添加操作**
   - 点击顶部菜单中的"仪表盘" > "操作"
   - 点击"添加操作" > "筛选"
   - 设置操作：
     - 源工作表：选择"Category Sales"
     - 目标工作表：选择"Monthly Trend"和"Sales by State"
     - 操作：选择"选择"
   - 点击"确定"保存

## 保存与发布

### 保存工作簿

1. **本地保存**
   - 点击顶部菜单中的"文件" > "保存"
   - 选择保存位置，输入文件名"Superstore Sales Analysis"
   - 点击"保存"

2. **设置自动保存**
   - 点击"文件" > "工作簿性能设置"
   - 勾选"自动保存"选项

### 发布到Tableau Server/Online

如果您有Tableau Server或Tableau Online账户，可以发布工作簿：

1. **登录到服务器**
   - 点击顶部菜单中的"服务器" > "登录"
   - 输入服务器地址、用户名和密码
   - 点击"登录"

2. **发布工作簿**
   - 点击"服务器" > "发布工作簿"
   - 设置发布选项：
     - 名称：输入工作簿名称
     - 项目：选择或创建项目
     - 权限：设置访问权限
   - 点击"发布"

3. **共享链接**
   - 发布成功后，可以获取分享链接
   - 将链接发送给相关人员查看

## 导出和分享

### 导出为图片或PDF

1. **导出工作表**
   - 选择要导出的工作表
   - 点击"文件" > "导出"
   - 选择导出格式：图片、PDF或数据

2. **导出仪表盘**
   - 选择仪表盘
   - 点击"文件" > "导出"
   - 选择导出为PDF或图片

### 嵌入到其他应用

1. **获取嵌入代码**
   - 在Tableau Server上打开仪表盘
   - 点击"共享"按钮
   - 选择"嵌入代码"
   - 复制嵌入代码

2. **嵌入到网页**
   - 将代码粘贴到HTML页面中
   - 调整嵌入参数（如宽度、高度等）

## 项目总结

通过创建这个简单的销售分析项目，我们学习了：

1. **连接数据**：如何连接Excel数据集并预览数据
2. **基本可视化**：如何创建柱状图、折线图和地图
3. **仪表盘构建**：如何组合多个工作表创建交互式仪表盘
4. **筛选与交互**：如何添加筛选器并设置工作表间的交互
5. **保存与分享**：如何保存、发布和分享工作成果

## 下一步建议

在掌握基本操作后，您可以：

1. **探索更多图表类型**：尝试散点图、饼图、树状图等
2. **学习计算字段**：创建自定义计算以扩展分析能力
3. **深入了解数据准备**：学习如何清洗和转换数据
4. **掌握高级仪表盘设计**：学习布局原则和最佳实践
5. **尝试真实业务场景**：使用实际业务数据进行分析

## 实验练习

为了巩固所学知识，请尝试完成以下练习：

1. **创建客户细分分析**：
   - 按客户细分（Segment）分析销售额和利润
   - 创建不同客户细分的销售占比饼图

2. **分析产品子类别**：
   - 创建产品子类别的销售和利润分析
   - 找出最盈利和最不盈利的产品子类别

3. **区域分析**：
   - 创建区域销售趋势分析
   - 比较不同区域的销售表现

4. **交互式仪表盘**：
   - 创建一个包含多个筛选器的交互式仪表盘
   - 实现用户可以通过区域、类别和时间维度探索数据

通过完成这些练习，您将加深对Tableau基本功能的理解，为后续学习更高级的内容打下坚实基础。