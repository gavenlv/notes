# 1. 技术栈概述与架构设计

## 1.1 整体架构概览

现代数据架构通常采用分层设计，将数据处理职责合理分配到不同的技术组件中。本专题重点讨论以下技术栈：

```
数据源层 (Data Sources)
    ↓
ETL层 (Flink / BigQuery)
    ↓
分析数据库层 (ClickHouse)
    ↓
应用层 (BI工具、报表系统等)
```

## 1.2 技术组件介绍

### 1.2.1 数据源层
- **API数据源**: RESTful API、GraphQL等
- **消息队列**: Kafka、RabbitMQ、Pulsar等
- **直接连接**: 数据库直连、文件系统等

### 1.2.2 ETL层
- **Apache Flink**: 流式数据处理，适合实时ETL
- **Google BigQuery**: 批处理ETL，适合大规模数据分析

### 1.2.3 分析数据库层
- **ClickHouse**: 列式存储，适合OLAP场景

## 1.3 扫描逻辑划分原则

### 1.3.1 核心原则
1. **数据预处理优先在ETL层完成**
2. **复杂计算和聚合在分析数据库层进行**
3. **实时性要求决定处理位置**
4. **数据量大小影响技术选择**

### 1.3.2 具体划分标准

| 扫描逻辑类型 | ETL层处理 | ClickHouse层处理 |
|-------------|-----------|------------------|
| 数据清洗 | ✅ 主要处理 | ❌ 少量处理 |
| 数据转换 | ✅ 格式转换 | ❌ 基本不处理 |
| 数据聚合 | ⚠️ 预聚合 | ✅ 主要聚合 |
| 复杂计算 | ❌ 避免 | ✅ 主要处理 |
| 实时查询 | ⚠️ 流处理 | ✅ 分析查询 |

## 1.4 架构优势

### 1.4.1 性能优势
- **ETL层**: 并行处理，数据预处理优化
- **ClickHouse层**: 列式存储，快速分析查询

### 1.4.2 可扩展性
- 各层独立扩展
- 技术栈灵活选择

### 1.4.3 维护性
- 职责清晰分离
- 故障隔离

## 1.5 典型应用场景

### 1.5.1 实时数据分析
- 使用Flink进行实时ETL
- ClickHouse提供实时查询能力

### 1.5.2 批处理分析
- BigQuery处理大规模批处理
- ClickHouse提供交互式查询

### 1.5.3 混合场景
- Flink处理实时数据流
- BigQuery处理历史数据
- ClickHouse统一查询接口

## 1.6 总结

合理的扫描逻辑划分是构建高效数据架构的关键。ETL层主要负责数据预处理和初步转换，而ClickHouse层专注于分析计算和快速查询。下一章将详细讨论数据源接入策略。