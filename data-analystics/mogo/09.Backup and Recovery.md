## 1.Backup
### 1.1 lock file sync
```bash
mongosh

db.fsyncLock();

exit
```
### 1.2. Create logic volumn
The following code shows how to create a snapshot volume. The snapshot volume has a maximum size of 100 megabytes, and is named mdb-snapshot and backed by the MongoDB data store volume.
```bash
sudo lvcreate --size 100M --snapshot --name mdb-snapshot /dev/vg0/mdb;
```
### 1.3. Unlock db
```bash
mongosh

db.fsyncUnlock();
exit
```
### 1.4. copy files
```bash
sudo dd status=progress if=/dev/vg0/mdb-snapshot | gzip > mdb-snapshot.gz
```

## 2.Restore
### 2.1 create a new logical volume named mdb-new
```bash
sudo lvcreate --size 1G --name mdb-new vg0;
```
### 2.2 Next, extract the snapshot and write it to the new logical volume:
```bash
gzip -d -c mdb-snapshot.gz | sudo dd status=progress of=/dev/vg0/mdb-new
```
### 2.3 Then, stop the MongoDB service before mounting to the source directory:
```bash
sudo systemctl stop -l mongod; sudo systemctl status -l mongod;
```
### 2.4 Delete any existing MongoDB data files. This is for demonstration purposes to show how the entire deployment is restored.
```bash
sudo rm -r /var/lib/mongodb/*
```
### 2.5  unmount the MongoDB deployment so that you can mount the newly restored logical volume in its place
```bash
sudo umount /var/lib/mongodb
```
### 2.6 Mount the restored logical volume on the MongoDB database directory:
```bash
sudo mount /dev/vg0/mdb-new /var/lib/mongodb
```
### 2.7 Finally, start the MongoDB service and connect to the deployment. Run show dbs to confirm that the databases have been restored
```bash
sudo systemctl start -l mongod; sudo systemctl status -l mongod;
mongosh
show dbs
```









