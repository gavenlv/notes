version: '3.8'

services:
  fe:
    image: apache/doris:2.1.0-fe-x86_64
    container_name: doris-fe
    hostname: fe
    environment:
      - FE_SERVERS=fe1:127.0.0.1:9010
      - FE_ID=1
    ports:
      - "8030:8030"  # HTTP UI端口
      - "9030:9030"  # MySQL协议端口
      - "9010:9010"  # FE内部通信端口
    volumes:
      - fe_log:/opt/apache-doris/fe/log
      - fe_meta:/opt/apache-doris/fe/doris-meta
    networks:
      - doris-net
    command: /opt/apache-doris/fe/bin/start_fe.sh --daemon

  be:
    image: apache/doris:2.1.0-be-x86_64
    container_name: doris-be
    hostname: be
    environment:
      - FE_SERVERS=fe1:127.0.0.1:9010
      - BE_ADDR=127.0.0.1:9050
    ports:
      - "8040:8040"  # BE HTTP端口
      - "9000:9000"  # BE内部通信端口
      - "9050:9050"  # BE心跳端口
    volumes:
      - be_log:/opt/apache-doris/be/log
      - be_storage:/opt/apache-doris/be/storage
    networks:
      - doris-net
    depends_on:
      - fe
    command: /opt/apache-doris/be/bin/start_be.sh --daemon

volumes:
  fe_log:
  fe_meta:
  be_log:
  be_storage:

networks:
  doris-net:
    driver: bridge