# Kerberos Configuration for Iceberg Production Environment
# =======================================================

[libdefaults]
    # Default realm
    default_realm = PROD.EXAMPLE.COM
    
    # Ticket lifetime settings
    ticket_lifetime = 24h
    renew_lifetime = 7d
    forwardable = true
    proxiable = true
    
    # Encryption types
    default_tkt_enctypes = aes256-cts-hmac-sha1-96 rc4-hmac
    default_tgs_enctypes = aes256-cts-hmac-sha1-96 rc4-hmac
    permitted_enctypes = aes256-cts-hmac-sha1-96 rc4-hmac
    
    # Clock skew tolerance
    clockskew = 300
    
    # DNS lookup settings
    dns_lookup_kdc = false
    dns_lookup_realm = false
    
    # UDP preferences
    udp_preference_limit = 1

[realms]
    PROD.EXAMPLE.COM = {
        # KDC servers
        kdc = kdc1.prod.example.com:88
        kdc = kdc2.prod.example.com:88
        
        # Admin server
        admin_server = kdc1.prod.example.com:749
        
        # Default domain
        default_domain = prod.example.com
        
        # Supported encryption types
        supported_enctypes = aes256-cts-hmac-sha1-96:normal rc4-hmac:normal
        
        # Database module
        database_module = ldap_db2
    }

[domain_realm]
    .prod.example.com = PROD.EXAMPLE.COM
    prod.example.com = PROD.EXAMPLE.COM
    
    # Map internal domains
    .internal.prod.example.com = PROD.EXAMPLE.COM
    internal.prod.example.com = PROD.EXAMPLE.COM

[logging]
    kdc = FILE:/var/log/krb5/kdc.log
    admin_server = FILE:/var/log/krb5/kadmin.log
    default = FILE:/var/log/krb5/krb5lib.log

[appdefaults]
    pam = {
        debug = false
        ticket_lifetime = 36000
        renew_lifetime = 36000
        forwardable = true
        krb4_convert = false
    }
    
    # SSH configuration
    ssh = {
        forward_agent = false
        forward_x11 = false
    }

[capaths]
    PROD.EXAMPLE.COM = {
        OTHER.REALM.COM = .
    }

[dbmodules]
    ldap_db2 = {
        db_library = kldap
        ldap_kerberos_container_dn = cn=krbContainer,dc=prod,dc=example,dc=com
        ldap_kdc_dn = cn=admin,dc=prod,dc=example,dc=com
        ldap_kadmind_dn = cn=admin,dc=prod,dc=example,dc=com
        ldap_service_password_file = /etc/krb5kdc/service.keyfile
        ldap_servers = ldaps://ldap.prod.example.com
        ldap_conns_per_server = 5
    }