<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScriptå¼‚æ­¥ç¼–ç¨‹ç¤ºä¾‹</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 20px;
        }
        .example-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 25px;
            border-left: 3px solid #3498db;
        }
        .result-box {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            font-family: monospace;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:active {
            transform: translateY(1px);
        }
        .code-block {
            background-color: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
            font-family: monospace;
            overflow-x: auto;
            margin-bottom: 20px;
            white-space: pre;
        }
        .timeline {
            position: relative;
            margin: 20px 0;
            padding-left: 30px;
        }
        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #3498db;
        }
        .timeline-item {
            position: relative;
            padding-bottom: 20px;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -30px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: #e74c3c;
            border: 2px solid #3498db;
        }
        .highlight {
            background-color: #ffffcc;
            padding: 2px 5px;
            border-radius: 3px;
            font-weight: bold;
        }
        .step {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 3px solid #2ecc71;
        }
        .warning {
            background-color: #fdf2e9;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #e67e22;
            margin: 15px 0;
        }
        .success {
            background-color: #e8f8f5;
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #2ecc71;
            margin: 15px 0;
        }
        .delay-input {
            width: 100px;
            padding: 8px;
            margin: 0 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .progress-container {
            width: 100%;
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 15px 0;
        }
        .progress-bar {
            height: 100%;
            background-color: #3498db;
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>JavaScriptå¼‚æ­¥ç¼–ç¨‹</h1>
        <p>JavaScriptæ˜¯ä¸€é—¨å•çº¿ç¨‹è¯­è¨€ï¼Œä½†é€šè¿‡å¼‚æ­¥ç¼–ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¤„ç†éœ€è¦ç­‰å¾…çš„æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ç­‰ï¼‰è€Œä¸é˜»å¡ä¸»çº¿ç¨‹ã€‚æœ¬é¡µé¢æ¼”ç¤ºäº†JavaScriptä¸­å¼‚æ­¥ç¼–ç¨‹çš„å„ç§æ–¹å¼ã€‚</p>
        
        <h2>1. å›è°ƒå‡½æ•°ï¼ˆCallbacksï¼‰</h2>
        <div class="example-section">
            <p>å›è°ƒå‡½æ•°æ˜¯JavaScriptä¸­å¤„ç†å¼‚æ­¥æ“ä½œçš„æœ€åŸºæœ¬æ–¹å¼ã€‚å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶åœ¨å¼‚æ­¥æ“ä½œå®Œæˆåè¢«è°ƒç”¨ã€‚</p>
            
            <div class="code-block">// å›è°ƒå‡½æ•°ç¤ºä¾‹
function fetchData(callback) {
    setTimeout(function() {
        const data = 'è¿™æ˜¯è·å–çš„æ•°æ®';
        callback(null, data); // æˆåŠŸæ—¶è°ƒç”¨å›è°ƒï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºnullè¡¨ç¤ºæ— é”™è¯¯
    }, 1000);
}

// è°ƒç”¨å¸¦æœ‰å›è°ƒçš„å‡½æ•°
fetchData(function(error, result) {
    if (error) {
        console.error('å‘ç”Ÿé”™è¯¯:', error);
        return;
    }
    console.log('æˆåŠŸè·å–æ•°æ®:', result);
});</div>
            
            <button onclick="runCallbackDemo()">è¿è¡Œå›è°ƒå‡½æ•°æ¼”ç¤º</button>
            <div id="callbackResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
        
        <h2>2. PromiseåŸºç¡€</h2>
        <div class="example-section">
            <p>Promiseæ˜¯ES6å¼•å…¥çš„ç”¨äºå¤„ç†å¼‚æ­¥æ“ä½œçš„å¯¹è±¡ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„æœ€ç»ˆå®Œæˆï¼ˆæˆ–å¤±è´¥ï¼‰åŠå…¶ç»“æœå€¼ã€‚</p>
            
            <div class="code-block">// åˆ›å»ºPromise
const myPromise = new Promise((resolve, reject) => {
    // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
    setTimeout(() => {
        const success = true;
        if (success) {
            resolve('æ“ä½œæˆåŠŸå®Œæˆï¼'); // æˆåŠŸæ—¶è°ƒç”¨resolve
        } else {
            reject(new Error('æ“ä½œå¤±è´¥ï¼')); // å¤±è´¥æ—¶è°ƒç”¨reject
        }
    }, 1000);
});

// ä½¿ç”¨Promise
myPromise
    .then(result => {
        console.log('æˆåŠŸ:', result);
        return 'å¤„ç†åçš„ç»“æœ';
    })
    .then(processedResult => {
        console.log('å¤„ç†ç»“æœ:', processedResult);
    })
    .catch(error => {
        console.error('é”™è¯¯:', error);
    })
    .finally(() => {
        console.log('æ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ');
    });</div>
            
            <button onclick="runPromiseDemo()">è¿è¡ŒPromiseæ¼”ç¤º</button>
            <div id="promiseResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
        
        <h2>3. Promiseç»„åˆæ–¹æ³•</h2>
        <div class="example-section">
            <h3>3.1 Promise.all()</h3>
            <p>ç­‰å¾…æ‰€æœ‰Promiseéƒ½å®Œæˆï¼Œå¦‚æœæœ‰ä¸€ä¸ªå¤±è´¥ï¼Œåˆ™æ•´ä½“å¤±è´¥ã€‚</p>
            
            <div class="code-block">// Promise.allç¤ºä¾‹
const promise1 = Promise.resolve(3);
const promise2 = 42;
const promise3 = new Promise((resolve, reject) => {
    setTimeout(resolve, 1000, 'foo');
});

Promise.all([promise1, promise2, promise3])
    .then(values => {
        console.log(values); // [3, 42, "foo"]
    })
    .catch(error => {
        console.error('æœ‰Promiseå¤±è´¥:', error);
    });</div>
            
            <h3>3.2 Promise.race()</h3>
            <p>ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆçš„Promiseï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥ã€‚</p>
            
            <div class="code-block">// Promise.raceç¤ºä¾‹
const promise1 = new Promise((resolve, reject) => {
    setTimeout(resolve, 500, 'ä¸€ä¸ªç»“æœ');
});

const promise2 = new Promise((resolve, reject) => {
    setTimeout(resolve, 100, 'å¦ä¸€ä¸ªç»“æœ');
});

Promise.race([promise1, promise2])
    .then(value => {
        console.log(value); // "å¦ä¸€ä¸ªç»“æœ"ï¼Œå› ä¸ºå®ƒå…ˆå®Œæˆ
    });</div>
            
            <h3>3.3 Promise.allSettled()</h3>
            <p>ç­‰å¾…æ‰€æœ‰Promiseéƒ½å®Œæˆï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œè¿”å›æ¯ä¸ªPromiseçš„ç»“æœã€‚</p>
            
            <div class="code-block">// Promise.allSettledç¤ºä¾‹
const promise1 = Promise.resolve(3);
const promise2 = new Promise((resolve, reject) => {
    setTimeout(reject, 1000, 'å¤±è´¥');
});

Promise.allSettled([promise1, promise2])
    .then(results => {
        results.forEach(result => {
            if (result.status === 'fulfilled') {
                console.log('æˆåŠŸå€¼:', result.value);
            } else {
                console.log('é”™è¯¯åŸå› :', result.reason);
            }
        });
    });</div>
            
            <button onclick="runPromiseCombineDemo()">è¿è¡ŒPromiseç»„åˆæ¼”ç¤º</button>
            <div id="promiseCombineResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
        
        <h2>4. async/await</h2>
        <div class="example-section">
            <p>async/awaitæ˜¯ES2017å¼•å…¥çš„è¯­æ³•ç³–ï¼ŒåŸºäºPromiseæ„å»ºï¼Œä½¿å¼‚æ­¥ä»£ç çœ‹èµ·æ¥æ›´åƒåŒæ­¥ä»£ç ã€‚</p>
            
            <div class="code-block">// asyncå‡½æ•°
async function fetchData() {
    try {
        // awaitç­‰å¾…Promiseå®Œæˆ
        const result = await new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve('å¼‚æ­¥æ“ä½œå®Œæˆ');
            }, 1000);
        });
        
        console.log(result); // è¾“å‡º: å¼‚æ­¥æ“ä½œå®Œæˆ
        return result;
    } catch (error) {
        console.error('å‘ç”Ÿé”™è¯¯:', error);
    }
}

// è°ƒç”¨asyncå‡½æ•°
fetchData()
    .then(result => {
        console.log('asyncå‡½æ•°è¿”å›ç»“æœ:', result);
    })
    .catch(error => {
        console.error('asyncå‡½æ•°å‡ºé”™:', error);
    });</div>
            
            <button onclick="runAsyncAwaitDemo()">è¿è¡Œasync/awaitæ¼”ç¤º</button>
            <div id="asyncAwaitResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
        
        <h2>5. å®é™…åº”ç”¨åœºæ™¯</h2>
        <div class="example-section">
            <h3>5.1 é¡ºåºæ‰§è¡Œå¼‚æ­¥æ“ä½œ</h3>
            <p>æ¼”ç¤ºå¦‚ä½•æŒ‰é¡ºåºæ‰§è¡Œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼Œæ¯ä¸ªæ“ä½œä¾èµ–å‰ä¸€ä¸ªæ“ä½œçš„ç»“æœã€‚</p>
            
            <div class="timeline">
                <div class="timeline-item">
                    <strong>æ­¥éª¤1:</strong> è·å–ç”¨æˆ·ä¿¡æ¯
                </div>
                <div class="timeline-item">
                    <strong>æ­¥éª¤2:</strong> æ ¹æ®ç”¨æˆ·IDè·å–è®¢å•
                </div>
                <div class="timeline-item">
                    <strong>æ­¥éª¤3:</strong> æ ¹æ®è®¢å•è·å–å•†å“è¯¦æƒ…
                </div>
            </div>
            
            <button onclick="runSequentialDemo()">è¿è¡Œé¡ºåºå¼‚æ­¥æ“ä½œ</button>
            <div id="sequentialResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            
            <h3>5.2 å¹¶è¡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œ</h3>
            <p>æ¼”ç¤ºå¦‚ä½•å¹¶è¡Œæ‰§è¡Œå¤šä¸ªç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œä»¥æé«˜æ•ˆç‡ã€‚</p>
            
            <div class="step">
                <strong>åŒæ—¶åŠ è½½:</strong>
                <ul>
                    <li>åŠ è½½ç”¨æˆ·æ•°æ®</li>
                    <li>åŠ è½½äº§å“åˆ—è¡¨</li>
                    <li>åŠ è½½æ¨èå†…å®¹</li>
                </ul>
            </div>
            
            <button onclick="runParallelDemo()">è¿è¡Œå¹¶è¡Œå¼‚æ­¥æ“ä½œ</button>
            <div id="parallelResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            
            <h3>5.3 é”™è¯¯å¤„ç†ç­–ç•¥</h3>
            <p>æ¼”ç¤ºå¼‚æ­¥æ“ä½œä¸­çš„é”™è¯¯å¤„ç†æœ€ä½³å®è·µã€‚</p>
            
            <div class="code-block">// å¼‚æ­¥é”™è¯¯å¤„ç†
async function robustOperation() {
    try {
        // æ“ä½œ1
        const result1 = await operation1();
        console.log('æ“ä½œ1å®Œæˆ:', result1);
        
        try {
            // æ“ä½œ2ï¼Œå¦‚æœå¤±è´¥ä¸å½±å“æ•´ä½“æµç¨‹
            const result2 = await operation2();
            console.log('æ“ä½œ2å®Œæˆ:', result2);
        } catch (error) {
            console.warn('æ“ä½œ2å¤±è´¥ï¼Œä½†ç»§ç»­æ‰§è¡Œ:', error.message);
        }
        
        // æ“ä½œ3
        const result3 = await operation3();
        return result3;
    } catch (error) {
        console.error('ä¸»è¦æµç¨‹é”™è¯¯:', error);
        // å¯èƒ½çš„é™çº§å¤„ç†æˆ–é»˜è®¤å€¼
        return 'é»˜è®¤ç»“æœ';
    } finally {
        // æ¸…ç†å·¥ä½œï¼Œæ— è®ºæˆåŠŸå¤±è´¥éƒ½ä¼šæ‰§è¡Œ
        console.log('æ¸…ç†èµ„æº');
    }
}</div>
            
            <button onclick="runErrorHandlingDemo()">è¿è¡Œé”™è¯¯å¤„ç†æ¼”ç¤º</button>
            <div id="errorHandlingResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
        
        <h2>6. å®é™…å¼‚æ­¥åœºæ™¯æ¨¡æ‹Ÿ</h2>
        <div class="example-section">
            <h3>6.1 æ¨¡æ‹ŸAPIè¯·æ±‚</h3>
            <p>æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚åœºæ™¯ï¼ŒåŒ…æ‹¬æˆåŠŸå’Œå¤±è´¥æƒ…å†µã€‚</p>
            
            <div class="progress-container">
                <div id="apiProgressBar" class="progress-bar"></div>
            </div>
            
            <button onclick="simulateApiRequest()">æ¨¡æ‹ŸAPIè¯·æ±‚</button>
            <div id="apiRequestResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            
            <h3>6.2 å–æ¶ˆå¼‚æ­¥æ“ä½œ</h3>
            <p>æ¼”ç¤ºå¦‚ä½•å–æ¶ˆæ­£åœ¨è¿›è¡Œçš„å¼‚æ­¥æ“ä½œã€‚</p>
            
            <div class="code-block">// ä½¿ç”¨AbortControllerå–æ¶ˆå¼‚æ­¥æ“ä½œ
async function cancellableOperation(signal) {
    return new Promise((resolve, reject) => {
        // æ£€æŸ¥ä¿¡å·æ˜¯å¦å·²ç»è¢«ä¸­æ­¢
        if (signal.aborted) {
            return reject(new Error('æ“ä½œå·²å–æ¶ˆ'));
        }
        
        // è®¾ç½®è¶…æ—¶
        const timeoutId = setTimeout(() => {
            resolve('æ“ä½œå®Œæˆ');
        }, 3000);
        
        // ç›‘å¬ä¸­æ­¢ä¿¡å·
        signal.addEventListener('abort', () => {
            clearTimeout(timeoutId);
            reject(new Error('æ“ä½œè¢«å–æ¶ˆ'));
        });
    });
}

// ä½¿ç”¨æ–¹æ³•
const controller = new AbortController();
const { signal } = controller;

cancellableOperation(signal)
    .then(result => console.log(result))
    .catch(error => console.error(error));

// å–æ¶ˆæ“ä½œ
// controller.abort();</div>
            
            <button onclick="startCancellableOperation()">å¼€å§‹å¯å–æ¶ˆçš„æ“ä½œ</button>
            <button onclick="cancelOperation()">å–æ¶ˆæ“ä½œ</button>
            <div id="cancelResult" class="result-box">ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            
            <h3>6.3 é˜²æŠ–ä¸èŠ‚æµ</h3>
            <p>æ¼”ç¤ºå¦‚ä½•å¤„ç†é¢‘ç¹è§¦å‘çš„å¼‚æ­¥æ“ä½œï¼Œå¦‚ç”¨æˆ·è¾“å…¥ã€çª—å£è°ƒæ•´ç­‰ã€‚</p>
            
            <div class="code-block">// é˜²æŠ–å‡½æ•°
function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
}

// èŠ‚æµå‡½æ•°
function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            func.apply(this, args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}</div>
            
            <div class="demo-area">
                <input type="text" id="debounceInput" placeholder="è¾“å…¥æµ‹è¯•é˜²æŠ–..." style="width: 300px; padding: 8px;">
                <div id="debounceResult" class="result-box" style="margin-top: 10px;">é˜²æŠ–ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
            </div>
        </div>
        
        <h2>7. å¼‚æ­¥ç¼–ç¨‹æœ€ä½³å®è·µ</h2>
        <div class="example-section">
            <div class="success">
                <h3>âœ… æ¨èåšæ³•</h3>
                <ul>
                    <li>ä½¿ç”¨ <strong>async/await</strong> è¯­æ³•ä½¿ä»£ç æ›´æ˜“è¯»</li>
                    <li>å§‹ç»ˆç”¨ <strong>try/catch</strong> æ•è·å¼‚æ­¥æ“ä½œä¸­çš„é”™è¯¯</li>
                    <li>ç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œä½¿ç”¨ <strong>Promise.all()</strong> å¹¶è¡Œæ‰§è¡Œ</li>
                    <li>ä¸ºé•¿æ—¶é—´è¿è¡Œçš„æ“ä½œæä¾› <strong>å–æ¶ˆæœºåˆ¶</strong></li>
                    <li>ä½¿ç”¨ <strong>Promise.allSettled()</strong> å¤„ç†å…è®¸éƒ¨åˆ†å¤±è´¥çš„åœºæ™¯</li>
                </ul>
            </div>
            
            <div class="warning">
                <h3>âŒ é¿å…åšæ³•</h3>
                <ul>
                    <li>é¿å…å›è°ƒåœ°ç‹±ï¼ˆCallback Hellï¼‰</li>
                    <li>ä¸è¦åœ¨æ²¡æœ‰é”™è¯¯å¤„ç†çš„æƒ…å†µä¸‹ä½¿ç”¨Promiseæˆ–async/await</li>
                    <li>é¿å…ä¸å¿…è¦çš„ä¸²è¡Œæ‰§è¡Œç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œ</li>
                    <li>ä¸è¦å¿½ç•¥Promiseçš„è¿”å›å€¼ï¼ˆæœªä½¿ç”¨çš„Promiseï¼‰</li>
                    <li>é¿å…åœ¨å¾ªç¯ä¸­ä½¿ç”¨awaitè€Œä¸ä½¿ç”¨Promise.all</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // è¾…åŠ©å‡½æ•°
        function displayResult(elementId, content) {
            const element = document.getElementById(elementId);
            element.textContent = content;
        }
        
        function appendResult(elementId, content) {
            const element = document.getElementById(elementId);
            element.textContent += '\n' + content;
        }
        
        // 1. å›è°ƒå‡½æ•°æ¼”ç¤º
        function runCallbackDemo() {
            displayResult('callbackResult', 'å¼€å§‹å›è°ƒå‡½æ•°æ¼”ç¤º...');
            
            // æ¨¡æ‹Ÿå¼‚æ­¥è·å–ç”¨æˆ·æ•°æ®
            function getUserData(userId, callback) {
                setTimeout(() => {
                    appendResult('callbackResult', `è·å–ç”¨æˆ· ${userId} æ•°æ®ä¸­...`);
                    const userData = {
                        id: userId,
                        name: 'å¼ ä¸‰',
                        age: 30
                    };
                    callback(null, userData);
                }, 1000);
            }
            
            // æ¨¡æ‹Ÿå¼‚æ­¥è·å–ç”¨æˆ·è®¢å•
            function getUserOrders(userId, callback) {
                setTimeout(() => {
                    appendResult('callbackResult', `è·å–ç”¨æˆ· ${userId} çš„è®¢å•ä¸­...`);
                    const orders = [
                        { id: 1, product: 'æ‰‹æœº' },
                        { id: 2, product: 'ç”µè„‘' }
                    ];
                    callback(null, orders);
                }, 1000);
            }
            
            // æ¨¡æ‹Ÿå›è°ƒåœ°ç‹±
            getUserData(1, function(error, user) {
                if (error) {
                    appendResult('callbackResult', `é”™è¯¯: ${error.message}`);
                    return;
                }
                
                appendResult('callbackResult', `æˆåŠŸè·å–ç”¨æˆ·: ${JSON.stringify(user)}`);
                
                getUserOrders(user.id, function(error, orders) {
                    if (error) {
                        appendResult('callbackResult', `é”™è¯¯: ${error.message}`);
                        return;
                    }
                    
                    appendResult('callbackResult', `æˆåŠŸè·å–è®¢å•: ${JSON.stringify(orders)}`);
                    appendResult('callbackResult', 'å›è°ƒå‡½æ•°æ¼”ç¤ºå®Œæˆ!');
                });
            });
        }
        
        // 2. PromiseåŸºç¡€æ¼”ç¤º
        function runPromiseDemo() {
            displayResult('promiseResult', 'å¼€å§‹Promiseæ¼”ç¤º...');
            
            // åˆ›å»ºä¸€ä¸ªè¿”å›Promiseçš„å‡½æ•°
            function fetchData(success = true) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        appendResult('promiseResult', 'å¼‚æ­¥æ“ä½œå®Œæˆ');
                        if (success) {
                            resolve('æ“ä½œæˆåŠŸï¼');
                        } else {
                            reject(new Error('æ“ä½œå¤±è´¥ï¼'));
                        }
                    }, 1000);
                });
            }
            
            // æˆåŠŸçš„Promise
            appendResult('promiseResult', 'åˆ›å»ºæˆåŠŸçš„Promise...');
            fetchData(true)
                .then(result => {
                    appendResult('promiseResult', `æˆåŠŸ: ${result}`);
                    return 'å¤„ç†åçš„' + result;
                })
                .then(processed => {
                    appendResult('promiseResult', `å¤„ç†ç»“æœ: ${processed}`);
                })
                .catch(error => {
                    appendResult('promiseResult', `æ•è·åˆ°é”™è¯¯: ${error.message}`);
                })
                .finally(() => {
                    appendResult('promiseResult', 'finallyå—æ‰§è¡Œ');
                    
                    // å¤±è´¥çš„Promise
                    appendResult('promiseResult', '\nåˆ›å»ºå¤±è´¥çš„Promise...');
                    fetchData(false)
                        .then(result => {
                            appendResult('promiseResult', `æˆåŠŸ: ${result}`);
                        })
                        .catch(error => {
                            appendResult('promiseResult', `æ•è·åˆ°é”™è¯¯: ${error.message}`);
                        })
                        .finally(() => {
                            appendResult('promiseResult', 'finallyå—æ‰§è¡Œ');
                            appendResult('promiseResult', 'Promiseæ¼”ç¤ºå®Œæˆ!');
                        });
                });
        }
        
        // 3. Promiseç»„åˆæ–¹æ³•æ¼”ç¤º
        function runPromiseCombineDemo() {
            displayResult('promiseCombineResult', 'å¼€å§‹Promiseç»„åˆæ¼”ç¤º...');
            
            // åˆ›å»ºå»¶è¿ŸPromise
            function delay(ms, value) {
                return new Promise(resolve => setTimeout(() => resolve(value), ms));
            }
            
            // åˆ›å»ºå¤±è´¥çš„Promise
            function fail(ms, errorMessage) {
                return new Promise((_, reject) => setTimeout(() => reject(new Error(errorMessage)), ms));
            }
            
            // Promise.allæ¼”ç¤º
            appendResult('promiseCombineResult', '\n=== Promise.allæ¼”ç¤º ===');
            Promise.all([
                delay(500, 'ç»“æœ1'),
                delay(1000, 'ç»“æœ2'),
                delay(800, 'ç»“æœ3')
            ])
            .then(results => {
                appendResult('promiseCombineResult', `Promise.allæˆåŠŸ: ${JSON.stringify(results)}`);
            })
            .catch(error => {
                appendResult('promiseCombineResult', `Promise.allå¤±è´¥: ${error.message}`);
            })
            .finally(() => {
                // Promise.allåŒ…å«å¤±è´¥çš„æƒ…å†µ
                Promise.all([
                    delay(500, 'ç»“æœA'),
                    fail(800, 'æ•…æ„å¤±è´¥'),
                    delay(1000, 'ç»“æœB')
                ])
                .then(results => {
                    appendResult('promiseCombineResult', `Promise.allæˆåŠŸ: ${JSON.stringify(results)}`);
                })
                .catch(error => {
                    appendResult('promiseCombineResult', `Promise.allå¤±è´¥: ${error.message}`);
                    
                    // Promise.raceæ¼”ç¤º
                    appendResult('promiseCombineResult', '\n=== Promise.raceæ¼”ç¤º ===');
                    Promise.race([
                        delay(1000, 'æ…¢ç»“æœ'),
                        delay(500, 'å¿«ç»“æœ'),
                        delay(800, 'ä¸­ç»“æœ')
                    ])
                    .then(result => {
                        appendResult('promiseCombineResult', `Promise.raceç»“æœ: ${result}`);
                        
                        // Promise.allSettledæ¼”ç¤º
                        appendResult('promiseCombineResult', '\n=== Promise.allSettledæ¼”ç¤º ===');
                        Promise.allSettled([
                            delay(500, 'æˆåŠŸ1'),
                            fail(800, 'å¤±è´¥1'),
                            delay(1000, 'æˆåŠŸ2')
                        ])
                        .then(results => {
                            appendResult('promiseCombineResult', 'Promise.allSettledç»“æœ:');
                            results.forEach((result, index) => {
                                if (result.status === 'fulfilled') {
                                    appendResult('promiseCombineResult', `  Promise ${index + 1}: æˆåŠŸ - ${result.value}`);
                                } else {
                                    appendResult('promiseCombineResult', `  Promise ${index + 1}: å¤±è´¥ - ${result.reason.message}`);
                                }
                            });
                            appendResult('promiseCombineResult', '\nPromiseç»„åˆæ¼”ç¤ºå®Œæˆ!');
                        });
                    });
                });
            });
        }
        
        // 4. async/awaitæ¼”ç¤º
        function runAsyncAwaitDemo() {
            displayResult('asyncAwaitResult', 'å¼€å§‹async/awaitæ¼”ç¤º...');
            
            // æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ
            function fetchUser() {
                return new Promise(resolve => setTimeout(() => resolve({ id: 1, name: 'æå››' }), 800));
            }
            
            function fetchPosts(userId) {
                return new Promise(resolve => setTimeout(() => {
                    resolve([
                        { id: 1, title: 'ç¬¬ä¸€ç¯‡æ–‡ç« ', userId },
                        { id: 2, title: 'ç¬¬äºŒç¯‡æ–‡ç« ', userId }
                    ]);
                }, 1200));
            }
            
            function fetchComments(postId) {
                return new Promise(resolve => setTimeout(() => {
                    resolve([
                        { id: 1, content: 'è¯„è®º1', postId },
                        { id: 2, content: 'è¯„è®º2', postId }
                    ]);
                }, 600));
            }
            
            // ä½¿ç”¨async/awaitçš„å‡½æ•°
            async function getUserWithComments() {
                try {
                    // é¡ºåºè·å–æ•°æ®
                    appendResult('asyncAwaitResult', 'è·å–ç”¨æˆ·ä¿¡æ¯...');
                    const user = await fetchUser();
                    appendResult('asyncAwaitResult', `è·å–åˆ°ç”¨æˆ·: ${JSON.stringify(user)}`);
                    
                    appendResult('asyncAwaitResult', 'è·å–ç”¨æˆ·æ–‡ç« ...');
                    const posts = await fetchPosts(user.id);
                    appendResult('asyncAwaitResult', `è·å–åˆ°æ–‡ç« : ${JSON.stringify(posts)}`);
                    
                    appendResult('asyncAwaitResult', 'è·å–ç¬¬ä¸€ç¯‡æ–‡ç« è¯„è®º...');
                    const comments = await fetchComments(posts[0].id);
                    appendResult('asyncAwaitResult', `è·å–åˆ°è¯„è®º: ${JSON.stringify(comments)}`);
                    
                    // è¿”å›ç»„åˆç»“æœ
                    const result = {
                        user,
                        posts,
                        comments
                    };
                    
                    return result;
                } catch (error) {
                    appendResult('asyncAwaitResult', `å‘ç”Ÿé”™è¯¯: ${error.message}`);
                    throw error;
                }
            }
            
            // è°ƒç”¨asyncå‡½æ•°
            getUserWithComments()
                .then(result => {
                    appendResult('asyncAwaitResult', '\nasyncå‡½æ•°æˆåŠŸå®Œæˆ!');
                    appendResult('asyncAwaitResult', 'æœ€ç»ˆç»“æœ:');
                    appendResult('asyncAwaitResult', `- ç”¨æˆ·: ${result.user.name}`);
                    appendResult('asyncAwaitResult', `- æ–‡ç« æ•°: ${result.posts.length}`);
                    appendResult('asyncAwaitResult', `- è¯„è®ºæ•°: ${result.comments.length}`);
                })
                .catch(error => {
                    appendResult('asyncAwaitResult', `æ•è·åˆ°é”™è¯¯: ${error.message}`);
                });
        }
        
        // 5. é¡ºåºæ‰§è¡Œå¼‚æ­¥æ“ä½œæ¼”ç¤º
        function runSequentialDemo() {
            displayResult('sequentialResult', 'å¼€å§‹é¡ºåºå¼‚æ­¥æ“ä½œæ¼”ç¤º...');
            
            // æ¨¡æ‹Ÿä¾èµ–çš„APIè°ƒç”¨
            async function getUserInfo(userId) {
                await new Promise(resolve => setTimeout(resolve, 1000));
                appendResult('sequentialResult', `âœ… è·å–ç”¨æˆ·ä¿¡æ¯: ç”¨æˆ·${userId}`);
                return { userId, name: 'ç”¨æˆ·' + userId, email: 'user' + userId + '@example.com' };
            }
            
            async function getOrders(userId) {
                await new Promise(resolve => setTimeout(resolve, 800));
                appendResult('sequentialResult', `âœ… è·å–ç”¨æˆ·è®¢å•: ç”¨æˆ·${userId}çš„è®¢å•`);
                return [
                    { orderId: 101, userId, amount: 100 },
                    { orderId: 102, userId, amount: 200 }
                ];
            }
            
            async function getOrderDetails(orderId) {
                await new Promise(resolve => setTimeout(resolve, 600));
                appendResult('sequentialResult', `âœ… è·å–è®¢å•è¯¦æƒ…: è®¢å•${orderId}çš„è¯¦æƒ…`);
                return { 
                    orderId, 
                    items: ['äº§å“A', 'äº§å“B'],
                    status: 'å·²å‘è´§'
                };
            }
            
            // é¡ºåºæ‰§è¡Œå‡½æ•°
            async function processUserFlow() {
                try {
                    // æ­¥éª¤1: è·å–ç”¨æˆ·ä¿¡æ¯
                    appendResult('sequentialResult', 'ğŸ”„ å¼€å§‹æ­¥éª¤1: è·å–ç”¨æˆ·ä¿¡æ¯');
                    const user = await getUserInfo(1001);
                    
                    // æ­¥éª¤2: æ ¹æ®ç”¨æˆ·IDè·å–è®¢å•
                    appendResult('sequentialResult', 'ğŸ”„ å¼€å§‹æ­¥éª¤2: è·å–ç”¨æˆ·è®¢å•');
                    const orders = await getOrders(user.userId);
                    
                    // æ­¥éª¤3: æ ¹æ®è®¢å•è·å–å•†å“è¯¦æƒ…
                    appendResult('sequentialResult', 'ğŸ”„ å¼€å§‹æ­¥éª¤3: è·å–è®¢å•è¯¦æƒ…');
                    const orderDetails = await getOrderDetails(orders[0].orderId);
                    
                    appendResult('sequentialResult', '\nğŸ‰ æµç¨‹å®Œæˆ! æœ€ç»ˆç»“æœ:');
                    appendResult('sequentialResult', `- ç”¨æˆ·å: ${user.name}`);
                    appendResult('sequentialResult', `- è®¢å•æ•°: ${orders.length}`);
                    appendResult('sequentialResult', `- ç¬¬ä¸€ä¸ªè®¢å•çŠ¶æ€: ${orderDetails.status}`);
                    appendResult('sequentialResult', `- è®¢å•åŒ…å«å•†å“: ${orderDetails.items.join(', ')}`);
                    
                } catch (error) {
                    appendResult('sequentialResult', `âŒ æµç¨‹å¤±è´¥: ${error.message}`);
                }
            }
            
            processUserFlow();
        }
        
        // 6. å¹¶è¡Œæ‰§è¡Œå¼‚æ­¥æ“ä½œæ¼”ç¤º
        function runParallelDemo() {
            displayResult('parallelResult', 'å¼€å§‹å¹¶è¡Œå¼‚æ­¥æ“ä½œæ¼”ç¤º...');
            
            // æ¨¡æ‹Ÿç‹¬ç«‹çš„APIè°ƒç”¨
            function fetchUserData() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        appendResult('parallelResult', 'âœ… ç”¨æˆ·æ•°æ®åŠ è½½å®Œæˆ');
                        resolve({ users: ['ç”¨æˆ·1', 'ç”¨æˆ·2', 'ç”¨æˆ·3'] });
                    }, 1500);
                });
            }
            
            function fetchProductData() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        appendResult('parallelResult', 'âœ… äº§å“æ•°æ®åŠ è½½å®Œæˆ');
                        resolve({ products: ['äº§å“A', 'äº§å“B', 'äº§å“C'] });
                    }, 1200);
                });
            }
            
            function fetchRecommendations() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        appendResult('parallelResult', 'âœ… æ¨èæ•°æ®åŠ è½½å®Œæˆ');
                        resolve({ recommendations: ['æ¨è1', 'æ¨è2'] });
                    }, 800);
                });
            }
            
            // å¹¶è¡Œæ‰§è¡Œå‡½æ•°
            async function loadAllData() {
                try {
                    appendResult('parallelResult', 'ğŸ”„ å¼€å§‹å¹¶è¡ŒåŠ è½½æ‰€æœ‰æ•°æ®...');
                    
                    // ä½¿ç”¨Promise.allå¹¶è¡Œæ‰§è¡Œæ‰€æœ‰å¼‚æ­¥æ“ä½œ
                    const [users, products, recommendations] = await Promise.all([
                        fetchUserData(),
                        fetchProductData(),
                        fetchRecommendations()
                    ]);
                    
                    appendResult('parallelResult', '\nğŸ‰ æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆ!');
                    appendResult('parallelResult', `- ç”¨æˆ·æ•°æ®: ${JSON.stringify(users)}`);
                    appendResult('parallelResult', `- äº§å“æ•°æ®: ${JSON.stringify(products)}`);
                    appendResult('parallelResult', `- æ¨èæ•°æ®: ${JSON.stringify(recommendations)}`);
                    
                    // å¯¹æ¯”ä¸²è¡Œæ‰§è¡Œçš„æ—¶é—´
                    appendResult('parallelResult', '\nğŸ“Š æ€§èƒ½å¯¹æ¯”:');
                    appendResult('parallelResult', `- å¹¶è¡Œæ‰§è¡Œæ—¶é—´: çº¦1.5ç§’`);
                    appendResult('parallelResult', `- ä¸²è¡Œæ‰§è¡Œæ—¶é—´: çº¦3.5ç§’ (1.5+1.2+0.8)`);
                    appendResult('parallelResult', `- æ€§èƒ½æå‡: çº¦57%`);
                    
                } catch (error) {
                    appendResult('parallelResult', `âŒ æ•°æ®åŠ è½½å¤±è´¥: ${error.message}`);
                }
            }
            
            loadAllData();
        }
        
        // 7. é”™è¯¯å¤„ç†ç­–ç•¥æ¼”ç¤º
        function runErrorHandlingDemo() {
            displayResult('errorHandlingResult', 'å¼€å§‹é”™è¯¯å¤„ç†æ¼”ç¤º...');
            
            // æ¨¡æ‹Ÿå¯èƒ½å¤±è´¥çš„æ“ä½œ
            function operation1() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        appendResult('errorHandlingResult', 'âœ… æ“ä½œ1æˆåŠŸå®Œæˆ');
                        resolve('æ“ä½œ1ç»“æœ');
                    }, 800);
                });
            }
            
            function operation2(shouldFail = true) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        if (shouldFail) {
                            appendResult('errorHandlingResult', 'âŒ æ“ä½œ2å¤±è´¥');
                            reject(new Error('æ“ä½œ2æ•…æ„å¤±è´¥'));
                        } else {
                            appendResult('errorHandlingResult', 'âœ… æ“ä½œ2æˆåŠŸå®Œæˆ');
                            resolve('æ“ä½œ2ç»“æœ');
                        }
                    }, 600);
                });
            }
            
            function operation3() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        appendResult('errorHandlingResult', 'âœ… æ“ä½œ3æˆåŠŸå®Œæˆ');
                        resolve('æ“ä½œ3ç»“æœ');
                    }, 1000);
                });
            }
            
            // é”™è¯¯å¤„ç†ç­–ç•¥å‡½æ•°
            async function errorHandlingStrategy() {
                appendResult('errorHandlingResult', 'ğŸ”„ å¼€å§‹æ‰§è¡Œå¸¦é”™è¯¯å¤„ç†çš„æµç¨‹');
                
                try {
                    // æ“ä½œ1 - å…³é”®æ“ä½œï¼Œå¤±è´¥åˆ™æ•´ä½“å¤±è´¥
                    appendResult('errorHandlingResult', '\nğŸ”„ æ‰§è¡Œæ“ä½œ1 (å…³é”®)');
                    const result1 = await operation1();
                    
                    // æ“ä½œ2 - éå…³é”®æ“ä½œï¼Œå¤±è´¥ä¸å½±å“åç»­æµç¨‹
                    appendResult('errorHandlingResult', '\nğŸ”„ æ‰§è¡Œæ“ä½œ2 (éå…³é”®)');
                    let result2 = 'æ“ä½œ2é»˜è®¤å€¼'; // é»˜è®¤å€¼
                    try {
                        result2 = await operation2(true);
                    } catch (error) {
                        appendResult('errorHandlingResult', `âš ï¸ æ“ä½œ2å¤±è´¥ä½†ç»§ç»­æ‰§è¡Œ: ${error.message}`);
                        // å¯ä»¥æœ‰é™çº§é€»è¾‘
                    }
                    
                    // æ“ä½œ3 - å…³é”®æ“ä½œï¼Œéœ€è¦æ“ä½œ1æˆåŠŸ
                    appendResult('errorHandlingResult', '\nğŸ”„ æ‰§è¡Œæ“ä½œ3 (å…³é”®)');
                    const result3 = await operation3();
                    
                    // æˆåŠŸå®Œæˆæ‰€æœ‰å…³é”®æ“ä½œ
                    appendResult('errorHandlingResult', '\nğŸ‰ æµç¨‹æˆåŠŸå®Œæˆ!');
                    appendResult('errorHandlingResult', `- æ“ä½œ1ç»“æœ: ${result1}`);
                    appendResult('errorHandlingResult', `- æ“ä½œ2ç»“æœ: ${result2}`);
                    appendResult('errorHandlingResult', `- æ“ä½œ3ç»“æœ: ${result3}`);
                    
                } catch (error) {
                    // æ•è·å…³é”®æ“ä½œçš„é”™è¯¯
                    appendResult('errorHandlingResult', `\nâŒ å…³é”®æ“ä½œå¤±è´¥: ${error.message}`);
                    appendResult('errorHandlingResult', 'ğŸ”„ æ‰§è¡Œé™çº§ç­–ç•¥...');
                    
                    // æ¨¡æ‹Ÿé™çº§å¤„ç†
                    setTimeout(() => {
                        appendResult('errorHandlingResult', 'âœ… é™çº§ç­–ç•¥æ‰§è¡ŒæˆåŠŸ');
                        appendResult('errorHandlingResult', 'ğŸ“ è®°å½•é”™è¯¯æ—¥å¿—');
                    }, 500);
                } finally {
                    // æ— è®ºæˆåŠŸå¤±è´¥éƒ½æ‰§è¡Œæ¸…ç†
                    setTimeout(() => {
                        appendResult('errorHandlingResult', '\nğŸ§¹ æ‰§è¡Œæ¸…ç†å·¥ä½œ');
                        appendResult('errorHandlingResult', 'âœ… é‡Šæ”¾èµ„æº');
                        appendResult('errorHandlingResult', 'âœ… é‡ç½®çŠ¶æ€');
                        appendResult('errorHandlingResult', '\nğŸ”š é”™è¯¯å¤„ç†æ¼”ç¤ºå®Œæˆ');
                    }, 1200);
                }
            }
            
            errorHandlingStrategy();
        }
        
        // 8. æ¨¡æ‹ŸAPIè¯·æ±‚
        function simulateApiRequest() {
            displayResult('apiRequestResult', 'å¼€å§‹æ¨¡æ‹ŸAPIè¯·æ±‚...');
            const progressBar = document.getElementById('apiProgressBar');
            progressBar.style.width = '0%';
            
            // æ¨¡æ‹Ÿè¿›åº¦æ›´æ–°
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 10;
                if (progress > 90) progress = 90;
                progressBar.style.width = `${progress}%`;
            }, 200);
            
            // æ¨¡æ‹ŸAPIè¯·æ±‚
            function simulateFetch(url, options = {}) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        // éšæœºæ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥ï¼ˆ80%æˆåŠŸç‡ï¼‰
                        const success = Math.random() > 0.2;
                        
                        clearInterval(progressInterval);
                        progressBar.style.width = '100%';
                        
                        if (success) {
                            resolve({
                                ok: true,
                                json: () => Promise.resolve({
                                    data: {
                                        id: 1,
                                        name: 'ç¤ºä¾‹æ•°æ®',
                                        status: 'active'
                                    },
                                    message: 'è¯·æ±‚æˆåŠŸ'
                                })
                            });
                        } else {
                            reject(new Error('ç½‘ç»œé”™è¯¯æˆ–æœåŠ¡å™¨å†…éƒ¨é”™è¯¯'));
                        }
                    }, 2000 + Math.random() * 1000); // 2-3ç§’çš„éšæœºå»¶è¿Ÿ
                });
            }
            
            // æ‰§è¡Œè¯·æ±‚å¹¶å¤„ç†
            async function fetchData() {
                try {
                    appendResult('apiRequestResult', 'ğŸ”„ å‘é€è¯·æ±‚åˆ°: /api/data');
                    const response = await simulateFetch('/api/data');
                    
                    if (!response.ok) {
                        throw new Error(`HTTPé”™è¯¯! çŠ¶æ€ç : ${response.status}`);
                    }
                    
                    const data = await response.json();
                    appendResult('apiRequestResult', `âœ… è¯·æ±‚æˆåŠŸ!`);
                    appendResult('apiRequestResult', `ğŸ“Š å“åº”æ•°æ®: ${JSON.stringify(data, null, 2)}`);
                    
                } catch (error) {
                    appendResult('apiRequestResult', `âŒ è¯·æ±‚å¤±è´¥: ${error.message}`);
                    appendResult('apiRequestResult', 'ğŸ”„ å°è¯•é‡è¯•...');
                    
                    // æ¨¡æ‹Ÿé‡è¯•é€»è¾‘
                    setTimeout(async () => {
                        try {
                            appendResult('apiRequestResult', 'ğŸ”„ é‡è¯•è¯·æ±‚...');
                            const response = await simulateFetch('/api/data');
                            const data = await response.json();
                            appendResult('apiRequestResult', `âœ… é‡è¯•æˆåŠŸ!`);
                            appendResult('apiRequestResult', `ğŸ“Š å“åº”æ•°æ®: ${JSON.stringify(data, null, 2)}`);
                        } catch (retryError) {
                            appendResult('apiRequestResult', `âŒ é‡è¯•å¤±è´¥: ${retryError.message}`);
                            appendResult('apiRequestResult', 'ğŸ’¬ æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯ä¿¡æ¯');
                        } finally {
                            appendResult('apiRequestResult', 'ğŸ”š APIè¯·æ±‚æ¼”ç¤ºå®Œæˆ');
                        }
                    }, 1500);
                }
            }
            
            fetchData();
        }
        
        // 9. å–æ¶ˆå¼‚æ­¥æ“ä½œ
        let abortController = null;
        
        function startCancellableOperation() {
            if (abortController) {
                displayResult('cancelResult', 'âŒ å·²æœ‰æ“ä½œåœ¨è¿›è¡Œä¸­ï¼Œè¯·å…ˆå–æ¶ˆ');
                return;
            }
            
            displayResult('cancelResult', 'ğŸ”„ å¼€å§‹å¯å–æ¶ˆçš„æ“ä½œ...');
            
            // åˆ›å»ºAbortController
            abortController = new AbortController();
            const { signal } = abortController;
            
            // å¯å–æ¶ˆçš„æ“ä½œ
            function cancellableOperation(signal, duration = 5000) {
                return new Promise((resolve, reject) => {
                    // æ£€æŸ¥ä¿¡å·æ˜¯å¦å·²ç»è¢«ä¸­æ­¢
                    if (signal.aborted) {
                        return reject(new Error('æ“ä½œå·²è¢«é¢„å…ˆå–æ¶ˆ'));
                    }
                    
                    appendResult('cancelResult', `â±ï¸ æ“ä½œå°†æŒç»­ ${duration/1000} ç§’`);
                    
                    // æ¨¡æ‹Ÿè¿›åº¦
                    let progress = 0;
                    const totalSteps = 10;
                    const stepDelay = duration / totalSteps;
                    
                    const progressInterval = setInterval(() => {
                        progress++;
                        const percentage = (progress / totalSteps) * 100;
                        appendResult('cancelResult', `ğŸ“Š è¿›åº¦: ${percentage.toFixed(0)}%`);
                        
                        if (progress >= totalSteps) {
                            clearInterval(progressInterval);
                            resolve('æ“ä½œæˆåŠŸå®Œæˆ');
                        }
                    }, stepDelay);
                    
                    // ç›‘å¬ä¸­æ­¢ä¿¡å·
                    signal.addEventListener('abort', () => {
                        clearInterval(progressInterval);
                        reject(new Error('æ“ä½œè¢«ç”¨æˆ·å–æ¶ˆ'));
                    });
                });
            }
            
            // æ‰§è¡Œå¯å–æ¶ˆçš„æ“ä½œ
            cancellableOperation(signal, 5000)
                .then(result => {
                    appendResult('cancelResult', `âœ… ${result}`);
                })
                .catch(error => {
                    appendResult('cancelResult', `âŒ ${error.message}`);
                })
                .finally(() => {
                    appendResult('cancelResult', 'ğŸ”š æ“ä½œç»“æŸ');
                    abortController = null; // é‡ç½®æ§åˆ¶å™¨
                });
        }
        
        function cancelOperation() {
            if (!abortController) {
                displayResult('cancelResult', 'âŒ æ²¡æœ‰å¯å–æ¶ˆçš„æ“ä½œ');
                return;
            }
            
            appendResult('cancelResult', 'âš ï¸ æ­£åœ¨å–æ¶ˆæ“ä½œ...');
            abortController.abort();
        }
        
        // 10. é˜²æŠ–æ¼”ç¤º
        const debounceInput = document.getElementById('debounceInput');
        
        // ç®€å•çš„é˜²æŠ–å®ç°
        function debounce(func, delay) {
            let timeoutId;
            return function(...args) {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => {
                    func.apply(this, args);
                }, delay);
            };
        }
        
        // é˜²æŠ–å¤„ç†å‡½æ•°
        const debouncedSearch = debounce((text) => {
            displayResult('debounceResult', `ğŸ” æ‰§è¡Œæœç´¢: "${text}"`);
            
            // æ¨¡æ‹Ÿæœç´¢å»¶è¿Ÿ
            setTimeout(() => {
                if (text.trim()) {
                    appendResult('debounceResult', `âœ… æœç´¢å®Œæˆ: æ‰¾åˆ° ${Math.floor(Math.random() * 100)} ä¸ªç»“æœ`);
                } else {
                    appendResult('debounceResult', `â„¹ï¸ è¯·è¾“å…¥æœç´¢å†…å®¹`);
                }
            }, 300);
        }, 500); // 500mså»¶è¿Ÿ
        
        // æ·»åŠ è¾“å…¥äº‹ä»¶ç›‘å¬
        debounceInput.addEventListener('input', (event) => {
            const text = event.target.value;
            displayResult('debounceResult', `â±ï¸ ç­‰å¾…è¾“å…¥åœæ­¢: "${text}"`);
            debouncedSearch(text);
        });
        
        // åˆå§‹åŒ–
        displayResult('debounceResult', 'å¼€å§‹è¾“å…¥æµ‹è¯•é˜²æŠ–æ•ˆæœ...');
    </script>
</body>
</html>